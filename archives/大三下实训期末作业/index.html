<!DOCTYPE HTML>
<html lang="zh-CN">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Maverick,ZE,Galileo,wiki" />
    <meta name="generator" content="Maverick 1.1" />
    <meta name="template" content="Kepler" />
    <link rel="alternate" type="application/rss+xml" title="ze &raquo; RSS 2.0" href="/feed/index.xml" />
    <link rel="alternate" type="application/atom+xml" title="ze &raquo; ATOM 1.0" href="/feed/atom/index.xml" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/ze/Wiki@gh-pages/assets/kepler-426969802d.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/ze/Wiki@gh-pages/assets/ExSearch/ExSearch-182e5a8868.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.10.0/dist/tocbot.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.css">
    <script>
        var ExSearchConfig = {
            root: "",
            api: "https://cdn.jsdelivr.net/gh/ze/Wiki@gh-pages/591f9f7764a8fd2466b8ba7b37e37a9e.json"
        }
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function(){
            if(/Safari/.test(navigator.userAgent) && !/Chrome/.test(navigator.userAgent)){
                document.body.classList.add('safari')
            }else{
                document.body.classList.remove('safari')
            }
        });
    </script>
    
<title>大三下实训期末作业 - ze</title>
<meta name="author" content="LifeAlsoIsGG" />
<meta name="description" content="活动室指纹考勤管理系统" />
<meta property="og:title" content="大三下实训期末作业 - ze" />
<meta property="og:description" content="活动室指纹考勤管理系统" />
<meta property="og:site_name" content="ze" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/archives/大三下实训期末作业/" />
<meta property="og:image" content="" />
<meta property="article:published_time" content="2020-06-30T10:43:30-00.00" />
<meta name="twitter:title" content="大三下实训期末作业 - ze" />
<meta name="twitter:description" content="活动室指纹考勤管理系统" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="" />


    
<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="//cdn.jsdelivr.net" />
<link rel="icon" href="https://cdn.jsdelivr.net/gh/lifealsoisgg/Wiki@gh-pages/avatar.png" type="images/x-ico" />

    </head>
    
    <body class="content">
        <header>
            <div class="container">
                <section>
                    <a href="/"><img src="https://cdn.jsdelivr.net/gh/ze/Wiki@gh-pages/avatar.png">ze</a>
                </section>
                <section>
                    <nav>
                        <ul>
                            
                                <li><a href="https://blog.ze.online" target="_blank">Blog</a></li>
                            
                                <li><a href="https://photos.ze.online" target="_blank">Photos</a></li>
                            
                                <li><a href="https://github.com/ouzejin" target="_blank">GitHub</a></li>
                            
                                <li><a href="https://twitter.com/ouzejin" target="_blank">Twitter</a></li>
                            
                        </ul>
                    </nav>
                </section>
    
                <section>
                    <a hidden class="toggle-toc" target="_self" href="javascript:void(0)" onclick="$(body).toggleClass('toc-open')"><i class="fa fa-align-right"></i></a>
                    <a hidden class="toggle-navbar" target="_self" href="javascript:void(0)" onclick="$(body).toggleClass('navbar-open')"><i class="fa fa-indent"></i></a>
                    <button class="search-form-input"><i class="fa fa-search"></i></button>
                </section>
            </div>
        </header>

        <main>
            <div id="pjax-container" class="container">
                <aside id="navbar" class="no-scrollbar">
                    
                    <section class="sidebar-nav">
                        
                            <div class="None" ><span><a href="/">Home</a></span></div>
                        
                            <div class="None" ><span><a href="/archives/">Archives</a></span></div>
                        
                            <div class="None" ><span><a href="/About/">About</a></span></div>
                        
                            <div class="None" ><span><a href="/My Project/">My Project</a></span></div>
                        
                    </section>
                    
                    <section>
                        
    <div class=" "><span><a href="/category/数据库/">数据库</a><button class="toggle_sidebar fa"></button></span><ul><div class=" "><span><a href="/category/Redis/">Redis</a><button class="toggle_sidebar fa"></button></span><ul><li class=""><a href="/archives/Redis实现高并发秒杀系统/">Redis实现高并发秒杀系统</a></li><li class=""><a href="/archives/Redis部署与基本使用/">Redis部署与基本使用</a></li><li class=""><a href="/archives/Redis实现单点登录/">Redis实现单点登录</a></li><li class=""><a href="/archives/Redis理论学习笔记/">Redis理论学习笔记</a></li></ul></div><li class=""><a href="/archives/SQL学习笔记/">SQL学习笔记</a></li><li class=""><a href="/archives/Mysql理论学习笔记/">Mysql理论学习笔记</a></li><div class=" "><span><a href="/category/Hadoop/">Hadoop</a><button class="toggle_sidebar fa"></button></span><ul><li class=""><a href="/archives/Hadoop伪分布式配置/">Hadoop伪分布式配置</a></li></ul></div></ul></div><div class=" "><span><a href="/category/Java/">Java</a><button class="toggle_sidebar fa"></button></span><ul><li class=""><a href="/archives/Java-时间处理/">Java-时间处理</a></li><li class=""><a href="/archives/Java-反射/">Java-反射</a></li><li class=""><a href="/archives/Java-JDK8新特性/">Java-JDK8新特性</a></li><li class=""><a href="/archives/Java-IO/">Java-IO</a></li><li class=""><a href="/archives/Java-JVM/">Java-JVM</a></li><li class=""><a href="/archives/Java-集合容器/">Java-集合容器</a></li><li class=""><a href="/archives/Java-多线程并发/">Java-多线程并发</a></li><li class=""><a href="/archives/Java-设计模式/">Java-设计模式</a></li><li class=""><a href="/archives/Java-方法汇总/">Java-方法汇总</a></li><li class=""><a href="/archives/Java-基础面试题/">Java-基础面试题</a></li><li class=""><a href="/archives/Java-基础知识笔记/">Java-基础知识笔记</a></li></ul></div><div class=" "><span><a href="/category/面试/">面试</a><button class="toggle_sidebar fa"></button></span><ul><li class=""><a href="/archives/腾讯云学习笔记/">腾讯云学习笔记</a></li><li class=""><a href="/archives/面试题整理/">面试题整理</a></li><li class=""><a href="/archives/腾讯移动客户端面经/">腾讯移动客户端面经</a></li><li class=""><a href="/archives/计算机其它面试题/">计算机其它面试题</a></li><li class=""><a href="/archives/Mysql&Redis数据库面试题/">Mysql&Redis数据库面试题</a></li><li class=""><a href="/archives/Spring框架面试题/">Spring框架面试题</a></li><li class=""><a href="/archives/字节跳动面试/">字节跳动面试</a></li><li class=""><a href="/archives/后端面试题/">后端面试题</a></li></ul></div><div class=" "><span><a href="/category/Spring/">Spring</a><button class="toggle_sidebar fa"></button></span><ul><div class=" "><span><a href="/category/SpringBoot/">SpringBoot</a><button class="toggle_sidebar fa"></button></span><ul><li class=""><a href="/archives/Swagger使用/">Swagger使用</a></li><li class=""><a href="/archives/Lombok使用/">Lombok使用</a></li><li class=""><a href="/archives/Maven中依赖的scope总结/">Maven中依赖的scope总结</a></li><li class=""><a href="/archives/Devtools对Springboot热部署/">Devtools对Springboot热部署</a></li><li class=""><a href="/archives/IDEA配置Run Dashboard/">IDEA配置Run Dashboard</a></li><li class=""><a href="/archives/IDEA初始化SpringBoot项目+逆向工程+配置/">IDEA初始化SpringBoot项目+逆向工程+配置</a></li><li class=""><a href="/archives/EasyExcel导入导出Excel/">EasyExcel导入导出Excel</a></li><li class=""><a href="/archives/服务器上部署SpringBoot/">服务器上部署SpringBoot</a></li></ul></div><div class=" "><span><a href="/category/Mybatis/">Mybatis</a><button class="toggle_sidebar fa"></button></span><ul><li class=""><a href="/archives/Mybatis学习笔记/">Mybatis学习笔记</a></li><li class=""><a href="/archives/Mybatis逆向工程&Example类使用/">Mybatis逆向工程&Example类使用</a></li></ul></div><li class=""><a href="/archives/HttpServletrequest与HttpServletResponse/">HttpServletrequest与HttpServletResponse</a></li><li class=""><a href="/archives/SpringMVC基础&面试/">SpringMVC基础&面试</a></li><li class=""><a href="/archives/SpringMVC注解/">SpringMVC注解</a></li><li class=""><a href="/archives/Spring基础&面试/">Spring基础&面试</a></li><div class=" "><span><a href="/category/SpringCloud/">SpringCloud</a><button class="toggle_sidebar fa"></button></span><ul><li class=""><a href="/archives/认识SpringCloud/">认识SpringCloud</a></li></ul></div></ul></div><div class=" "><span><a href="/category/前端/">前端</a><button class="toggle_sidebar fa"></button></span><ul><li class=""><a href="/archives/JavaScript面试题/">JavaScript面试题</a></li><li class=""><a href="/archives/Promise异步调用/">Promise异步调用</a></li></ul></div><div class=" "><span><a href="/category/数据结构&算法/">数据结构&算法</a><button class="toggle_sidebar fa"></button></span><ul><li class=""><a href="/archives/数据结构&算法基础笔记/">数据结构&算法基础笔记</a></li><li class=""><a href="/archives/数据结构&算法题目合集/">数据结构&算法题目合集</a></li></ul></div><div class=" "><span><a href="/category/Linux/">Linux</a><button class="toggle_sidebar fa"></button></span><ul><li class=""><a href="/archives/Linux常用命令/">Linux常用命令</a></li><li class=""><a href="/archives/xshell connect to Centos7 in VMware/">用xshell连接虚拟机中的Centos7</a></li><div class=" "><span><a href="/category/Docker/">Docker</a><button class="toggle_sidebar fa"></button></span><ul><li class=""><a href="/archives/Docker:Install-software/">Docker:Install software</a></li><li class=""><a href="/archives/Docker-deployment/">Docker deployment</a></li></ul></div></ul></div><div class=" "><span><a href="/category/My Project/">My Project</a><button class="toggle_sidebar fa"></button></span><ul><li class=""><a href="/archives/MyProject-AttendanceMiniprogram/">实验室出入管理小程序</a></li><li class=""><a href="/archives/ActivitySystem/">Javaweb大学活动管理系统</a></li><li class=""><a href="/archives/MyProject-SupermarketSystem/">Java Swing-超市系统</a></li></ul></div><div class="open "><span><a href="/category/Other/">Other</a><button class="toggle_sidebar fa"></button></span><ul><li class="current"><a href="/archives/大三下实训期末作业/">大三下实训期末作业</a></li><li class=""><a href="/archives/修改Host以访问Github/">修改Host以访问Github</a></li></ul></div><div class=" "><span><a href="/category/Notes/">Notes</a><button class="toggle_sidebar fa"></button></span><ul><li class=""><a href="/archives/软考软件设计师笔记/">软考软件设计师笔记</a></li></ul></div><div class=" "><span><a href="/category/Maverick/">Maverick</a><button class="toggle_sidebar fa"></button></span><ul><li class=""><a href="/archives/typography/">Hello World!</a></li></ul></div>

                    </section>
                    <section hidden class="sidebar-external-link">
                        
                            <div class="external"><span><a href="https://blog.ze.online">Blog</a><button class="go-external"><i class="fa fa-external-link"></i></button></span></div>
                        
                            <div class="external"><span><a href="https://photos.ze.online">Photos</a><button class="go-external"><i class="fa fa-external-link"></i></button></span></div>
                        
                            <div class="external"><span><a href="https://github.com/ouzejin">GitHub</a><button class="go-external"><i class="fa fa-external-link"></i></button></span></div>
                        
                            <div class="external"><span><a href="https://twitter.com/ouzejin">Twitter</a><button class="go-external"><i class="fa fa-external-link"></i></button></span></div>
                        
                    </section>
                    <section class="maverick">
                        <div><span style="border: 1px solid #d4dadf;"><a href="https://github.com/AlanDecode/Maverick" target="_blank">Maverick & Kepler</a></span></div>
                    </section>
                </aside>
                <div id="content-wrapper">
                    <div id="content">
    <section>
        <h1 class="post-title">大三下实训期末作业</h1>
        <p class="post-meta">
            <time>June 30 2020</time>
            <span class="tags">
                
                <span>
                    <a href="/tag/Other/">#Other</a>
                </span>
                
                <span>
                    <a href="/tag/实训/">#实训</a>
                </span>
                
            </span>
        </p>
        <article class="yue"><h1>活动室指纹考勤管理系统</h1>
<p>成员：陈龙</p>
<p>网页端浏览：<a href="https://wiki.lifeisgg.online/archives/大三下实训期末作业/">https://wiki.lifeisgg.online/archives/大三下实训期末作业/</a></p>
<p>项目Github地址：<a href="https://github.com/LifeAlsoIsGG/springcloud-demo">https://github.com/LifeAlsoIsGG/springcloud-demo</a></p>
<h3>一、需求分析  </h3>
<h4>1.需求分析  </h4>
<p>1.管理方面：近几年来，随着大学生社团活动的丰富，社团活动室的管理问题也日益明显。社团活动室通常是自由<strong>开放管理</strong>方式，会员可<strong>自由进出</strong>活动室学习，很难对其会员的<strong>活跃度</strong>、<strong>实时在场</strong>人员情况等进行管理，而在社团进行换届和招新的期间，人员<strong>变动</strong>很<strong>频繁</strong>，会员信息更新工作量大。本项目通过指纹和人脸识别多种识别方式，实时记录存储登记会员每一次的进出时间，从而实现出勤时间的自动统计，自动将会员的活跃时长按月和周实时显示在小程序端，还能实时显示当前在活动室的成员及其联系方式，社团负责人可随时联系在活动室的会员。</p>
<p>2.安全方面：智能指纹及人脸识别好在“智能、安全、便捷”，十分适用于社团活动室等的人员流动记录管理，不会出现人工记录的繁琐，又免除了必须携带钥匙或门禁卡的麻烦，普通钥匙或门禁卡管理方式<strong>容易丢失或复制</strong>，造成安全隐患。而传统密码锁的话时间一长也容易泄露，不适用于人流量大的社团活动室。另外指纹识别对环境和打卡人员皮肤的要求都很高，当空气干燥、皮肤脏、蜕皮等情况就无法识别，这时候就可以用人脸识别进行打卡，多种打卡方式<strong>容错率更高</strong>。所以社团活动室将采用指纹及人脸识别<strong>两种方式结合</strong>来进行社团活动室的管理。 </p>
<h4>2.思维导图</h4>
<p><figure><img data-width="1152" data-height="523" src="https://cdn.jsdelivr.net/gh/ze/Wiki@gh-pages/archives/assets/1cc50bcf9e6944a5c0b4066ce6397577.jpg" alt="" /></figure></p>
<h3>二、数据库结构</h3>
<h4>1.ER图</h4>
<p><figure><img data-width="1556" data-height="612" src="https://cdn.jsdelivr.net/gh/ze/Wiki@gh-pages/archives/assets/bc4864512fabf8f426863395115aa758.jpg" alt="" /></figure></p>
<h4>2.表结构（7个表）</h4>
<p><strong>wxuser表</strong></p>
<table>
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>是否为空</th>
<th>主键</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>uId</td>
<td>int(11)</td>
<td>否</td>
<td>是</td>
<td>自动增长</td>
</tr>
<tr>
<td>openId</td>
<td>varchar(30)</td>
<td>否</td>
<td></td>
<td>微信号</td>
</tr>
<tr>
<td>nickName</td>
<td>varchar(20)</td>
<td>否</td>
<td></td>
<td>微信昵称</td>
</tr>
<tr>
<td>avatrUrl</td>
<td>text</td>
<td>否</td>
<td></td>
<td>头像地址</td>
</tr>
<tr>
<td>activity</td>
<td>int(11)</td>
<td>是</td>
<td></td>
<td>进入房间</td>
</tr>
<tr>
<td>sSuper</td>
<td>int(11)</td>
<td>否</td>
<td></td>
<td>权限，默认为1</td>
</tr>
</tbody>
</table>
<p><strong>realname表</strong></p>
<table>
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>是否为空</th>
<th>主键</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>uId</td>
<td>int(11)</td>
<td>否</td>
<td></td>
<td>用户ID</td>
</tr>
<tr>
<td>sId</td>
<td>varchar(20)</td>
<td>否</td>
<td>是</td>
<td>学号</td>
</tr>
<tr>
<td>password</td>
<td>varchar(30)</td>
<td>否</td>
<td></td>
<td>密码</td>
</tr>
<tr>
<td>pNumber</td>
<td>varchar(20)</td>
<td>否</td>
<td></td>
<td>号码</td>
</tr>
<tr>
<td>email</td>
<td>varchar(30)</td>
<td>否</td>
<td></td>
<td>邮箱</td>
</tr>
</tbody>
</table>
<p><strong>time表</strong></p>
<table>
<thead><tr>
<th>名称</th>
<th style="text-align:left">类型</th>
<th>是否为空</th>
<th>主键</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>uId</td>
<td style="text-align:left">int(11)</td>
<td>否</td>
<td></td>
<td>用户ID</td>
</tr>
<tr>
<td>rId</td>
<td style="text-align:left">int(11)</td>
<td>否</td>
<td></td>
<td>进过的房间ID</td>
</tr>
<tr>
<td>time</td>
<td style="text-align:left">int(11)</td>
<td>否</td>
<td></td>
<td>活跃时间</td>
</tr>
</tbody>
</table>
<p><strong>room表</strong></p>
<table>
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>是否为空</th>
<th>主键</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>rId</td>
<td>int(11)</td>
<td>否</td>
<td>是</td>
<td>自动增长</td>
</tr>
<tr>
<td>rName</td>
<td>varchar(20)</td>
<td>否</td>
<td></td>
<td>教室名</td>
</tr>
<tr>
<td>address</td>
<td>varchar(50)</td>
<td>否</td>
<td></td>
<td>教室位置</td>
</tr>
<tr>
<td>del</td>
<td>int(11)</td>
<td></td>
<td></td>
<td>状态，默认为1</td>
</tr>
</tbody>
</table>
<p><strong>roomAdmin表</strong></p>
<table>
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>是否为空</th>
<th>主键</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>rId</td>
<td>int(11)</td>
<td></td>
<td></td>
<td>教室编号</td>
</tr>
<tr>
<td>uId</td>
<td>int(11)</td>
<td></td>
<td></td>
<td>管理员编号</td>
</tr>
<tr>
<td>aDate</td>
<td>datetime</td>
<td></td>
<td></td>
<td>通知消息</td>
</tr>
<tr>
<td>del</td>
<td>int(11)</td>
<td></td>
<td></td>
<td>状态，默认为1</td>
</tr>
</tbody>
</table>
<p><strong>roomNotice表</strong></p>
<table>
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>是否为空</th>
<th>主键</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>rId</td>
<td>int(11)</td>
<td></td>
<td></td>
<td>房间编号</td>
</tr>
<tr>
<td>uId</td>
<td>int(11)</td>
<td></td>
<td></td>
<td>用户ID</td>
</tr>
<tr>
<td>notice</td>
<td>text</td>
<td></td>
<td></td>
<td>公告信息</td>
</tr>
<tr>
<td>cDate</td>
<td>datetime</td>
<td></td>
<td></td>
<td>更改信息</td>
</tr>
</tbody>
</table>
<p><strong>Log表</strong></p>
<table>
<thead><tr>
<th>名称</th>
<th>类型</th>
<th>是否为空</th>
<th>主键</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>lId</td>
<td>int(11)</td>
<td>否</td>
<td>是</td>
<td>自动增长</td>
</tr>
<tr>
<td>uId</td>
<td>int(11)</td>
<td>否</td>
<td></td>
<td>管理员编号</td>
</tr>
<tr>
<td>rId</td>
<td>int(11)</td>
<td>否</td>
<td></td>
<td>教室编号</td>
</tr>
<tr>
<td>state</td>
<td>int(11)</td>
<td>否</td>
<td></td>
<td>进出状态</td>
</tr>
<tr>
<td>lDate</td>
<td>date</td>
<td>否</td>
<td></td>
<td>进出时间</td>
</tr>
</tbody>
</table>
<h3>三、组员工作划分</h3>
<p>陈龙：负责wxuser表realname表，Log表的后台功能实现，包括增删查改等功能；小程序前端的开发实现；服务器的部署</p>
<p>罗家晓：负责roomadmin，room表后台功能的实现，包括增删查改等功能的实现；小程序前端的开发实现。</p>
<p>吴佳涛：负责roomnotice，time表后台功能的实现，包括增删查改功能的实现；数据库表的设计与修改。</p>
<h3>四、代码整合工具</h3>
<p>小组采用Github工具进行整合，每天做完项目后各自将自己的代码提交到自己的分支上，然后在主分支进行整合，每天项目开发前拉取昨晚整合好的代码。</p>
<h5>工程目录</h5>
<p><figure><img data-width="-1" data-height="-1" src="C:\Users\15010\AppData\Roaming\Typora\typora-user-../images/大三下实训期末作业/\image-20200114103618253.png" alt="image-20200114103618253" /><figcaption>image-20200114103618253</figcaption></figure></p>
<p><figure><img data-width="-1" data-height="-1" src="C:\Users\15010\AppData\Roaming\Typora\typora-user-../images/大三下实训期末作业/\image-20200114103627082.png" alt="image-20200114103627082" /><figcaption>image-20200114103627082</figcaption></figure></p>
<h3>五、POM.xml</h3>
<div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>

<span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
  <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>

  <span class="nt">&lt;groupId&gt;</span>org.example<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>attendance<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>1.0-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
  <span class="nt">&lt;packaging&gt;</span>war<span class="nt">&lt;/packaging&gt;</span>

  <span class="nt">&lt;name&gt;</span>attendance Maven Webapp<span class="nt">&lt;/name&gt;</span>
  <span class="c">&lt;!-- FIXME change it to the project&#39;s website --&gt;</span>
  <span class="nt">&lt;url&gt;</span>http://www.example.com<span class="nt">&lt;/url&gt;</span>

  <span class="nt">&lt;properties&gt;</span>
    <span class="nt">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span class="nt">&lt;/project.build.sourceEncoding&gt;</span>
    <span class="nt">&lt;maven.compiler.source&gt;</span>1.7<span class="nt">&lt;/maven.compiler.source&gt;</span>
    <span class="nt">&lt;maven.compiler.target&gt;</span>1.7<span class="nt">&lt;/maven.compiler.target&gt;</span>
    <span class="nt">&lt;spring.version&gt;</span>5.2.2.RELEASE<span class="nt">&lt;/spring.version&gt;</span>
    <span class="nt">&lt;mysql.version&gt;</span>5.1.47<span class="nt">&lt;/mysql.version&gt;</span>
    <span class="nt">&lt;mybatis.version&gt;</span>3.5.3<span class="nt">&lt;/mybatis.version&gt;</span>
    <span class="nt">&lt;junit.version&gt;</span>4.12<span class="nt">&lt;/junit.version&gt;</span>
    <span class="nt">&lt;mybatis.gen.version&gt;</span>1.4.0<span class="nt">&lt;/mybatis.gen.version&gt;</span>
    <span class="nt">&lt;slf4j.version&gt;</span>1.7.6<span class="nt">&lt;/slf4j.version&gt;</span>
    <span class="nt">&lt;mybatis.spring.version&gt;</span>2.0.3<span class="nt">&lt;/mybatis.spring.version&gt;</span>
    <span class="nt">&lt;aspectjweaver.version&gt;</span>1.9.1<span class="nt">&lt;/aspectjweaver.version&gt;</span>
  <span class="nt">&lt;/properties&gt;</span>

  <span class="nt">&lt;dependencies&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>com.fasterxml.jackson.core<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>jackson-databind<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>2.9.5<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="c">&lt;!-- https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-core --&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>com.fasterxml.jackson.core<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>jackson-core<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>2.9.5<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="c">&lt;!-- https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-annotations --&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>com.fasterxml.jackson.core<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>jackson-annotations<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>2.9.5<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>mysql<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>mysql-connector-java<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>${mysql.version}<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>spring-webmvc<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>${spring.version}<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>spring-jdbc<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>${spring.version}<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>spring-tx<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>${spring.version}<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>org.mybatis<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>mybatis<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>${mybatis.version}<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>junit<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>junit<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>${junit.version}<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="c">&lt;!-- https://mvnrepository.com/artifact/org.mybatis.generator/mybatis-generator-core --&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>org.mybatis.generator<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>mybatis-generator-core<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>${mybatis.gen.version}<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>org.slf4j<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>slf4j-log4j12<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>${slf4j.version}<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="c">&lt;!-- https://mvnrepository.com/artifact/org.mybatis/mybatis-spring --&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>org.mybatis<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>mybatis-spring<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>${mybatis.spring.version}<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>org.aspectj<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>aspectjweaver<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>${aspectjweaver.version}<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="c">&lt;!-- https://mvnrepository.com/artifact/commons-fileupload/commons-fileupload --&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>commons-fileupload<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>commons-fileupload<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>1.4<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="c">&lt;!-- https://mvnrepository.com/artifact/commons-io/commons-io --&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>commons-io<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>commons-io<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>2.6<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>



  <span class="nt">&lt;/dependencies&gt;</span>

  <span class="nt">&lt;build&gt;</span>
    <span class="nt">&lt;finalName&gt;</span>attendance<span class="nt">&lt;/finalName&gt;</span>
    <span class="nt">&lt;pluginManagement&gt;</span><span class="c">&lt;!-- lock down plugins versions to avoid using Maven defaults (may be moved to parent pom) --&gt;</span>
      <span class="nt">&lt;plugins&gt;</span>
        <span class="nt">&lt;plugin&gt;</span>
          <span class="nt">&lt;artifactId&gt;</span>maven-clean-plugin<span class="nt">&lt;/artifactId&gt;</span>
          <span class="nt">&lt;version&gt;</span>3.1.0<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/plugin&gt;</span>
        <span class="c">&lt;!-- see http://maven.apache.org/ref/current/maven-core/default-bindings.html#Plugin_bindings_for_war_packaging --&gt;</span>
        <span class="nt">&lt;plugin&gt;</span>
          <span class="nt">&lt;artifactId&gt;</span>maven-resources-plugin<span class="nt">&lt;/artifactId&gt;</span>
          <span class="nt">&lt;version&gt;</span>3.0.2<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/plugin&gt;</span>
        <span class="nt">&lt;plugin&gt;</span>
          <span class="nt">&lt;artifactId&gt;</span>maven-compiler-plugin<span class="nt">&lt;/artifactId&gt;</span>
          <span class="nt">&lt;version&gt;</span>3.8.0<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/plugin&gt;</span>
        <span class="nt">&lt;plugin&gt;</span>
          <span class="nt">&lt;artifactId&gt;</span>maven-surefire-plugin<span class="nt">&lt;/artifactId&gt;</span>
          <span class="nt">&lt;version&gt;</span>2.22.1<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/plugin&gt;</span>
        <span class="nt">&lt;plugin&gt;</span>
          <span class="nt">&lt;artifactId&gt;</span>maven-war-plugin<span class="nt">&lt;/artifactId&gt;</span>
          <span class="nt">&lt;version&gt;</span>3.2.2<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/plugin&gt;</span>
        <span class="nt">&lt;plugin&gt;</span>
          <span class="nt">&lt;artifactId&gt;</span>maven-install-plugin<span class="nt">&lt;/artifactId&gt;</span>
          <span class="nt">&lt;version&gt;</span>2.5.2<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/plugin&gt;</span>
        <span class="nt">&lt;plugin&gt;</span>
          <span class="nt">&lt;artifactId&gt;</span>maven-deploy-plugin<span class="nt">&lt;/artifactId&gt;</span>
          <span class="nt">&lt;version&gt;</span>2.8.2<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/plugin&gt;</span>
      <span class="nt">&lt;/plugins&gt;</span>
    <span class="nt">&lt;/pluginManagement&gt;</span>
  <span class="nt">&lt;/build&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</pre></div>
<h5>web.xml</h5>
<div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE web-app PUBLIC</span>
<span class="cp">        &quot;-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN&quot;</span>
<span class="cp">        &quot;http://java.sun.com/dtd/web-app_2_3.dtd&quot; &gt;</span>

<span class="nt">&lt;web-app&gt;</span>
  <span class="nt">&lt;display-name&gt;</span>Archetype Created Web Application<span class="nt">&lt;/display-name&gt;</span>



  <span class="c">&lt;!--注册springmvc的serlvet，即前端控制器，处理请求--&gt;</span>
  <span class="nt">&lt;servlet&gt;</span>
    <span class="nt">&lt;servlet-name&gt;</span>springmvc<span class="nt">&lt;/servlet-name&gt;</span>
    <span class="c">&lt;!--servlet-class中的值是spring-webmvc包提供的类，即前端控制器，用于控制所有请求 --&gt;</span>
    <span class="nt">&lt;servlet-class&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="nt">&lt;/servlet-class&gt;</span>
    <span class="nt">&lt;init-param&gt;</span>
      <span class="nt">&lt;param-name&gt;</span>contextConfigLocation<span class="nt">&lt;/param-name&gt;</span>
      <span class="c">&lt;!---加载配置--&gt;</span>
      <span class="nt">&lt;param-value&gt;</span>classpath:application-context.xml<span class="nt">&lt;/param-value&gt;</span>
    <span class="nt">&lt;/init-param&gt;</span>
  <span class="nt">&lt;/servlet&gt;</span>

  <span class="nt">&lt;servlet-mapping&gt;</span>
    <span class="c">&lt;!--        3.编写Controller--&gt;</span>
    <span class="c">&lt;!--        4.在application-context.xml开启扫描--&gt;</span>
    <span class="c">&lt;!--        5.配置视图解析器--&gt;</span>
    <span class="nt">&lt;servlet-name&gt;</span>springmvc<span class="nt">&lt;/servlet-name&gt;</span>
    <span class="c">&lt;!--url-pattern（重点）中有3个值，分别为/、 /*、 *.action --&gt;</span>
    <span class="nt">&lt;url-pattern&gt;</span>/<span class="nt">&lt;/url-pattern&gt;</span>
  <span class="nt">&lt;/servlet-mapping&gt;</span>

  <span class="nt">&lt;welcome-file-list&gt;</span>
    <span class="nt">&lt;welcome-file&gt;</span>ChenLong.jsp<span class="nt">&lt;/welcome-file&gt;</span>
    <span class="nt">&lt;welcome-file&gt;</span>login.jsp<span class="nt">&lt;/welcome-file&gt;</span>
  <span class="nt">&lt;/welcome-file-list&gt;</span>



<span class="nt">&lt;/web-app&gt;</span>
</pre></div>
<h3>六、配置文件</h3>
<h5>1.application-context.xml</h5>
<div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.springframework.org/schema/beans&quot;</span>
       <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
       <span class="na">xmlns:p=</span><span class="s">&quot;http://www.springframework.org/schema/p&quot;</span>
       <span class="na">xmlns:c=</span><span class="s">&quot;http://www.springframework.org/schema/c&quot;</span>
       <span class="na">xmlns:context=</span><span class="s">&quot;http://www.springframework.org/schema/context&quot;</span>
       <span class="na">xmlns:mybatis=</span><span class="s">&quot;http://mybatis.org/schema/mybatis-spring&quot;</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://www.springframework.org/schema/beans</span>
<span class="s">                           https://www.springframework.org/schema/beans/spring-beans.xsd</span>
<span class="s">                           http://www.springframework.org/schema/context</span>
<span class="s">                           https://www.springframework.org/schema/context/spring-context.xsd</span>
<span class="s">                           http://mybatis.org/schema/mybatis-spring</span>
<span class="s">                           http://mybatis.org/schema/mybatis-spring.xsd</span>

<span class="s">http://mybatis.org/schema/mybatis-spring &quot;</span><span class="nt">&gt;</span>

    <span class="c">&lt;!--引入jdbc.properties--&gt;</span>
    <span class="nt">&lt;context:property-placeholder</span> <span class="na">location=</span><span class="s">&quot;classpath:jdbc.properties&quot;</span><span class="nt">/&gt;</span>
    <span class="c">&lt;!--    添加注解支持--&gt;</span>
    <span class="nt">&lt;context:annotation-config/&gt;</span>
    <span class="c">&lt;!--    扫描bean--&gt;</span>
    <span class="nt">&lt;context:component-scan</span> <span class="na">base-package=</span><span class="s">&quot;com&quot;</span><span class="nt">/&gt;</span>

<span class="c">&lt;!--    &lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;--&gt;</span>
<span class="c">&lt;!--        &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;&gt;&lt;/property&gt;--&gt;</span>
<span class="c">&lt;!--    &lt;/bean&gt;--&gt;</span>

    <span class="nt">&lt;import</span> <span class="na">resource=</span><span class="s">&quot;spring-mybatis.xml&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;import</span> <span class="na">resource=</span><span class="s">&quot;spring-mvc.xml&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;import</span> <span class="na">resource=</span><span class="s">&quot;spring-tx.xml&quot;</span><span class="nt">/&gt;</span>



    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;dataSource&quot;</span> <span class="na">class=</span><span class="s">&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;driverClassName&quot;</span> <span class="na">value=</span><span class="s">&quot;${driver}&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;url&quot;</span> <span class="na">value=</span><span class="s">&quot;${url}&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;username&quot;</span> <span class="na">value=</span><span class="s">&quot;${user}&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;password&quot;</span> <span class="na">value=</span><span class="s">&quot;${password}&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/bean&gt;</span>

<span class="nt">&lt;/beans&gt;</span>
</pre></div>
<h5>2.jdbc.properties</h5>
<div class="highlight"><pre><span></span>driver:com.mysql.jdbc.Driver
url:jdbc:mysql://localhost:3306/attendance?useUnicode=true<span class="ni">&amp;amp;</span>characterEncoding=utf8
user:root
password:123456
</pre></div>
<h5>3.log4j.xml</h5>
<div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE log4j:configuration SYSTEM &quot;log4j.dtd&quot;&gt;</span>
<span class="nt">&lt;log4j:configuration</span>
        <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="na">xmlns:log4j=</span><span class="s">&quot;&quot;</span>
        <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://jakarta.apache.org/log4j/ &quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">&quot;console&quot;</span> <span class="na">class=</span><span class="s">&quot;org.apache.log4j.ConsoleAppender&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&quot;Target&quot;</span> <span class="na">value=</span><span class="s">&quot;System.out&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;layout</span> <span class="na">class=</span><span class="s">&quot;org.apache.log4j.PatternLayout&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&quot;ConversionPattern&quot;</span> <span class="na">value=</span><span class="s">&quot;[CateringLog] %d{yyyy-MM-dd HH:mm:ss,SSS} %-5p %c - %m%n&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/layout&gt;</span>
    <span class="nt">&lt;/appender&gt;</span>
    <span class="nt">&lt;appender</span> <span class="na">class=</span><span class="s">&quot;org.apache.log4j.RollingFileAppender&quot;</span> <span class="na">name=</span><span class="s">&quot;file&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&quot;File&quot;</span> <span class="na">value=</span><span class="s">&quot;d:/companyProject/logs/catering.log&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&quot;Append&quot;</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&quot;MaxFileSize&quot;</span> <span class="na">value=</span><span class="s">&quot;1024KB&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&quot;MaxBackupIndex&quot;</span> <span class="na">value=</span><span class="s">&quot;5&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;layout</span> <span class="na">class=</span><span class="s">&quot;org.apache.log4j.PatternLayout&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&quot;ConversionPattern&quot;</span> <span class="na">value=</span><span class="s">&quot;[CateringLog] %d{yyyy-MM-dd HH:mm:ss,SSS} %-5p %c - %m%n&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/layout&gt;</span>
    <span class="nt">&lt;/appender&gt;</span>
    <span class="nt">&lt;root&gt;</span>
        <span class="nt">&lt;priority</span> <span class="na">value=</span><span class="s">&quot;debug&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">&quot;console&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">&quot;file&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/root&gt;</span>
    <span class="c">&lt;!--通过&lt;logger&gt;&lt;/logger&gt;的定义可以将各个包中的类日志输出到不同的日志文件中--&gt;</span>
    <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">&quot;org.springframework&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;level</span> <span class="na">value=</span><span class="s">&quot;ERROR&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/logger&gt;</span>
    <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">&quot;org.mybatis.spring&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;level</span> <span class="na">value=</span><span class="s">&quot;ERROR&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/logger&gt;</span>
    <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">&quot;net.sf.ehcache&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;level</span> <span class="na">value=</span><span class="s">&quot;ERROR&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/logger&gt;</span>
    <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">&quot;com.mchange.v2&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;level</span> <span class="na">value=</span><span class="s">&quot;ERROR&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/logger&gt;</span>
    <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">&quot;java.sql&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;level</span> <span class="na">value=</span><span class="s">&quot;debug&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/logger&gt;</span>
<span class="nt">&lt;/log4j:configuration&gt;</span>
</pre></div>
<h5>4.mybatis-config.xml</h5>
<div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE configuration</span>
<span class="cp">        PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span>
<span class="cp">        &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;settings&gt;</span>
        <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&quot;mapUnderscoreToCamelCase&quot;</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&quot;logImpl&quot;</span> <span class="na">value=</span><span class="s">&quot;STDOUT_LOGGING&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/settings&gt;</span>

    <span class="nt">&lt;typeAliases&gt;</span>
        <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&quot;com.pojo&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/typeAliases&gt;</span>

    <span class="nt">&lt;mappers&gt;</span>
        <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&quot;com.mapper&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/mappers&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</pre></div>
<h5>5.spring-mvc.xml</h5>
<div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.springframework.org/schema/beans&quot;</span>
       <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
       <span class="na">xmlns:mvc=</span><span class="s">&quot;http://www.springframework.org/schema/mvc&quot;</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://www.springframework.org/schema/beans</span>
<span class="s">                           http://www.springframework.org/schema/beans/spring-beans.xsd</span>
<span class="s">                           http://www.springframework.org/schema/mvc</span>
<span class="s">                           https://www.springframework.org/schema/mvc/spring-mvc.xsd</span>
<span class="s">                           &quot;</span><span class="nt">&gt;</span>
<span class="c">&lt;!--    &lt;bean class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;--&gt;</span>
<span class="c">&lt;!--        &lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/pages/&quot;&gt;&lt;/property&gt;--&gt;</span>
<span class="c">&lt;!--        &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;&gt;&lt;/property&gt;--&gt;</span>
<span class="c">&lt;!--    &lt;/bean&gt;--&gt;</span>
    <span class="c">&lt;!--会引起一个严重的后果，controller中的所有url全部是404--&gt;</span>
    <span class="c">&lt;!--    &lt;mvc:view-controller path=&quot;/test&quot; view-name=&quot;success&quot;&gt;&lt;/mvc:view-controller&gt;--&gt;</span>
    <span class="c">&lt;!--告诉springmvc，自己映射的请求就自己处理，不能处理的请求就交给tomcat--&gt;</span>
    <span class="nt">&lt;mvc:default-servlet-handler</span> <span class="nt">/&gt;</span>

    <span class="c">&lt;!--将springmvc，功能全开--&gt;</span>
    <span class="nt">&lt;mvc:annotation-driven</span> <span class="na">conversion-service=</span><span class="s">&quot;convertService&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;convertService&quot;</span> <span class="na">class=</span><span class="s">&quot;org.springframework.format.support.FormattingConversionServiceFactoryBean&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/beans&gt;</span>
</pre></div>
<h5>6.spring-mybatis.xml</h5>
<div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.springframework.org/schema/beans&quot;</span>
       <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
       <span class="na">xmlns:mybatis=</span><span class="s">&quot;http://mybatis.org/schema/mybatis-spring&quot;</span> <span class="na">xmlns:jdbc=</span><span class="s">&quot;http://www.springframework.org/schema/jdbc&quot;</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://www.springframework.org/schema/beans</span>
<span class="s">                           http://www.springframework.org/schema/beans/spring-beans.xsd</span>
<span class="s">                           http://mybatis.org/schema/mybatis-spring</span>
<span class="s">                           http://mybatis.org/schema/mybatis-spring.xsd http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc.xsd&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;sqlSessionFactory&quot;</span> <span class="na">class=</span><span class="s">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;dataSource&quot;</span> <span class="na">ref=</span><span class="s">&quot;dataSource&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;configLocation&quot;</span> <span class="na">value=</span><span class="s">&quot;classpath:mybatis-config.xml&quot;</span><span class="nt">&gt;&lt;/property&gt;</span>
    <span class="nt">&lt;/bean&gt;</span>
    <span class="nt">&lt;mybatis:scan</span> <span class="na">base-package=</span><span class="s">&quot;com.mapper&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/beans&gt;</span>
</pre></div>
<h5>7.spring-tx.xml</h5>
<div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.springframework.org/schema/beans&quot;</span>
       <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
       <span class="na">xmlns:tx=</span><span class="s">&quot;http://www.springframework.org/schema/tx&quot;</span>
       <span class="na">xmlns:aop=</span><span class="s">&quot;http://www.springframework.org/schema/aop&quot;</span>
       <span class="na">xmlns:jdbc=</span><span class="s">&quot;http://www.springframework.org/schema/jdbc&quot;</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://www.springframework.org/schema/beans</span>
<span class="s">                           http://www.springframework.org/schema/beans/spring-beans.xsd</span>
<span class="s">                           http://www.springframework.org/schema/tx</span>
<span class="s">                           https://www.springframework.org/schema/tx/spring-tx.xsd</span>
<span class="s">                           http://www.springframework.org/schema/aop</span>
<span class="s">                           https://www.springframework.org/schema/aop/spring-aop.xsd http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc.xsd&quot;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!--配置事务--&gt;</span>
    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;transactionManager&quot;</span> <span class="na">class=</span><span class="s">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;dataSource&quot;</span> <span class="na">ref=</span><span class="s">&quot;dataSource&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/bean&gt;</span>
    <span class="c">&lt;!--开启事务注解--&gt;</span>
    <span class="nt">&lt;tx:annotation-driven</span> <span class="na">transaction-manager=</span><span class="s">&quot;transactionManager&quot;</span><span class="nt">/&gt;</span>
    <span class="c">&lt;!--配置事务通知--&gt;</span>
    <span class="nt">&lt;tx:advice</span> <span class="na">id=</span><span class="s">&quot;txAdvice&quot;</span> <span class="na">transaction-manager=</span><span class="s">&quot;transactionManager&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;tx:attributes&gt;</span>
            <span class="nt">&lt;tx:method</span> <span class="na">name=</span><span class="s">&quot;*&quot;</span> <span class="na">propagation=</span><span class="s">&quot;REQUIRED&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/tx:attributes&gt;</span>
    <span class="nt">&lt;/tx:advice&gt;</span>
    <span class="c">&lt;!--事务AOP处理--&gt;</span>
    <span class="nt">&lt;aop:config&gt;</span>
        <span class="c">&lt;!--切入点--&gt;</span>
        <span class="nt">&lt;aop:pointcut</span> <span class="na">id=</span><span class="s">&quot;pcuser&quot;</span> <span class="na">expression=</span><span class="s">&quot;execution(* com.service.*.*(..))&quot;</span><span class="nt">/&gt;</span>
        <span class="c">&lt;!--通知--&gt;</span>
        <span class="nt">&lt;aop:advisor</span> <span class="na">advice-ref=</span><span class="s">&quot;txAdvice&quot;</span> <span class="na">pointcut-ref=</span><span class="s">&quot;pcuser&quot;</span><span class="nt">&gt;&lt;/aop:advisor&gt;</span>
    <span class="nt">&lt;/aop:config&gt;</span>
    <span class="nt">&lt;jdbc:embedded-database</span> <span class="na">id=</span><span class="s">&quot;dataSource&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/beans&gt;</span>
</pre></div>
<h3>七、相关代码</h3>
<h5>1.controller包</h5>
<h6>homeController.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.controller</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.service.LogService</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.service.TimeService</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.service.WxUserService</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.text.ParseException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.text.SimpleDateFormat</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @ClassName: homeController</span>
<span class="cm"> * @Description: 用于首页数据的调用</span>
<span class="cm"> * @author: 陈龙</span>
<span class="cm"> * @date: 2020/1/12  22:25</span>
<span class="cm"> * “欢迎您，我的无上至尊”</span>
<span class="cm"> */</span>
<span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;/home&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">homeController</span> <span class="p">{</span>
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">WxUserService</span> <span class="n">wxUserService</span><span class="p">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">LogService</span> <span class="n">logService</span><span class="p">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">TimeService</span> <span class="n">timeService</span><span class="p">;</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;/home&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">inRoom</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">rId</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">state</span><span class="p">,</span> <span class="n">String</span> <span class="n">lDate</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">ParseException</span> <span class="p">{</span>
        <span class="cm">/*</span>
<span class="cm">         * 1.获取此人在的教室，有就返回此教室日志，没有返回的也是空（uId不为空rid为空时）</span>
<span class="cm">         * 2.如果uid和rid不为空说明要进入教室，就更新微信用户表的uid并返回此教室日志</span>
<span class="cm">         * 3.quit为true时为退出，为空时处理其他</span>
<span class="cm">         *</span>
<span class="cm">         *</span>
<span class="cm">         * */</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;uId=&quot;</span><span class="o">+</span><span class="n">uId</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;rId=&quot;</span><span class="o">+</span><span class="n">rId</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;state=&quot;</span><span class="o">+</span><span class="n">state</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;lDate=&quot;</span><span class="o">+</span><span class="n">lDate</span><span class="p">);</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">inRoom</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span>
        <span class="cm">/*退出教室，置为空*/</span>
        <span class="k">if</span><span class="p">(</span><span class="n">state</span><span class="o">!=</span><span class="kc">null</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">state</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="cm">/*离开教室*/</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;离开教室&quot;</span><span class="p">);</span>

<span class="c1">//</span>
                <span class="n">wxUserService</span><span class="p">.</span><span class="na">updateRoom</span><span class="p">(</span><span class="n">uId</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
                <span class="n">logService</span><span class="p">.</span><span class="na">addLog</span><span class="p">(</span><span class="n">uId</span><span class="p">,</span> <span class="n">rId</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">lDate</span><span class="p">);</span>

                <span class="cm">/*计算在这个教室时长*/</span>
                <span class="n">SimpleDateFormat</span> <span class="n">simpleDateFormat</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SimpleDateFormat</span><span class="p">(</span><span class="s">&quot;YYYY-MM-dd HH:mm:ss&quot;</span><span class="p">);</span>
                <span class="n">Date</span> <span class="n">endTime</span> <span class="o">=</span> <span class="n">simpleDateFormat</span><span class="p">.</span><span class="na">parse</span><span class="p">(</span><span class="n">lDate</span><span class="p">);</span>

                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">((</span><span class="n">logService</span><span class="p">.</span><span class="na">getEntryTime</span><span class="p">(</span><span class="n">uId</span><span class="p">,</span> <span class="n">rId</span><span class="p">)).</span><span class="na">get</span><span class="p">(</span><span class="s">&quot;lDate&quot;</span><span class="p">));</span>


                <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">maxDate</span> <span class="o">=</span> <span class="n">logService</span><span class="p">.</span><span class="na">getEntryTime</span><span class="p">(</span><span class="n">uId</span><span class="p">,</span> <span class="n">rId</span><span class="p">);</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">maxDate</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&quot;lDate&quot;</span><span class="p">));</span>

                <span class="n">Date</span> <span class="n">startTime</span> <span class="o">=</span> <span class="n">simpleDateFormat</span><span class="p">.</span><span class="na">parse</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">maxDate</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&quot;lDate&quot;</span><span class="p">)));</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;startTime=&quot;</span><span class="o">+</span><span class="n">startTime</span><span class="p">);</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">startTime</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;xxxx&quot;</span><span class="p">);</span>
                    <span class="kt">long</span> <span class="n">start</span> <span class="o">=</span> <span class="n">startTime</span><span class="p">.</span><span class="na">getTime</span><span class="p">();</span>
                    <span class="kt">long</span> <span class="n">end</span> <span class="o">=</span> <span class="n">endTime</span><span class="p">.</span><span class="na">getTime</span><span class="p">();</span>
                    <span class="kt">long</span> <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">60</span><span class="o">*</span><span class="mi">1000</span><span class="p">);</span>
                    <span class="kt">int</span> <span class="n">time</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">result</span><span class="p">;</span>
                    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;time=&quot;</span><span class="o">+</span><span class="n">time</span><span class="p">);</span>
                <span class="cm">/*如果time表没这个记录就增加，有就更新*/</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">timeService</span><span class="p">.</span><span class="na">checkExist</span><span class="p">(</span><span class="n">uId</span><span class="p">,</span> <span class="n">rId</span><span class="p">)</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;不存在time，要插入&quot;</span><span class="p">);</span>
                    <span class="n">timeService</span><span class="p">.</span><span class="na">updateOrAddTime</span><span class="p">(</span><span class="n">uId</span><span class="p">,</span><span class="n">rId</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="kc">null</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;存在time，要更新&quot;</span><span class="p">);</span>
                    <span class="n">timeService</span><span class="p">.</span><span class="na">updateOrAddTime</span><span class="p">(</span><span class="n">uId</span><span class="p">,</span><span class="n">rId</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>

                <span class="p">}</span>
            <span class="p">}</span>
                <span class="n">inRoom</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;success&quot;</span><span class="p">,</span><span class="s">&quot;退出成功&quot;</span><span class="p">);</span>
                <span class="k">return</span> <span class="n">inRoom</span><span class="p">;</span>
            <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">state</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span><span class="cm">/*进入教室*/</span>
                <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;进入教室&quot;</span><span class="p">);</span>

                <span class="n">logService</span><span class="p">.</span><span class="na">addLog</span><span class="p">(</span><span class="n">uId</span><span class="p">,</span><span class="n">rId</span><span class="p">,</span><span class="n">state</span><span class="p">,</span><span class="n">lDate</span><span class="p">);</span>
                <span class="n">wxUserService</span><span class="p">.</span><span class="na">updateRoom</span><span class="p">(</span><span class="n">uId</span><span class="p">,</span><span class="n">rId</span><span class="p">);</span>


            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">state</span><span class="o">==</span><span class="kc">null</span><span class="p">){</span><span class="cm">/*页面加载获取教室返回空或教师日志等信息*/</span>

            <span class="n">rId</span> <span class="o">=</span> <span class="n">wxUserService</span><span class="p">.</span><span class="na">getOnlineRoom</span><span class="p">(</span><span class="n">uId</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="n">rId</span><span class="o">==</span><span class="kc">null</span><span class="p">){</span>
                <span class="n">inRoom</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;roomLog&quot;</span><span class="p">,</span><span class="kc">null</span><span class="p">);</span>
                <span class="k">return</span> <span class="n">inRoom</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;法身了&quot;</span><span class="p">);</span>


        <span class="n">inRoom</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;roomLog&quot;</span><span class="p">,</span><span class="n">logService</span><span class="p">.</span><span class="na">getLog</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="n">rId</span><span class="p">,</span><span class="kc">null</span><span class="p">));</span>





        <span class="k">return</span> <span class="n">inRoom</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;/test&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">test</span><span class="p">()</span> <span class="kd">throws</span> <span class="n">ParseException</span> <span class="p">{</span>
        <span class="n">String</span> <span class="n">lDate</span> <span class="o">=</span> <span class="s">&quot;2020-01-13 10:23:31&quot;</span> <span class="p">;</span>
        <span class="n">String</span> <span class="n">lDate2</span> <span class="o">=</span> <span class="s">&quot;2020-01-13 10:25:31&quot;</span> <span class="p">;</span>
        <span class="n">SimpleDateFormat</span> <span class="n">simpleDateFormat</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SimpleDateFormat</span><span class="p">(</span><span class="s">&quot;YYYY-MM-dd HH:mm:ss&quot;</span><span class="p">);</span>
        <span class="n">Date</span> <span class="n">startTime</span> <span class="o">=</span> <span class="n">simpleDateFormat</span><span class="p">.</span><span class="na">parse</span><span class="p">(</span><span class="n">lDate</span><span class="p">);</span>
        <span class="n">Date</span> <span class="n">endTime</span> <span class="o">=</span> <span class="n">simpleDateFormat</span><span class="p">.</span><span class="na">parse</span><span class="p">(</span><span class="n">lDate2</span><span class="p">);</span>

        <span class="kt">long</span> <span class="n">start</span> <span class="o">=</span> <span class="n">startTime</span><span class="p">.</span><span class="na">getTime</span><span class="p">();</span>
        <span class="kt">long</span> <span class="n">end</span> <span class="o">=</span> <span class="n">endTime</span><span class="p">.</span><span class="na">getTime</span><span class="p">();</span>
        <span class="kt">long</span> <span class="n">result</span> <span class="o">=</span> <span class="n">end</span><span class="o">-</span><span class="n">start</span><span class="p">;</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;相减为&quot;</span><span class="o">+</span><span class="n">result</span><span class="p">);</span>
        <span class="n">String</span> <span class="n">fuck</span> <span class="o">=</span> <span class="s">&quot;相差&quot;</span><span class="o">+</span><span class="n">result</span><span class="o">/</span><span class="p">(</span><span class="mi">60</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;分钟&quot;</span><span class="p">;</span>

        <span class="k">return</span> <span class="n">fuck</span><span class="p">;</span>

    <span class="p">}</span>


<span class="p">}</span>
</pre></div>
<h6>LogController.java</h6>
<div class="highlight"><pre><span></span>package com.controller;

import com.pojo.Log;
import com.service.LogService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

/**
 * @ClassName: LogController
 * @Description: TODO
 * @author: 陈龙
 * @date: 2020/1/8  0:52
 * “欢迎您，我的无上至尊”
 */
@RestController
@RequestMapping(&quot;/log&quot;)
public class LogController {
    @Autowired
    private LogService logService;

    @GetMapping(value= &quot;/getLog&quot;)
    public Map<span class="nt">&lt;String</span><span class="err">,Object</span><span class="nt">&gt;</span> getLog(Integer uId,Integer rId){
        /*
        * 1.根据uId和rid差某个人在某个教室日志
        * 2.根据uId差某个人所有日志
        * 3.根据sId查某间教室日志
        * 4.根据uId差某个人去过的教室（groupby）
        * 返回的是多表查询*/
        System.out.println(&quot;rid=&quot;+rId);
        System.out.println(&quot;uId=&quot;+uId);
        Map<span class="nt">&lt;String</span><span class="err">,Object</span><span class="nt">&gt;</span> logMap = new HashMap<span class="err">&lt;</span>&gt;();
        logMap.put(&quot;logList&quot;,logService.getLog(uId,rId,null));
        if(uId!=null<span class="err">&amp;&amp;</span>rId==null) {
            logMap.put(&quot;roomList&quot;, logService.getLog(uId, rId, 1));
        }

        return logMap;
    }
}
</pre></div>
<h6>RealNameController.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.controller</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.pojo.RealName</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.service.RealNameService</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @ClassName: RealNameController</span>
<span class="cm"> * @Description: TODO</span>
<span class="cm"> * @author: 陈龙</span>
<span class="cm"> * @date: 2020/1/10  19:37</span>
<span class="cm"> * “欢迎您，我的无上至尊”</span>
<span class="cm"> */</span>

<span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;/realName&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RealNameController</span> <span class="p">{</span>
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">RealNameService</span> <span class="n">realNameService</span><span class="p">;</span>


    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;/tieRealName&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">login</span><span class="p">(</span><span class="n">String</span> <span class="n">uId</span><span class="p">,</span> <span class="n">String</span> <span class="n">sId</span><span class="p">,</span> <span class="n">String</span> <span class="n">password</span><span class="p">,</span> <span class="n">String</span> <span class="n">email</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*</span>
<span class="cm">            实名绑定，todo邮箱认证</span>
<span class="cm">         *</span>
<span class="cm">         * */</span>

        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">msg</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span>
        <span class="n">RealName</span> <span class="n">realName</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RealName</span><span class="p">(</span><span class="n">sId</span><span class="p">,</span><span class="n">password</span><span class="p">,</span><span class="n">email</span><span class="p">);</span>
        <span class="n">RealName</span> <span class="n">getRealName</span> <span class="o">=</span> <span class="n">realNameService</span><span class="p">.</span><span class="na">getBySidAndPwd</span><span class="p">(</span><span class="n">realName</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">getRealName</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">getRealName</span><span class="o">==</span><span class="kc">null</span><span class="p">){</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;不存在或密码错误&quot;</span><span class="p">);</span>
<span class="c1">//            不存在或账号密码错误</span>
            <span class="n">msg</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;success&quot;</span><span class="p">,</span><span class="s">&quot;noExist&quot;</span><span class="p">);</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">getRealName</span><span class="p">.</span><span class="na">getuId</span><span class="p">()</span><span class="o">!=</span><span class="kc">null</span><span class="p">){</span>
<span class="c1">//            已绑定</span>
            <span class="n">msg</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;success&quot;</span><span class="p">,</span><span class="s">&quot;tied&quot;</span><span class="p">);</span>
        <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">getRealName</span><span class="o">!=</span><span class="kc">null</span><span class="o">&amp;&amp;</span><span class="n">getRealName</span><span class="p">.</span><span class="na">getuId</span><span class="p">()</span><span class="o">==</span><span class="kc">null</span><span class="p">){</span>
<span class="c1">//            未绑定且账密正确</span>
            <span class="n">msg</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;success&quot;</span><span class="p">,</span><span class="n">realNameService</span><span class="p">.</span><span class="na">tieUid</span><span class="p">(</span><span class="n">uId</span><span class="p">,</span><span class="n">sId</span><span class="p">));</span>
        <span class="p">}</span>


        <span class="k">return</span> <span class="n">msg</span><span class="p">;</span>

    <span class="p">}</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;/getRealName&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">getByUid</span><span class="p">(</span><span class="n">String</span> <span class="n">uId</span><span class="p">){</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">uId</span><span class="p">);</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">msg</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span>
        <span class="n">msg</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;realNameInfo&quot;</span><span class="p">,</span><span class="n">realNameService</span><span class="p">.</span><span class="na">getByUid</span><span class="p">(</span><span class="n">uId</span><span class="p">));</span>
        <span class="k">return</span> <span class="n">msg</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h6>RoomAdminController.java</h6>
<div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * Copyright (C), 2015-2020, XXX有限公司</span>
<span class="cm"> * FileName: RoomAdminController</span>
<span class="cm"> * Author:   19399</span>
<span class="cm"> * Date:     2020/1/9 19:13</span>
<span class="cm"> * Description: 教室管理</span>
<span class="cm"> * History:</span>
<span class="cm"> * &lt;author&gt;          &lt;time&gt;          &lt;version&gt;          &lt;desc&gt;</span>
<span class="cm"> * 作者姓名           修改时间           版本号              描述</span>
<span class="cm"> */</span>
<span class="kn">package</span> <span class="nn">com.controller</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.pojo.Room</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.pojo.RoomAdmin</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.service.RoomAdminService</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.service.RoomService</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.ui.Model</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.DeleteMapping</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.GetMapping</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.PathVariable</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.PostMapping</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMethod</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * 〈一句话功能简述〉&lt;br&gt; </span>
<span class="cm"> * 〈教室管理〉</span>
<span class="cm"> *</span>
<span class="cm"> * @author 19399</span>
<span class="cm"> * @create 2020/1/9</span>
<span class="cm"> * @since 1.0.0</span>
<span class="cm"> */</span>
<span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;/RoomAdmin&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RoomAdminController</span> <span class="p">{</span>
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">RoomAdminService</span> <span class="n">roomAdminService</span><span class="p">;</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;/roomAdminList&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">getRoomAdminList</span><span class="p">(</span><span class="n">RoomAdmin</span> <span class="n">roomAdmin</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">roomAdminMap</span><span class="o">=</span><span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">RoomAdmin</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">roomAdminService</span><span class="p">.</span><span class="na">getRoomAdminList</span><span class="p">(</span><span class="n">roomAdmin</span><span class="p">);</span>
        <span class="n">roomAdminMap</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;list&quot;</span><span class="p">,</span><span class="n">list</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">roomAdminMap</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nd">@GetMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;/roomAdminListByRId/{rId}&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">getRoomAdminListByRId</span><span class="p">(</span><span class="nd">@PathVariable</span> <span class="n">Integer</span> <span class="n">rId</span><span class="p">,</span> <span class="n">Model</span> <span class="n">model</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">roomAdminList</span><span class="o">=</span><span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">rId</span><span class="p">);</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">RoomAdmin</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">roomAdminService</span><span class="p">.</span><span class="na">getRoomAdminListByRId</span><span class="p">(</span><span class="n">rId</span><span class="p">);</span>
        <span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;roomAdmin&quot;</span><span class="p">,</span> <span class="n">list</span><span class="p">);</span>
        <span class="n">roomAdminList</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;list&quot;</span><span class="p">,</span><span class="n">list</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">roomAdminList</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nd">@GetMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;/roomAdminListByUId/{uId}&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">getRoomAdminListByUId</span><span class="p">(</span><span class="nd">@PathVariable</span> <span class="n">Integer</span> <span class="n">uId</span><span class="p">,</span> <span class="n">Model</span> <span class="n">model</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">roomAdminList1</span><span class="o">=</span><span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">uId</span><span class="p">);</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">RoomAdmin</span><span class="o">&gt;</span> <span class="n">list1</span> <span class="o">=</span> <span class="n">roomAdminService</span><span class="p">.</span><span class="na">getRoomAdminListByUId</span><span class="p">(</span><span class="n">uId</span><span class="p">);</span>
        <span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;roomAdmin1&quot;</span><span class="p">,</span> <span class="n">list1</span><span class="p">);</span>
        <span class="n">roomAdminList1</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;list&quot;</span><span class="p">,</span><span class="n">list1</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">roomAdminList1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;/add&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">GET</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">addRoom</span><span class="p">(</span><span class="n">RoomAdmin</span> <span class="n">roomAdmin</span><span class="p">,</span> <span class="n">Model</span> <span class="n">model</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">((</span><span class="n">roomAdminService</span><span class="p">.</span><span class="na">getRoomAdminListByRId</span><span class="p">(</span><span class="n">roomAdmin</span><span class="p">.</span><span class="na">getrId</span><span class="p">())</span><span class="o">!=</span><span class="kc">null</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="n">roomAdminService</span><span class="p">.</span><span class="na">getRoomAdminListByUId</span><span class="p">(</span><span class="n">roomAdmin</span><span class="p">.</span><span class="na">getuId</span><span class="p">())</span><span class="o">!=</span><span class="kc">null</span><span class="p">)){</span>
            <span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;msg&quot;</span><span class="p">,</span> <span class="s">&quot;该管理员已管理该间教室&quot;</span><span class="p">);</span>
            <span class="k">return</span> <span class="s">&quot;error&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kt">boolean</span> <span class="n">result</span><span class="o">=</span><span class="n">roomAdminService</span><span class="p">.</span><span class="na">addRoomAdmin</span><span class="p">(</span><span class="n">roomAdmin</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;添加成功&quot;</span><span class="p">);</span>
            <span class="k">return</span> <span class="s">&quot;success&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;添加失败&quot;</span><span class="p">);</span>
            <span class="k">return</span> <span class="s">&quot;error&quot;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nd">@DeleteMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;/delete&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteRoom</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rId</span><span class="p">,</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">,</span> <span class="n">Model</span> <span class="n">model</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">roomAdminService</span><span class="p">.</span><span class="na">deleteRoomById</span><span class="p">(</span><span class="n">rId</span><span class="p">,</span><span class="n">uId</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@PostMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;/addRoomAdmin&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">addRoomAdmin</span><span class="p">(</span><span class="n">RoomAdmin</span> <span class="n">roomAdmin</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">boolean</span> <span class="n">result</span><span class="o">=</span><span class="n">roomAdminService</span><span class="p">.</span><span class="na">addRoomAdmin</span><span class="p">(</span><span class="n">roomAdmin</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;删除成功&quot;</span><span class="p">);</span>
            <span class="k">return</span> <span class="s">&quot;success&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;删除失败&quot;</span><span class="p">);</span>
            <span class="k">return</span> <span class="s">&quot;error&quot;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h6>RoomController.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.controller</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.pojo.Room</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.service.RoomService</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @ClassName: RoomController</span>
<span class="cm"> * @Description: TODO</span>
<span class="cm"> * @author: 陈龙</span>
<span class="cm"> * @date: 2020/1/12  23:33</span>
<span class="cm"> * “欢迎您，我的无上至尊”</span>
<span class="cm"> */</span>
<span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;/room&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RoomController</span> <span class="p">{</span>
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">RoomService</span> <span class="n">roomService</span><span class="p">;</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;/room&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">getRoomList</span><span class="p">(){</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">msg</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span>
        <span class="n">Room</span> <span class="n">room</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Room</span><span class="p">();</span>
        <span class="n">msg</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;roomList&quot;</span><span class="p">,</span><span class="n">roomService</span><span class="p">.</span><span class="na">getRoomList</span><span class="p">(</span><span class="n">room</span><span class="p">));</span>
        <span class="k">return</span> <span class="n">msg</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h6>RoomNoticeController.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.controller</span><span class="p">;</span>


<span class="kn">import</span> <span class="nn">com.pojo.RoomNotice</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.service.RoomNoticeService</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Param</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.*</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.text.SimpleDateFormat</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="p">;</span>

<span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;/roomNotice&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RoomNoticeController</span> <span class="p">{</span>
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">RoomNoticeService</span> <span class="n">roomNoticeService</span><span class="p">;</span>
    <span class="c1">//通过rid查询教室公告</span>
    <span class="nd">@GetMapping</span><span class="p">(</span><span class="n">value</span><span class="o">=</span> <span class="s">&quot;/getRoomNoticeByRid/{rid}&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">getRoomNoticeByRid</span><span class="p">(</span><span class="nd">@PathVariable</span> <span class="n">Integer</span> <span class="n">rid</span><span class="p">){</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;通过&quot;</span><span class="o">+</span><span class="n">rid</span><span class="o">+</span><span class="s">&quot;查询课室公告&quot;</span><span class="p">);</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">RoomNoticeMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">RoomNotice</span><span class="o">&gt;</span> <span class="n">RoomNoticeList</span> <span class="o">=</span> <span class="n">roomNoticeService</span><span class="p">.</span><span class="na">getRoomNoticeByRid</span><span class="p">(</span><span class="n">rid</span><span class="p">);</span>
        <span class="n">RoomNoticeMap</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;roomNoticeList&quot;</span><span class="p">,</span><span class="n">RoomNoticeList</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">RoomNoticeMap</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">//通过uid查询教室公告</span>
    <span class="nd">@GetMapping</span><span class="p">(</span><span class="n">value</span><span class="o">=</span> <span class="s">&quot;/getRoomNoticeByUid/{uid}&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">getRoomNoticeByUid</span><span class="p">(</span><span class="nd">@PathVariable</span> <span class="n">Integer</span> <span class="n">uid</span><span class="p">){</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;通过&quot;</span><span class="o">+</span><span class="n">uid</span><span class="o">+</span><span class="s">&quot;查询课室公告&quot;</span><span class="p">);</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">RoomNoticeMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">RoomNotice</span><span class="o">&gt;</span> <span class="n">RoomNoticeList</span> <span class="o">=</span> <span class="n">roomNoticeService</span><span class="p">.</span><span class="na">getRoomNoticeByUid</span><span class="p">(</span><span class="n">uid</span><span class="p">);</span>
        <span class="n">RoomNoticeMap</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;roomNoticeList&quot;</span><span class="p">,</span><span class="n">RoomNoticeList</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">RoomNoticeMap</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">//查询所有课室公告</span>
    <span class="nd">@GetMapping</span><span class="p">(</span><span class="n">value</span><span class="o">=</span> <span class="s">&quot;/getAllRoomNotice&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">getAllRoomNotice</span><span class="p">(){</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;执行了查询所有课室公告的方法&quot;</span><span class="p">);</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">RoomNoticeMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">RoomNotice</span><span class="o">&gt;</span> <span class="n">RoomNoticeList</span> <span class="o">=</span> <span class="n">roomNoticeService</span><span class="p">.</span><span class="na">getAllRoomNotice</span><span class="p">();</span>
        <span class="n">RoomNoticeMap</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;roomNoticeList&quot;</span><span class="p">,</span><span class="n">RoomNoticeList</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">RoomNoticeMap</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">//通过页面表单插入一条教室公告，插入没有约束</span>
    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span><span class="o">=</span> <span class="s">&quot;/insertRoomNotice&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">insertRoomNotice</span><span class="p">(</span><span class="n">RoomNotice</span> <span class="n">bean</span><span class="p">){</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;执行了插入一条课室公告的方法&quot;</span><span class="p">);</span>
        <span class="c1">//Map&lt;String,Object&gt; RoomNoticeMap = new HashMap&lt;&gt;();</span>
        <span class="kt">boolean</span> <span class="n">result</span> <span class="o">=</span> <span class="n">roomNoticeService</span><span class="p">.</span><span class="na">insertRoomNotice</span><span class="p">(</span><span class="n">bean</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;插入成功&quot;</span><span class="p">);</span>
            <span class="k">return</span> <span class="s">&quot;index.jsp&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span><span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;插入失败&quot;</span><span class="p">);</span>
            <span class="k">return</span> <span class="s">&quot;error.jsp&quot;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">//更新一条课室公告。自动生成修改时间</span>
    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span><span class="o">=</span> <span class="s">&quot;/updateRoomNotice&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">updateRoomNotice</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rId</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">uId</span><span class="p">,</span> <span class="n">String</span> <span class="n">notice</span><span class="p">){</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;执行了更新一条课室公告的方法&quot;</span><span class="p">);</span>
        <span class="n">Calendar</span> <span class="n">calendar</span><span class="o">=</span> <span class="n">Calendar</span><span class="p">.</span><span class="na">getInstance</span><span class="p">();</span>
        <span class="n">SimpleDateFormat</span> <span class="n">dateFormat</span><span class="o">=</span> <span class="k">new</span> <span class="n">SimpleDateFormat</span><span class="p">(</span><span class="s">&quot;yyyy-MM-dd :hh:mm:ss&quot;</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;第一种获取日期方式：&quot;</span><span class="o">+</span><span class="n">dateFormat</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="n">calendar</span><span class="p">.</span><span class="na">getTime</span><span class="p">()));</span>
        <span class="n">Date</span> <span class="n">cDate</span> <span class="o">=</span>  <span class="k">new</span> <span class="n">Date</span><span class="p">();</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;第二种获取日期方式：&quot;</span><span class="o">+</span><span class="n">cDate</span><span class="p">);</span><span class="c1">//自动生成时间</span>
        <span class="kt">boolean</span> <span class="n">result</span> <span class="o">=</span> <span class="n">roomNoticeService</span><span class="p">.</span><span class="na">updateRoomNotice</span><span class="p">(</span><span class="n">rId</span><span class="p">,</span><span class="n">uId</span><span class="p">,</span><span class="n">notice</span><span class="p">,</span><span class="n">cDate</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
        <span class="k">return</span> <span class="s">&quot;result&quot;</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
<h6>TimeController.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.controller</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.service.TimeService</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.service.WxUserService</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @ClassName: TimeController</span>
<span class="cm"> * @Description: TODO</span>
<span class="cm"> * @author: 陈龙</span>
<span class="cm"> * @date: 2020/1/11  23:52</span>
<span class="cm"> * “欢迎您，我的无上至尊”</span>
<span class="cm"> */</span>
<span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;/time&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TimeController</span> <span class="p">{</span>
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">TimeService</span> <span class="n">timeService</span><span class="p">;</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;/getAllUserTime&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">getAllUserTime</span><span class="p">(){</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">msg</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span>
        <span class="n">msg</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;allUserTime&quot;</span><span class="p">,</span><span class="n">timeService</span><span class="p">.</span><span class="na">getAllUserTime</span><span class="p">());</span>
        <span class="k">return</span> <span class="n">msg</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h6>WxUserController.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.controller</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.pojo.WxUser</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.service.LogService</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.service.WxUserService</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.ui.Model</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMethod</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @ClassName: WxUserController</span>
<span class="cm"> * @Description: TODO</span>
<span class="cm"> * @author: 陈龙</span>
<span class="cm"> * @date: 2020/1/5  21:42</span>
<span class="cm"> * “欢迎您，我的无上至尊”</span>
<span class="cm"> */</span>
<span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;/wxUser&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WxUserController</span> <span class="p">{</span>
   <span class="nd">@Autowired</span>
   <span class="kd">private</span> <span class="n">WxUserService</span> <span class="n">wxUserService</span><span class="p">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">LogService</span> <span class="n">logService</span><span class="p">;</span>







    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;/login&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">login</span><span class="p">(</span><span class="n">String</span> <span class="n">avatarUrl</span><span class="p">,</span><span class="n">String</span> <span class="n">openId</span><span class="p">,</span><span class="n">String</span> <span class="n">nickName</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*</span>
<span class="cm">         * 1.验证数据库有没此用户，就添加，并返回是新用户(用于前端提示实名注册)</span>
<span class="cm">         * 2.如果是老用户，就更新，返回老用户（提示欢迎回来）</span>
<span class="cm">         *</span>
<span class="cm">         * */</span>

        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">wxUserMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span>
        <span class="n">WxUser</span> <span class="n">wxUser</span> <span class="o">=</span> <span class="k">new</span> <span class="n">WxUser</span><span class="p">(</span><span class="n">openId</span><span class="p">,</span><span class="n">nickName</span><span class="p">,</span><span class="n">avatarUrl</span><span class="p">);</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">wxUser</span><span class="p">);</span>
        <span class="n">wxUser</span><span class="p">.</span><span class="na">toString</span><span class="p">();</span>


        <span class="k">if</span><span class="p">(</span><span class="n">wxUserService</span><span class="p">.</span><span class="na">getUserByUidOrOpenid</span><span class="p">(</span><span class="n">wxUser</span><span class="p">)</span><span class="o">==</span><span class="kc">null</span><span class="p">){</span>
            <span class="n">wxUserMap</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;success&quot;</span><span class="p">,</span><span class="n">wxUserService</span><span class="p">.</span><span class="na">insertWxUser</span><span class="p">(</span><span class="n">wxUser</span><span class="p">));</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="n">wxUserMap</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;success&quot;</span><span class="p">,</span><span class="kc">null</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">wxUserMap</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;wxUserInfo&quot;</span><span class="p">,</span><span class="n">wxUserService</span><span class="p">.</span><span class="na">getUserByUidOrOpenid</span><span class="p">(</span><span class="n">wxUser</span><span class="p">));</span>

        <span class="k">return</span> <span class="n">wxUserMap</span><span class="p">;</span>

    <span class="p">}</span>















    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;/users&quot;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">GET</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getOnlineUser</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rId</span><span class="p">,</span> <span class="n">Model</span> <span class="n">model</span><span class="p">)</span> <span class="p">{</span>

        <span class="kt">int</span> <span class="n">count</span><span class="p">;</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">wxUserService</span><span class="p">.</span><span class="na">getOnlineUser</span><span class="p">(</span><span class="n">rId</span><span class="p">);</span>
        <span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;count&quot;</span><span class="p">,</span> <span class="n">count</span><span class="p">);</span>
        <span class="k">return</span> <span class="s">&quot;index&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;/list&quot;</span><span class="p">,</span><span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">GET</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getAllWxUser</span><span class="p">(</span><span class="n">Model</span> <span class="n">model</span><span class="p">)</span> <span class="p">{</span>

        <span class="n">List</span><span class="o">&lt;</span><span class="n">WxUser</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">wxUserService</span><span class="p">.</span><span class="na">getAllWxUser</span><span class="p">();</span>
        <span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;list&quot;</span><span class="p">,</span> <span class="n">list</span><span class="p">);</span>
        <span class="k">return</span> <span class="s">&quot;AllWxUser&quot;</span><span class="p">;</span><span class="c1">//前端页面</span>

    <span class="p">}</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span><span class="s">&quot;/edit&quot;</span><span class="p">,</span><span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="p">.</span><span class="na">POST</span><span class="p">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">updateWxUser</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rid</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">uId</span><span class="p">,</span> <span class="n">Model</span> <span class="n">model</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">boolean</span> <span class="n">result</span> <span class="o">=</span> <span class="n">wxUserService</span><span class="p">.</span><span class="na">updateWxUser</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span> <span class="n">uId</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">==</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;item&quot;</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;msg&quot;</span><span class="p">,</span> <span class="s">&quot;更新失败&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nd">@RequestMapping</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span><span class="s">&quot;/test&quot;</span><span class="p">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">test</span><span class="p">(){</span>
        <span class="k">return</span> <span class="s">&quot;fuck&quot;</span><span class="p">;</span>
    <span class="p">}</span>


<span class="p">}</span>
</pre></div>
<h5>2.mapper包</h5>
<h6>LogMapper.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.mapper</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.pojo.Log</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.pojo.Time</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Param</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Repository</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="p">;</span>

<span class="nd">@Mapper</span>
<span class="nd">@Repository</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">LogMapper</span> <span class="p">{</span>
<span class="c1">//    在退出时返回进入时的时间</span>
    <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">getEntryTime</span><span class="p">(</span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;uId&quot;</span><span class="p">)</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">,</span> <span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;rId&quot;</span><span class="p">)</span><span class="n">Integer</span> <span class="n">rId</span><span class="p">);</span>
<span class="c1">//    添加日志</span>
    <span class="kt">boolean</span> <span class="nf">addLog</span><span class="p">(</span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;uId&quot;</span><span class="p">)</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">,</span> <span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;rId&quot;</span><span class="p">)</span><span class="n">Integer</span> <span class="n">rId</span><span class="p">,</span>
                   <span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;state&quot;</span><span class="p">)</span><span class="n">Integer</span> <span class="n">state</span><span class="p">,</span> <span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;lDate&quot;</span><span class="p">)</span><span class="n">String</span> <span class="n">lDate</span><span class="p">)</span> <span class="p">;</span>
    <span class="c1">//动态获取log</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;&gt;</span> <span class="nf">getLog</span><span class="p">(</span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;uId&quot;</span><span class="p">)</span> <span class="n">Integer</span> <span class="n">uId</span><span class="p">,</span> <span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;rId&quot;</span><span class="p">)</span> <span class="n">Integer</span> <span class="n">rId</span><span class="p">,</span> <span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;room&quot;</span><span class="p">)</span> <span class="n">Integer</span> <span class="n">room</span><span class="p">);</span>
<span class="c1">//    根据教室rid获取教室日志,如果没有rid就查找全部</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Log</span><span class="o">&gt;</span> <span class="nf">getLogByRid</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rid</span><span class="p">);</span>
<span class="c1">//    获取我去过的教室根据uid</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">getMyRoomByUid</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uid</span><span class="p">);</span>
<span class="c1">//    根据uid和rid获取我在某个教室的日志</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Log</span><span class="o">&gt;</span> <span class="nf">getMyRoomLog</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uid</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">rid</span><span class="p">);</span>


<span class="p">}</span>
</pre></div>
<h6>RealNameMapper.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.mapper</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.pojo.RealName</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Param</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Repository</span><span class="p">;</span>

<span class="nd">@Mapper</span>
<span class="nd">@Repository</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">RealNameMapper</span> <span class="p">{</span>
<span class="c1">//    根据学号和密码返回</span>
     <span class="n">RealName</span> <span class="nf">getBySidAndPwd</span><span class="p">(</span><span class="n">RealName</span> <span class="n">realName</span><span class="p">);</span>

<span class="c1">//     绑定微信用户到学号</span>
    <span class="kt">boolean</span> <span class="nf">tieUid</span><span class="p">(</span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;uId&quot;</span><span class="p">)</span> <span class="n">String</span> <span class="n">uId</span><span class="p">,</span> <span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;sId&quot;</span><span class="p">)</span> <span class="n">String</span> <span class="n">sId</span><span class="p">);</span>

<span class="c1">//    根据uid返回除密码外的实名信息</span>
    <span class="n">RealName</span> <span class="nf">getByUid</span><span class="p">(</span><span class="n">String</span> <span class="n">uid</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h6>RoomAdminMapper.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.mapper</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.pojo.Room</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.pojo.RoomAdmin</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Repository</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @ClassName: RoomAdminMapper</span>
<span class="cm"> * @Description: TODO</span>
<span class="cm"> * @author: 陈龙</span>
<span class="cm"> * @date: 2020/1/7  23:44</span>
<span class="cm"> * “欢迎您，我的无上至尊”</span>
<span class="cm"> */</span>

<span class="nd">@Mapper</span>
<span class="nd">@Repository</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">RoomAdminMapper</span> <span class="p">{</span>
    <span class="cm">/*</span>
<span class="cm">    用户与教室的中间表</span>
<span class="cm">    增加管理员管理某个教室</span>
<span class="cm">    关联删除，删除某个教室的某个管理员</span>
<span class="cm">       删除，把del置为0</span>
<span class="cm">       根据*rid与room表联系，一对多/</span>
<span class="cm">       查询所有管理员及他管理的教室</span>
<span class="cm">     */</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">RoomAdmin</span><span class="o">&gt;</span> <span class="nf">getRoomAdminList</span><span class="p">(</span><span class="n">RoomAdmin</span> <span class="n">roomAdmin</span><span class="p">);</span><span class="c1">//搜索</span>

    <span class="kt">boolean</span> <span class="nf">addRoomAdmin</span><span class="p">(</span><span class="n">RoomAdmin</span> <span class="n">roomAdmin</span><span class="p">);</span><span class="c1">//为某间教室添加管理员</span>

    <span class="kt">boolean</span> <span class="nf">deleteRoomById</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rId</span><span class="p">,</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">);</span><span class="c1">//删除</span>

    <span class="n">List</span><span class="o">&lt;</span><span class="n">RoomAdmin</span><span class="o">&gt;</span> <span class="nf">getRoomAdminListByRId</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rId</span><span class="p">);</span><span class="c1">//根据rId搜索roomadmin</span>

    <span class="n">List</span><span class="o">&lt;</span><span class="n">RoomAdmin</span><span class="o">&gt;</span> <span class="nf">getRoomAdminListByUId</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">);</span><span class="c1">//根据uId搜索roomadmin</span>

<span class="p">}</span>
</pre></div>
<h6>RoomMapper.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.mapper</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.pojo.Room</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Repository</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

<span class="nd">@Mapper</span>
<span class="nd">@Repository</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">RoomMapper</span> <span class="p">{</span>
    <span class="cm">/**</span>
<span class="cm">     * 获取教室列表</span>
<span class="cm">     * @param room</span>
<span class="cm">     */</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Room</span><span class="o">&gt;</span> <span class="nf">getRoomList</span><span class="p">(</span><span class="n">Room</span> <span class="n">room</span><span class="p">);</span>
    <span class="cm">/**</span>
<span class="cm">     * 根据Id获取供应商</span>
<span class="cm">     * @param rId</span>
<span class="cm">     */</span>
   <span class="cm">/* Room getRoomById(Integer rId);</span>
<span class="cm">    *//**增加*//*</span>
<span class="cm">    boolean addRoom(Room room);</span>
<span class="cm">    *//**删除供应商*//*</span>
<span class="cm">    boolean deleteRoom(Integer rId);</span>
<span class="cm">    *//**编辑*//*</span>
<span class="cm">    boolean updateRoom(Room room);</span>
<span class="cm">    //一对多查询</span>
<span class="cm">    List&lt;Room&gt; selectRoomById(Integer rId);//在房间表中根据rId联立查询*/</span>
<span class="p">}</span>
</pre></div>
<h6>RoomNoticeMapper.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.mapper</span><span class="p">;</span>


<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Param</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Repository</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.pojo.RoomNotice</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

<span class="nd">@Mapper</span>
<span class="nd">@Repository</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">RoomNoticeMapper</span> <span class="p">{</span>
    <span class="c1">//    根据教室rid获取教室公告,</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">RoomNotice</span><span class="o">&gt;</span> <span class="nf">getRoomNoticeByRid</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rid</span><span class="p">);</span>

    <span class="c1">//    根据教室Uid获取教室公告,</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">RoomNotice</span><span class="o">&gt;</span> <span class="nf">getRoomNoticeByUid</span><span class="p">(</span><span class="n">Integer</span> <span class="n">Uid</span><span class="p">);</span>

    <span class="c1">//   查询所有教室公告的信息</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">RoomNotice</span><span class="o">&gt;</span> <span class="nf">getAllRoomNotice</span><span class="p">();</span>

    <span class="c1">//   根据rid插入一条课室公告</span>
    <span class="n">Boolean</span> <span class="nf">insertRoomNotice</span><span class="p">(</span><span class="n">RoomNotice</span> <span class="n">bean</span> <span class="p">);</span>

    <span class="c1">//   更新一条课室公告</span>
    <span class="kt">boolean</span> <span class="nf">updateRoomNotice</span><span class="p">(</span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;rId&quot;</span><span class="p">)</span> <span class="n">Integer</span> <span class="n">rid</span><span class="p">,</span> <span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;uId&quot;</span><span class="p">)</span> <span class="n">Integer</span> <span class="n">uid</span><span class="p">,</span> <span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;notice&quot;</span><span class="p">)</span> <span class="n">String</span> <span class="n">notice</span><span class="p">,</span> <span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;cDate&quot;</span><span class="p">)</span> <span class="n">Date</span> <span class="n">cDate</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h6>TimeMapper.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.mapper</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.pojo.Time</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Repository</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @ClassName: TimeMapper</span>
<span class="cm"> * @Description: TODO</span>
<span class="cm"> * @author: 陈龙28</span>
<span class="cm"> * @date: 2020/1/8  22:</span>
<span class="cm"> * “欢迎您，我的无上至尊”</span>
<span class="cm"> */</span>
<span class="nd">@Mapper</span>
<span class="nd">@Repository</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">TimeMapper</span> <span class="p">{</span>

    <span class="c1">//  查询所有活跃度</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Time</span><span class="o">&gt;</span> <span class="nf">getTime</span><span class="p">();</span>

    <span class="c1">//  根据uid查询所有房间的活跃度</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Time</span><span class="o">&gt;</span> <span class="nf">getTimeByUid</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uid</span><span class="p">);</span>

    <span class="c1">//  对累计活跃度进行降序排行-</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Time</span><span class="o">&gt;</span> <span class="nf">getAllTime</span><span class="p">();</span>

    <span class="c1">//  根据uid查询累计活跃度</span>
    <span class="n">Time</span> <span class="nf">getAllTimeByUid</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uid</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h6>WxUserMapper.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.mapper</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.pojo.WxUser</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Param</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Repository</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @ClassName: UserMapper</span>
<span class="cm"> * @Description: TODO</span>
<span class="cm"> * @author: 陈龙</span>
<span class="cm"> * @date: 2020/1/5  20:54</span>
<span class="cm"> * “欢迎您，我的无上至尊”</span>
<span class="cm"> */</span>
<span class="nd">@Mapper</span>
<span class="nd">@Repository</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">WxUserMapper</span> <span class="p">{</span>


<span class="c1">//    根据uid获取此人所在教室</span>
    <span class="n">Integer</span> <span class="nf">getOnlineRoom</span><span class="p">(</span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;uId&quot;</span><span class="p">)</span> <span class="n">Integer</span> <span class="n">uId</span><span class="p">);</span>
<span class="c1">//    更新用户表的在线教室，rid为空就置为空，否则更新</span>
    <span class="kt">boolean</span> <span class="nf">updateRoom</span><span class="p">(</span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;uId&quot;</span><span class="p">)</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">,</span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;rId&quot;</span><span class="p">)</span><span class="n">Integer</span> <span class="n">rId</span><span class="p">);</span>
<span class="c1">//    获取某个人在哪个教室，并获取这个教室的日志</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;&gt;</span> <span class="nf">isInRoom</span><span class="p">(</span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;uId&quot;</span><span class="p">)</span> <span class="n">Integer</span> <span class="n">uId</span><span class="p">);</span>

    <span class="n">List</span><span class="o">&lt;</span><span class="n">WxUser</span><span class="o">&gt;</span> <span class="nf">getAllWxUser</span><span class="p">();</span>

<span class="c1">//    根据uid或openid获取用户信息,此方法1为通过uid查询，2为通过openid查询</span>
    <span class="n">WxUser</span> <span class="nf">getUserByUidOrOpenid</span><span class="p">(</span><span class="n">WxUser</span> <span class="n">wxUser</span><span class="p">);</span>

<span class="c1">//    插入微信用户</span>
    <span class="kt">boolean</span> <span class="nf">insertWxUser</span><span class="p">(</span><span class="n">WxUser</span> <span class="n">wxUser</span><span class="p">);</span>


    <span class="n">List</span><span class="o">&lt;</span><span class="n">WxUser</span><span class="o">&gt;</span> <span class="nf">getWxUserList</span><span class="p">();</span>

    <span class="kt">int</span> <span class="nf">getOnlineUser</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rid</span><span class="p">);</span>

    <span class="kt">boolean</span> <span class="nf">updateWxUser</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rid</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">uId</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h5>3.pojo包</h5>
<h6>log.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.pojo</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @ClassName: Log</span>
<span class="cm"> * @Description: TODO</span>
<span class="cm"> * @author: 陈龙</span>
<span class="cm"> * @date: 2020/1/5  20:43</span>
<span class="cm"> * “欢迎您，我的无上至尊”</span>
<span class="cm"> */</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Log</span> <span class="p">{</span>

<span class="cm">/*    -- 日志表</span>
<span class="cm">    create table log(</span>
<span class="cm">            lId int primary key,</span>
<span class="cm">            uId int not null,</span>
<span class="cm">            rId int not null,</span>
<span class="cm">            state int not null,</span>
<span class="cm">            lDate date not null</span>
<span class="cm">    );*/</span>

    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">lId</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">uId</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">rId</span><span class="p">;</span>
<span class="c1">//    1为进，0为出</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">state</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">Date</span> <span class="n">lDate</span><span class="p">;</span>

    <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getlId</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">lId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setlId</span><span class="p">(</span><span class="n">Integer</span> <span class="n">lId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">lId</span> <span class="o">=</span> <span class="n">lId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getUid</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">uId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUid</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">uId</span> <span class="o">=</span> <span class="n">uId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getrId</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">rId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setrId</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">rId</span> <span class="o">=</span> <span class="n">rId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getState</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">state</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setState</span><span class="p">(</span><span class="n">Integer</span> <span class="n">state</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">state</span> <span class="o">=</span> <span class="n">state</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">Date</span> <span class="nf">getlDate</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">lDate</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setlDate</span><span class="p">(</span><span class="n">Date</span> <span class="n">lDate</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">lDate</span> <span class="o">=</span> <span class="n">lDate</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="nf">Log</span><span class="p">(</span><span class="n">Integer</span> <span class="n">lId</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">uId</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">rId</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">state</span><span class="p">,</span> <span class="n">Date</span> <span class="n">lDate</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">lId</span> <span class="o">=</span> <span class="n">lId</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">uId</span> <span class="o">=</span> <span class="n">uId</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">rId</span> <span class="o">=</span> <span class="n">rId</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">state</span> <span class="o">=</span> <span class="n">state</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">lDate</span> <span class="o">=</span> <span class="n">lDate</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;Log{&quot;</span> <span class="o">+</span>
                <span class="s">&quot;lId=&quot;</span> <span class="o">+</span> <span class="n">lId</span> <span class="o">+</span>
                <span class="s">&quot;, uId=&quot;</span> <span class="o">+</span> <span class="n">uId</span> <span class="o">+</span>
                <span class="s">&quot;, rId=&quot;</span> <span class="o">+</span> <span class="n">rId</span> <span class="o">+</span>
                <span class="s">&quot;, state=&quot;</span> <span class="o">+</span> <span class="n">state</span> <span class="o">+</span>
                <span class="s">&quot;, lDate=&quot;</span> <span class="o">+</span> <span class="n">lDate</span> <span class="o">+</span>
                <span class="sc">&#39;}&#39;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h6>RealName.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.pojo</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @ClassName: RealName</span>
<span class="cm"> * @Description: TODO</span>
<span class="cm"> * @author: 陈龙</span>
<span class="cm"> * @date: 2020/1/5  20:10</span>
<span class="cm"> * “欢迎您，我的无上至尊”</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RealName</span> <span class="p">{</span>
<span class="cm">/*    -- 实名表</span>
<span class="cm">    create table realName(</span>
<span class="cm">            uId int,</span>
<span class="cm">            sId varchar(20) primary key,</span>
<span class="cm">    password varchar(30) not null,</span>
<span class="cm">    pNumber varchar(20) unique not null,</span>
<span class="cm">    email varchar(30) unique not null</span>

<span class="cm">            );*/</span>

    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">uId</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">sId</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">password</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">pNumber</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">email</span><span class="p">;</span>

    <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getuId</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">uId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setuId</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">uId</span> <span class="o">=</span> <span class="n">uId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getsId</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">sId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setsId</span><span class="p">(</span><span class="n">String</span> <span class="n">sId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">sId</span> <span class="o">=</span> <span class="n">sId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getPassword</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">password</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setPassword</span><span class="p">(</span><span class="n">String</span> <span class="n">password</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">password</span> <span class="o">=</span> <span class="n">password</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getpNumber</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">pNumber</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setpNumber</span><span class="p">(</span><span class="n">String</span> <span class="n">pNumber</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">pNumber</span> <span class="o">=</span> <span class="n">pNumber</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getEmail</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">email</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setEmail</span><span class="p">(</span><span class="n">String</span> <span class="n">email</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">email</span> <span class="o">=</span> <span class="n">email</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="nf">RealName</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">,</span> <span class="n">String</span> <span class="n">sId</span><span class="p">,</span> <span class="n">String</span> <span class="n">password</span><span class="p">,</span> <span class="n">String</span> <span class="n">pNumber</span><span class="p">,</span> <span class="n">String</span> <span class="n">email</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">uId</span> <span class="o">=</span> <span class="n">uId</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">sId</span> <span class="o">=</span> <span class="n">sId</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">password</span> <span class="o">=</span> <span class="n">password</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">pNumber</span> <span class="o">=</span> <span class="n">pNumber</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">email</span> <span class="o">=</span> <span class="n">email</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="nf">RealName</span><span class="p">(</span> <span class="n">String</span> <span class="n">sId</span><span class="p">,</span> <span class="n">String</span> <span class="n">password</span><span class="p">,</span> <span class="n">String</span> <span class="n">email</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">sId</span> <span class="o">=</span> <span class="n">sId</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">password</span> <span class="o">=</span> <span class="n">password</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">email</span> <span class="o">=</span> <span class="n">email</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="nf">RealName</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;RealName{&quot;</span> <span class="o">+</span>
                <span class="s">&quot;uId=&quot;</span> <span class="o">+</span> <span class="n">uId</span> <span class="o">+</span>
                <span class="s">&quot;, sId=&#39;&quot;</span> <span class="o">+</span> <span class="n">sId</span> <span class="o">+</span> <span class="sc">&#39;\&#39;&#39;</span> <span class="o">+</span>
                <span class="s">&quot;, password=&#39;&quot;</span> <span class="o">+</span> <span class="n">password</span> <span class="o">+</span> <span class="sc">&#39;\&#39;&#39;</span> <span class="o">+</span>
                <span class="s">&quot;, pNumber=&#39;&quot;</span> <span class="o">+</span> <span class="n">pNumber</span> <span class="o">+</span> <span class="sc">&#39;\&#39;&#39;</span> <span class="o">+</span>
                <span class="s">&quot;, email=&#39;&quot;</span> <span class="o">+</span> <span class="n">email</span> <span class="o">+</span> <span class="sc">&#39;\&#39;&#39;</span> <span class="o">+</span>
                <span class="sc">&#39;}&#39;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h6>Room.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.pojo</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @ClassName: Room</span>
<span class="cm"> * @Description: TODO</span>
<span class="cm"> * @author: 陈龙</span>
<span class="cm"> * @date: 2020/1/5  20:12</span>
<span class="cm"> * “欢迎您，我的无上至尊”</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Room</span> <span class="p">{</span>

<span class="cm">/*    -- 教室表</span>
<span class="cm">    create table room(</span>
<span class="cm">            rId int primary key,</span>
<span class="cm">            rName varchar(20) not null,</span>
<span class="cm">    address varchar(50) not null</span>
<span class="cm">            );*/</span>

    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">rId</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">rName</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">address</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">del</span><span class="p">;</span>

    <span class="kd">public</span> <span class="nf">Room</span><span class="p">()</span> <span class="p">{</span>

    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getrId</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">rId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setrId</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">rId</span> <span class="o">=</span> <span class="n">rId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getrName</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">rName</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setrName</span><span class="p">(</span><span class="n">String</span> <span class="n">rName</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">rName</span> <span class="o">=</span> <span class="n">rName</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getAddress</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">address</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setAddress</span><span class="p">(</span><span class="n">String</span> <span class="n">address</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">address</span> <span class="o">=</span> <span class="n">address</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getDel</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">del</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setDel</span><span class="p">(</span><span class="n">Integer</span> <span class="n">del</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">del</span> <span class="o">=</span> <span class="n">del</span><span class="p">;</span>
    <span class="p">}</span>

   <span class="cm">/* public List&lt;WxUser&gt; getWxUsers() {</span>
<span class="cm">        return wxUser;</span>
<span class="cm">    }</span>

<span class="cm">    public void setWxUsers(List&lt;WxUser&gt; wxUsers) {</span>
<span class="cm">        this.wxUser = wxUser;</span>
<span class="cm">    }*/</span>

    <span class="kd">public</span> <span class="nf">Room</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rId</span><span class="p">,</span> <span class="n">String</span> <span class="n">rName</span><span class="p">,</span> <span class="n">String</span> <span class="n">address</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">del</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">rId</span> <span class="o">=</span> <span class="n">rId</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">rName</span> <span class="o">=</span> <span class="n">rName</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">address</span> <span class="o">=</span> <span class="n">address</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">del</span> <span class="o">=</span> <span class="n">del</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;Room{&quot;</span> <span class="o">+</span>
                <span class="s">&quot;rId=&quot;</span> <span class="o">+</span> <span class="n">rId</span> <span class="o">+</span>
                <span class="s">&quot;, rName=&#39;&quot;</span> <span class="o">+</span> <span class="n">rName</span> <span class="o">+</span> <span class="sc">&#39;\&#39;&#39;</span> <span class="o">+</span>
                <span class="s">&quot;, address=&#39;&quot;</span> <span class="o">+</span> <span class="n">address</span> <span class="o">+</span> <span class="sc">&#39;\&#39;&#39;</span> <span class="o">+</span>
                <span class="s">&quot;, del=&quot;</span> <span class="o">+</span> <span class="n">del</span> <span class="o">+</span>
                <span class="s">&quot;, &quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h6>RoomAdmin.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.pojo</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @ClassName: RoomAdmin</span>
<span class="cm"> * @Description: TODO</span>
<span class="cm"> * @author: 陈龙</span>
<span class="cm"> * @date: 2020/1/5  20:20</span>
<span class="cm"> * “欢迎您，我的无上至尊”</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RoomAdmin</span> <span class="p">{</span>
    <span class="cm">/*-- 教室管理员表</span>
<span class="cm">    create table roomAdmin(</span>
<span class="cm">            rId int,</span>
<span class="cm">            uId int,</span>
<span class="cm">            aDate datetime,</span>
<span class="cm">            del int</span>
<span class="cm">    );*/</span>

    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">rId</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">uId</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">Date</span> <span class="n">aDate</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">del</span><span class="p">;</span>

    <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getrId</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">rId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setrId</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">rId</span> <span class="o">=</span> <span class="n">rId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getuId</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">uId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setuId</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">uId</span> <span class="o">=</span> <span class="n">uId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">Date</span> <span class="nf">getaDate</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">aDate</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setaDate</span><span class="p">(</span><span class="n">Date</span> <span class="n">aDate</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">aDate</span> <span class="o">=</span> <span class="n">aDate</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getDel</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">del</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setDel</span><span class="p">(</span><span class="n">Integer</span> <span class="n">del</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">del</span> <span class="o">=</span> <span class="n">del</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="nf">RoomAdmin</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rId</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">uId</span><span class="p">,</span> <span class="n">Date</span> <span class="n">aDate</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">del</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">rId</span> <span class="o">=</span> <span class="n">rId</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">uId</span> <span class="o">=</span> <span class="n">uId</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">aDate</span> <span class="o">=</span> <span class="n">aDate</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">del</span> <span class="o">=</span> <span class="n">del</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;RoomAdmin{&quot;</span> <span class="o">+</span>
                <span class="s">&quot;rId=&quot;</span> <span class="o">+</span> <span class="n">rId</span> <span class="o">+</span>
                <span class="s">&quot;, uId=&quot;</span> <span class="o">+</span> <span class="n">uId</span> <span class="o">+</span>
                <span class="s">&quot;, aDate=&quot;</span> <span class="o">+</span> <span class="n">aDate</span> <span class="o">+</span>
                <span class="s">&quot;, del=&quot;</span> <span class="o">+</span> <span class="n">del</span> <span class="o">+</span>
                <span class="sc">&#39;}&#39;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h6>RoomNotice.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.pojo</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.format.annotation.DateTimeFormat</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @ClassName: RoomNotice</span>
<span class="cm"> * @Description: TODO</span>
<span class="cm"> * @author: 陈龙</span>
<span class="cm"> * @date: 2020/1/7  23:39</span>
<span class="cm"> * “欢迎您，我的无上至尊”</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RoomNotice</span> <span class="p">{</span>


    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">rId</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">uId</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">notice</span><span class="p">;</span>
    <span class="nd">@DateTimeFormat</span><span class="p">(</span><span class="n">pattern</span><span class="o">=</span><span class="s">&quot;yyyy-MM-dd&quot;</span><span class="p">)</span>
    <span class="kd">private</span> <span class="n">Date</span> <span class="n">cDate</span><span class="p">;</span>

    <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getrId</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">rId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setrId</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">rId</span> <span class="o">=</span> <span class="n">rId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getuId</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">uId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setuId</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">uId</span> <span class="o">=</span> <span class="n">uId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getNotice</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">notice</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setNotice</span><span class="p">(</span><span class="n">String</span> <span class="n">notice</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">notice</span> <span class="o">=</span> <span class="n">notice</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">Date</span> <span class="nf">getcDate</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">cDate</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setcDate</span><span class="p">(</span><span class="n">Date</span> <span class="n">cDate</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">cDate</span> <span class="o">=</span> <span class="n">cDate</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="nf">RoomNotice</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rId</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">uId</span><span class="p">,</span> <span class="n">String</span> <span class="n">notice</span><span class="p">,</span> <span class="n">Date</span> <span class="n">cDate</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">rId</span> <span class="o">=</span> <span class="n">rId</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">uId</span> <span class="o">=</span> <span class="n">uId</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">notice</span> <span class="o">=</span> <span class="n">notice</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">cDate</span> <span class="o">=</span> <span class="n">cDate</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;RoomAdmin{&quot;</span> <span class="o">+</span>
                <span class="s">&quot;rId=&quot;</span> <span class="o">+</span> <span class="n">rId</span> <span class="o">+</span>
                <span class="s">&quot;, uId=&quot;</span> <span class="o">+</span> <span class="n">uId</span> <span class="o">+</span>
                <span class="s">&quot;, notice=&#39;&quot;</span> <span class="o">+</span> <span class="n">notice</span> <span class="o">+</span> <span class="sc">&#39;\&#39;&#39;</span> <span class="o">+</span>
                <span class="s">&quot;, cDate=&quot;</span> <span class="o">+</span> <span class="n">cDate</span> <span class="o">+</span>
                <span class="sc">&#39;}&#39;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h6>Time.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.pojo</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @ClassName: Time</span>
<span class="cm"> * @Description: TODO</span>
<span class="cm"> * @author: 陈龙</span>
<span class="cm"> * @date: 2020/1/8  22:26</span>
<span class="cm"> * “欢迎您，我的无上至尊”</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Time</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">uId</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">rId</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">time</span><span class="p">;</span>

    <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getUid</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">uId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUid</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">uId</span> <span class="o">=</span> <span class="n">uId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getrId</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">rId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setrId</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">rId</span> <span class="o">=</span> <span class="n">rId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getTime</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">time</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setTime</span><span class="p">(</span><span class="n">Integer</span> <span class="n">time</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">time</span> <span class="o">=</span> <span class="n">time</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="nf">Time</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">rId</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">time</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">uId</span> <span class="o">=</span> <span class="n">uId</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">rId</span> <span class="o">=</span> <span class="n">rId</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">time</span> <span class="o">=</span> <span class="n">time</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h6>WxUser.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.pojo</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @ClassName: User</span>
<span class="cm"> * @Description: TODO</span>
<span class="cm"> * @author: 陈龙</span>
<span class="cm"> * @date: 2020/1/5  19:48</span>
<span class="cm"> * “欢迎您，我的无上至尊”</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WxUser</span> <span class="p">{</span>
<span class="cm">/*    *//*用户微信表*//*</span>
<span class="cm">    create table wxUser(</span>
<span class="cm">            uId int AUTO_INCREMENT primary key,</span>
<span class="cm">            openId varchar(50) not null,</span>
<span class="cm">    nickName varchar(20) ,</span>
<span class="cm">    avatarUrl text,</span>
<span class="cm">    activity int DEFAULT 0,</span>
<span class="cm">    sSuper int DEFAULT 1</span>
<span class="cm">            );*/</span>


    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">uId</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">openId</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">nickName</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">avatarUrl</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">rId</span><span class="p">;</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">sSuper</span><span class="p">;</span>

    <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getuId</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">uId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setuId</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">uId</span> <span class="o">=</span> <span class="n">uId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getOpenId</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">openId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setOpenId</span><span class="p">(</span><span class="n">String</span> <span class="n">openId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">openId</span> <span class="o">=</span> <span class="n">openId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getNickName</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">nickName</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setNickName</span><span class="p">(</span><span class="n">String</span> <span class="n">nickName</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">nickName</span> <span class="o">=</span> <span class="n">nickName</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getAvatarUrl</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">avatarUrl</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setAvatarUrl</span><span class="p">(</span><span class="n">String</span> <span class="n">avatarUrl</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">avatarUrl</span> <span class="o">=</span> <span class="n">avatarUrl</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getrId</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">rId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setrId</span><span class="p">(</span><span class="n">String</span> <span class="n">rId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">rId</span> <span class="o">=</span> <span class="n">rId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getsSuper</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">sSuper</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setsSuper</span><span class="p">(</span><span class="n">Integer</span> <span class="n">sSuper</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">sSuper</span> <span class="o">=</span> <span class="n">sSuper</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="nf">WxUser</span><span class="p">(</span><span class="n">String</span> <span class="n">openId</span><span class="p">,</span> <span class="n">String</span> <span class="n">nickName</span><span class="p">,</span> <span class="n">String</span> <span class="n">avatarUrl</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">openId</span> <span class="o">=</span> <span class="n">openId</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">nickName</span> <span class="o">=</span> <span class="n">nickName</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">avatarUrl</span> <span class="o">=</span> <span class="n">avatarUrl</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s">&quot;WxUser{&quot;</span> <span class="o">+</span>
                <span class="s">&quot;uId=&quot;</span> <span class="o">+</span> <span class="n">uId</span> <span class="o">+</span>
                <span class="s">&quot;, openId=&#39;&quot;</span> <span class="o">+</span> <span class="n">openId</span> <span class="o">+</span> <span class="sc">&#39;\&#39;&#39;</span> <span class="o">+</span>
                <span class="s">&quot;, nickName=&#39;&quot;</span> <span class="o">+</span> <span class="n">nickName</span> <span class="o">+</span> <span class="sc">&#39;\&#39;&#39;</span> <span class="o">+</span>
                <span class="s">&quot;, avatarUrl=&#39;&quot;</span> <span class="o">+</span> <span class="n">avatarUrl</span> <span class="o">+</span> <span class="sc">&#39;\&#39;&#39;</span> <span class="o">+</span>
                <span class="s">&quot;, rId=&#39;&quot;</span> <span class="o">+</span> <span class="n">rId</span> <span class="o">+</span> <span class="sc">&#39;\&#39;&#39;</span> <span class="o">+</span>
                <span class="s">&quot;, sSuper=&quot;</span> <span class="o">+</span> <span class="n">sSuper</span> <span class="o">+</span>
                <span class="sc">&#39;}&#39;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h5>4.service</h5>
<p><strong>impl下的impl</strong></p>
<h6>LogServiceImpl.java</h6>
<div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * Copyright (C), 2015-2020, XXX有限公司</span>
<span class="cm"> * FileName: LogServiceImpl</span>
<span class="cm"> * Author:   19399</span>
<span class="cm"> * Date:     2020/1/7 8:35</span>
<span class="cm"> * Description: 1</span>
<span class="cm"> * History:</span>
<span class="cm"> * &lt;author&gt;          &lt;time&gt;          &lt;version&gt;          &lt;desc&gt;</span>
<span class="cm"> * 作者姓名           修改时间           版本号              描述</span>
<span class="cm"> */</span>
<span class="kn">package</span> <span class="nn">com.service.impl</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.mapper.LogMapper</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.pojo.Log</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.pojo.Time</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.service.LogService</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * 〈一句话功能简述〉&lt;br&gt; </span>
<span class="cm"> * 〈1〉</span>
<span class="cm"> *</span>
<span class="cm"> * @author 19399</span>
<span class="cm"> * @create 2020/1/7</span>
<span class="cm"> * @since 1.0.0</span>
<span class="cm"> */</span>
<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">LogServiceImpl</span> <span class="kd">implements</span> <span class="n">LogService</span> <span class="p">{</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">LogMapper</span> <span class="n">logMapper</span><span class="p">;</span>


    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">getEntryTime</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">rId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">logMapper</span><span class="p">.</span><span class="na">getEntryTime</span><span class="p">(</span><span class="n">uId</span><span class="p">,</span><span class="n">rId</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">addLog</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">rId</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">state</span><span class="p">,</span> <span class="n">String</span> <span class="n">lDate</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">logMapper</span><span class="p">.</span><span class="na">addLog</span><span class="p">(</span><span class="n">uId</span><span class="p">,</span><span class="n">rId</span><span class="p">,</span><span class="n">state</span><span class="p">,</span><span class="n">lDate</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;&gt;</span> <span class="nf">getLog</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">rId</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">room</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">logMapper</span><span class="p">.</span><span class="na">getLog</span><span class="p">(</span><span class="n">uId</span><span class="p">,</span><span class="n">rId</span><span class="p">,</span><span class="n">room</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="c1">//    根据教室rid获取教室进出</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Log</span><span class="o">&gt;</span> <span class="nf">getLogByRid</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rid</span><span class="p">){</span>
        <span class="k">return</span>  <span class="n">logMapper</span><span class="p">.</span><span class="na">getLogByRid</span><span class="p">(</span><span class="n">rid</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nd">@Override</span>
    <span class="c1">//    获取我去过的教室根据uid</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">getMyRoomByUid</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uid</span><span class="p">){</span>
        <span class="k">return</span>  <span class="n">logMapper</span><span class="p">.</span><span class="na">getMyRoomByUid</span><span class="p">(</span><span class="n">uid</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nd">@Override</span>
    <span class="c1">//    根据uid和rid获取我在某个教室的日志</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Log</span><span class="o">&gt;</span> <span class="nf">getMyRoomLog</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uid</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">rid</span><span class="p">){</span>
        <span class="k">return</span>  <span class="n">logMapper</span><span class="p">.</span><span class="na">getMyRoomLog</span><span class="p">(</span><span class="n">uid</span><span class="p">,</span><span class="n">rid</span><span class="p">);</span>
    <span class="p">}</span>


<span class="p">}</span>
</pre></div>
<h6>RealNameServiceImpl.java</h6>
<div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * Copyright (C), 2015-2020, XXX有限公司</span>
<span class="cm"> * FileName: RealNameImpl</span>
<span class="cm"> * Author:   19399</span>
<span class="cm"> * Date:     2020/1/7 8:36</span>
<span class="cm"> * Description: 实名</span>
<span class="cm"> * History:</span>
<span class="cm"> * &lt;author&gt;          &lt;time&gt;          &lt;version&gt;          &lt;desc&gt;</span>
<span class="cm"> * 作者姓名           修改时间           版本号              描述</span>
<span class="cm"> */</span>
<span class="kn">package</span> <span class="nn">com.service.impl</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.mapper.RealNameMapper</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.pojo.RealName</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.service.RealNameService</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * 〈一句话功能简述〉&lt;br&gt; </span>
<span class="cm"> * 〈实名〉</span>
<span class="cm"> *</span>
<span class="cm"> * @author 19399</span>
<span class="cm"> * @create 2020/1/7</span>
<span class="cm"> * @since 1.0.0</span>
<span class="cm"> */</span>
<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RealNameServiceImpl</span> <span class="kd">implements</span> <span class="n">RealNameService</span> <span class="p">{</span>
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">RealNameMapper</span> <span class="n">realNameMapper</span><span class="p">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">RealName</span> <span class="nf">getBySidAndPwd</span><span class="p">(</span><span class="n">RealName</span> <span class="n">realName</span><span class="p">){</span>
        <span class="k">return</span>  <span class="n">realNameMapper</span><span class="p">.</span><span class="na">getBySidAndPwd</span><span class="p">(</span><span class="n">realName</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">tieUid</span><span class="p">(</span><span class="n">String</span> <span class="n">uId</span><span class="p">,</span><span class="n">String</span> <span class="n">sId</span><span class="p">){</span>
        <span class="k">return</span>  <span class="n">realNameMapper</span><span class="p">.</span><span class="na">tieUid</span><span class="p">(</span><span class="n">uId</span><span class="p">,</span><span class="n">sId</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">RealName</span> <span class="nf">getByUid</span><span class="p">(</span><span class="n">String</span> <span class="n">uId</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">realNameMapper</span><span class="p">.</span><span class="na">getByUid</span><span class="p">(</span><span class="n">uId</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
<h6>RoomAdminServiceImpl.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.service.impl</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.mapper.RoomAdminMapper</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.pojo.RoomAdmin</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.service.RoomAdminService</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @ClassName: RoomAdminServiceImpl</span>
<span class="cm"> * @Description: TODO</span>
<span class="cm"> * @author: 陈龙</span>
<span class="cm"> * @date: 2020/1/8  0:04</span>
<span class="cm"> * “欢迎您，我的无上至尊”</span>
<span class="cm"> */</span>
<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RoomAdminServiceImpl</span> <span class="kd">implements</span> <span class="n">RoomAdminService</span> <span class="p">{</span>
    <span class="nd">@Autowired</span>
    <span class="n">RoomAdminMapper</span> <span class="n">roomAdminMapper</span><span class="p">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">RoomAdmin</span><span class="o">&gt;</span> <span class="nf">getRoomAdminList</span><span class="p">(</span><span class="n">RoomAdmin</span> <span class="n">roomAdmin</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">roomAdminMapper</span><span class="p">.</span><span class="na">getRoomAdminList</span><span class="p">(</span><span class="n">roomAdmin</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">addRoomAdmin</span><span class="p">(</span><span class="n">RoomAdmin</span> <span class="n">roomAdmin</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">roomAdminMapper</span><span class="p">.</span><span class="na">addRoomAdmin</span><span class="p">(</span><span class="n">roomAdmin</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">deleteRoomById</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rId</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">uId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">roomAdminMapper</span><span class="p">.</span><span class="na">deleteRoomById</span><span class="p">(</span><span class="n">rId</span><span class="p">,</span><span class="n">uId</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">RoomAdmin</span><span class="o">&gt;</span> <span class="nf">getRoomAdminListByRId</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">roomAdminMapper</span><span class="p">.</span><span class="na">getRoomAdminListByRId</span><span class="p">(</span><span class="n">rId</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">RoomAdmin</span><span class="o">&gt;</span> <span class="nf">getRoomAdminListByUId</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">roomAdminMapper</span><span class="p">.</span><span class="na">getRoomAdminListByUId</span><span class="p">(</span><span class="n">uId</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
<h6>RoomNoticeServiceImpl.java</h6>
<div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * Copyright (C), 2015-2020, XXX有限公司</span>
<span class="cm"> * FileName: RoomAdminImpl</span>
<span class="cm"> * Author:   19399</span>
<span class="cm"> * Date:     2020/1/7 8:37</span>
<span class="cm"> * Description: 房间管理</span>
<span class="cm"> * History:</span>
<span class="cm"> * &lt;author&gt;          &lt;time&gt;          &lt;version&gt;          &lt;desc&gt;</span>
<span class="cm"> * 作者姓名           修改时间           版本号              描述</span>
<span class="cm"> */</span>
<span class="kn">package</span> <span class="nn">com.service.impl</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.mapper.RoomNoticeMapper</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.pojo.RoomNotice</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.pojo.RoomAdmin</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.service.RoomNoticeService</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * 〈通过rid或uid查询教室公告信息〉&lt;br&gt;</span>
<span class="cm"> * 〈房间管理〉</span>
<span class="cm"> *</span>
<span class="cm"> * @author 佳涛</span>
<span class="cm"> * @create 2020/1/9</span>
<span class="cm"> * @since 1.2.0</span>
<span class="cm"> */</span>
<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RoomNoticeServiceImpl</span> <span class="kd">implements</span> <span class="n">RoomNoticeService</span> <span class="p">{</span>

    <span class="nd">@Autowired</span>
    <span class="n">RoomNoticeMapper</span> <span class="n">roomNoticeMapper</span><span class="p">;</span>
    <span class="c1">//Service的Mapper调用</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">RoomNotice</span><span class="o">&gt;</span> <span class="nf">getRoomNoticeByRid</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rid</span><span class="p">)</span> <span class="p">{</span>

        <span class="k">return</span> <span class="n">roomNoticeMapper</span><span class="p">.</span><span class="na">getRoomNoticeByRid</span><span class="p">(</span><span class="n">rid</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">RoomNotice</span><span class="o">&gt;</span> <span class="nf">getRoomNoticeByUid</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uid</span><span class="p">)</span> <span class="p">{</span>

        <span class="k">return</span> <span class="n">roomNoticeMapper</span><span class="p">.</span><span class="na">getRoomNoticeByUid</span><span class="p">(</span><span class="n">uid</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">RoomNotice</span><span class="o">&gt;</span> <span class="nf">getAllRoomNotice</span><span class="p">()</span> <span class="p">{</span>

        <span class="k">return</span> <span class="n">roomNoticeMapper</span><span class="p">.</span><span class="na">getAllRoomNotice</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">insertRoomNotice</span><span class="p">(</span><span class="n">RoomNotice</span> <span class="n">bean</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">roomNoticeMapper</span><span class="p">.</span><span class="na">insertRoomNotice</span><span class="p">(</span><span class="n">bean</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">updateRoomNotice</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rid</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">uid</span><span class="p">,</span> <span class="n">String</span> <span class="n">notice</span><span class="p">,</span> <span class="n">Date</span> <span class="n">cDate</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">roomNoticeMapper</span><span class="p">.</span><span class="na">updateRoomNotice</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span>  <span class="n">uid</span><span class="p">,</span> <span class="n">notice</span><span class="p">,</span> <span class="n">cDate</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h6>RoomServiceImpl.java</h6>
<div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * Copyright (C), 2015-2020, XXX有限公司</span>
<span class="cm"> * FileName: RoomImpl</span>
<span class="cm"> * Author:   19399</span>
<span class="cm"> * Date:     2020/1/7 8:37</span>
<span class="cm"> * Description: 教室</span>
<span class="cm"> * History:</span>
<span class="cm"> * &lt;author&gt;          &lt;time&gt;          &lt;version&gt;          &lt;desc&gt;</span>
<span class="cm"> * 作者姓名           修改时间           版本号              描述</span>
<span class="cm"> */</span>
<span class="kn">package</span> <span class="nn">com.service.impl</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.mapper.RoomMapper</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.pojo.Room</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.service.RoomService</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * 〈一句话功能简述〉&lt;br&gt; </span>
<span class="cm"> * 〈教室〉</span>
<span class="cm"> *</span>
<span class="cm"> * @author 19399</span>
<span class="cm"> * @create 2020/1/7</span>
<span class="cm"> * @since 1.0.0</span>
<span class="cm"> */</span>
<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RoomServiceImpl</span> <span class="kd">implements</span> <span class="n">RoomService</span> <span class="p">{</span>

    <span class="nd">@Autowired</span>
    <span class="n">RoomMapper</span> <span class="n">roomMapper</span><span class="p">;</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Room</span><span class="o">&gt;</span> <span class="nf">getRoomList</span><span class="p">(</span><span class="n">Room</span> <span class="n">room</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">roomMapper</span><span class="p">.</span><span class="na">getRoomList</span><span class="p">(</span><span class="n">room</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Room</span> <span class="nf">getRoomById</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">roomMapper</span><span class="p">.</span><span class="na">getRoomById</span><span class="p">(</span><span class="n">rId</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">addRoom</span><span class="p">(</span><span class="n">Room</span> <span class="n">room</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">roomMapper</span><span class="p">.</span><span class="na">addRoom</span><span class="p">(</span><span class="n">room</span><span class="p">);</span>
    <span class="p">}</span>


    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">deleteRoom</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">roomMapper</span><span class="p">.</span><span class="na">deleteRoom</span><span class="p">(</span><span class="n">rId</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">updateRoom</span><span class="p">(</span><span class="n">Room</span> <span class="n">room</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">roomMapper</span><span class="p">.</span><span class="na">updateRoom</span><span class="p">(</span><span class="n">room</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Room</span><span class="o">&gt;</span> <span class="nf">selectRoomById</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">roomMapper</span><span class="p">.</span><span class="na">selectRoomById</span><span class="p">(</span><span class="n">rId</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
<h6>TimeServiceImpl.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.service.impl</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.mapper.RoomNoticeMapper</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.mapper.TimeMapper</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.pojo.RoomNotice</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.pojo.Time</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.service.RoomNoticeService</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.service.TimeService</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @ClassName: TimeServiceImpl</span>
<span class="cm"> * @Description: TODO</span>
<span class="cm"> * @author: 陈龙</span>
<span class="cm"> * @date: 2020/1/8  22:29</span>
<span class="cm"> * “欢迎您，我的无上至尊”</span>
<span class="cm"> */</span>
<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TimeServiceImpl</span> <span class="kd">implements</span> <span class="n">TimeService</span> <span class="p">{</span>
    <span class="nd">@Autowired</span>
    <span class="n">TimeMapper</span> <span class="n">timeMapper</span><span class="p">;</span>
    <span class="c1">//Service的Mapper调用</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Time</span><span class="o">&gt;</span> <span class="nf">getTimeByUid</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uid</span><span class="p">)</span> <span class="p">{</span>

        <span class="k">return</span> <span class="n">timeMapper</span><span class="p">.</span><span class="na">getTimeByUid</span><span class="p">(</span><span class="n">uid</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Time</span><span class="o">&gt;</span> <span class="nf">getTime</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">timeMapper</span><span class="p">.</span><span class="na">getTime</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Time</span> <span class="nf">getAllTimeByUid</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uid</span><span class="p">)</span> <span class="p">{</span>

        <span class="k">return</span> <span class="n">timeMapper</span><span class="p">.</span><span class="na">getAllTimeByUid</span><span class="p">(</span><span class="n">uid</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Time</span><span class="o">&gt;</span> <span class="nf">getAllTime</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">timeMapper</span><span class="p">.</span><span class="na">getAllTime</span><span class="p">();</span>
    <span class="p">}</span>


<span class="p">}</span>
</pre></div>
<h6>WxUserServiceImpl.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.service.impl</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.mapper.WxUserMapper</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.pojo.WxUser</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.service.WxUserService</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @ClassName: WxUserServiceImpl</span>
<span class="cm"> * @Description: TODO</span>
<span class="cm"> * @author: 陈龙</span>
<span class="cm"> * @date: 2020/1/5  21:40</span>
<span class="cm"> * “欢迎您，我的无上至尊”</span>
<span class="cm"> */</span>
<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WxUserServiceImpl</span> <span class="kd">implements</span> <span class="n">WxUserService</span> <span class="p">{</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">WxUserMapper</span> <span class="n">wxUserMapper</span><span class="p">;</span>


    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getOnlineRoom</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">wxUserMapper</span><span class="p">.</span><span class="na">getOnlineRoom</span><span class="p">(</span><span class="n">uId</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">Object</span><span class="o">&gt;&gt;</span> <span class="nf">isInRoom</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">wxUserMapper</span><span class="p">.</span><span class="na">isInRoom</span><span class="p">(</span><span class="n">uId</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">updateRoom</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">rId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">wxUserMapper</span><span class="p">.</span><span class="na">updateRoom</span><span class="p">(</span><span class="n">uId</span><span class="p">,</span><span class="n">rId</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">WxUser</span><span class="o">&gt;</span> <span class="nf">getAllWxUser</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">wxUserMapper</span><span class="p">.</span><span class="na">getAllWxUser</span><span class="p">();</span>
    <span class="p">}</span>


    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">WxUser</span> <span class="nf">getUserByUidOrOpenid</span><span class="p">(</span><span class="n">WxUser</span> <span class="n">wxUser</span><span class="p">){</span>
        <span class="k">return</span> <span class="n">wxUserMapper</span><span class="p">.</span><span class="na">getUserByUidOrOpenid</span><span class="p">(</span><span class="n">wxUser</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">insertWxUser</span><span class="p">(</span><span class="n">WxUser</span> <span class="n">wxUser</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">wxUserMapper</span><span class="p">.</span><span class="na">insertWxUser</span><span class="p">(</span><span class="n">wxUser</span><span class="p">);</span>
    <span class="p">}</span>


    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">WxUser</span><span class="o">&gt;</span> <span class="nf">getWxUserList</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">wxUserMapper</span><span class="p">.</span><span class="na">getWxUserList</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getOnlineUser</span><span class="p">(</span><span class="kt">int</span> <span class="n">rid</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">wxUserMapper</span><span class="p">.</span><span class="na">getOnlineUser</span><span class="p">(</span><span class="n">rid</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">updateWxUser</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rid</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">uId</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">wxUserMapper</span><span class="p">.</span><span class="na">updateWxUser</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span><span class="n">uId</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<p><strong>service</strong>'<strong>类代码</strong></p>
<h6>LogService.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.service</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.pojo.Log</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.pojo.Time</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="p">;</span>


<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">LogService</span> <span class="p">{</span>

    <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">getEntryTime</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">rId</span><span class="p">);</span>
    <span class="kt">boolean</span> <span class="nf">addLog</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">rId</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">state</span><span class="p">,</span> <span class="n">String</span> <span class="n">lDate</span><span class="p">);</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;&gt;</span> <span class="nf">getLog</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">rId</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">room</span><span class="p">);</span>
    <span class="c1">//    根据教室rid获取教室进出</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Log</span><span class="o">&gt;</span> <span class="nf">getLogByRid</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rid</span><span class="p">);</span>
    <span class="c1">//    获取我去过的教室根据uid</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">getMyRoomByUid</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uid</span><span class="p">);</span>
    <span class="c1">//    根据uid和rid获取我在某个教室的日志</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Log</span><span class="o">&gt;</span> <span class="nf">getMyRoomLog</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uid</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">rid</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h6>RealNameService.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.service</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.pojo.RealName</span><span class="p">;</span>


<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">RealNameService</span> <span class="p">{</span>
    <span class="n">RealName</span> <span class="nf">getBySidAndPwd</span><span class="p">(</span><span class="n">RealName</span> <span class="n">realName</span><span class="p">);</span>
    <span class="kt">boolean</span> <span class="nf">tieUid</span><span class="p">(</span><span class="n">String</span> <span class="n">uId</span><span class="p">,</span> <span class="n">String</span> <span class="n">sId</span><span class="p">);</span>
    <span class="n">RealName</span> <span class="nf">getByUid</span><span class="p">(</span><span class="n">String</span> <span class="n">uId</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h6>RoomAdminService.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.service</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.pojo.RoomAdmin</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @ClassName: RoomAdminService</span>
<span class="cm"> * @Description: TODO</span>
<span class="cm"> * @author: 陈龙</span>
<span class="cm"> * @date: 2020/1/7  23:52</span>
<span class="cm"> * “欢迎您，我的无上至尊”</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">RoomAdminService</span> <span class="p">{</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">RoomAdmin</span><span class="o">&gt;</span> <span class="nf">getRoomAdminList</span><span class="p">(</span><span class="n">RoomAdmin</span> <span class="n">roomAdmin</span><span class="p">);</span>

    <span class="kt">boolean</span> <span class="nf">addRoomAdmin</span><span class="p">(</span><span class="n">RoomAdmin</span> <span class="n">roomAdmin</span><span class="p">);</span><span class="c1">//添加管理员</span>

    <span class="kt">boolean</span> <span class="nf">deleteRoomById</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rId</span><span class="p">,</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">);</span><span class="c1">//删除</span>

    <span class="n">List</span><span class="o">&lt;</span><span class="n">RoomAdmin</span><span class="o">&gt;</span> <span class="nf">getRoomAdminListByRId</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rId</span><span class="p">);</span>

    <span class="n">List</span><span class="o">&lt;</span><span class="n">RoomAdmin</span><span class="o">&gt;</span> <span class="nf">getRoomAdminListByUId</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h6>RoomNoticeService.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.service</span><span class="p">;</span>


<span class="kn">import</span> <span class="nn">com.pojo.RoomNotice</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">RoomNoticeService</span> <span class="p">{</span>
    <span class="c1">//    根据教室rid获取教室公共等信息</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">RoomNotice</span><span class="o">&gt;</span> <span class="nf">getRoomNoticeByRid</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rid</span><span class="p">);</span>

    <span class="c1">//    获取用户uid获取用户发布过的课室公告</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">RoomNotice</span><span class="o">&gt;</span> <span class="nf">getRoomNoticeByUid</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uid</span><span class="p">);</span>

    <span class="c1">//   查询所有教室公告的信息</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">RoomNotice</span><span class="o">&gt;</span> <span class="nf">getAllRoomNotice</span><span class="p">();</span>

    <span class="c1">//   插入一条新的公告，从页面获取参数</span>
    <span class="kt">boolean</span> <span class="nf">insertRoomNotice</span><span class="p">(</span><span class="n">RoomNotice</span> <span class="n">bean</span><span class="p">);</span>

    <span class="c1">//   更新一条课室公告，从页面获取参数</span>
    <span class="kt">boolean</span> <span class="nf">updateRoomNotice</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rid</span><span class="p">,</span> <span class="n">Integer</span> <span class="n">uid</span><span class="p">,</span> <span class="n">String</span> <span class="n">notice</span><span class="p">,</span> <span class="n">Date</span> <span class="n">cDate</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h6>RoomService.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.service</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.mapper.RoomMapper</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.pojo.Room</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">RoomService</span> <span class="p">{</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Room</span><span class="o">&gt;</span> <span class="nf">getRoomList</span><span class="p">(</span><span class="n">Room</span> <span class="n">room</span><span class="p">);</span>

    <span class="cm">/**</span>
<span class="cm">     * 根据Id获取供应商</span>
<span class="cm">     *</span>
<span class="cm">     * @param rId</span>
<span class="cm">     * @return</span>
<span class="cm">     */</span>
    <span class="n">Room</span> <span class="nf">getRoomById</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rId</span><span class="p">);</span>

    <span class="cm">/**</span>
<span class="cm">     * 增加</span>
<span class="cm">     *</span>
<span class="cm">     * @param room</span>
<span class="cm">     */</span>
    <span class="kt">boolean</span> <span class="nf">addRoom</span><span class="p">(</span><span class="n">Room</span> <span class="n">room</span><span class="p">);</span>

    <span class="cm">/**</span>
<span class="cm">     * 删除供应商</span>
<span class="cm">     */</span>
    <span class="kt">boolean</span> <span class="nf">deleteRoom</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rId</span><span class="p">);</span>

    <span class="cm">/**</span>
<span class="cm">     * 编辑供应商</span>
<span class="cm">     *</span>
<span class="cm">     * @param room</span>
<span class="cm">     */</span>
    <span class="kt">boolean</span> <span class="nf">updateRoom</span><span class="p">(</span><span class="n">Room</span> <span class="n">room</span><span class="p">);</span>
    <span class="c1">//多对多查询</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Room</span><span class="o">&gt;</span> <span class="nf">selectRoomById</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rId</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h6>TimeService.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.service</span><span class="p">;</span>


<span class="kn">import</span> <span class="nn">com.pojo.Time</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @ClassName: TimeService</span>
<span class="cm"> * @Description: TODO</span>
<span class="cm"> * @author: 陈龙</span>
<span class="cm"> * @date: 2020/1/8  22:29</span>
<span class="cm"> * “欢迎您，我的无上至尊”</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">TimeService</span> <span class="p">{</span>

    <span class="c1">//  查询所有活跃度</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Time</span><span class="o">&gt;</span> <span class="nf">getTime</span><span class="p">();</span>

    <span class="c1">//    根据uid查询所有房间活跃度</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Time</span><span class="o">&gt;</span> <span class="nf">getTimeByUid</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uid</span><span class="p">);</span>

    <span class="c1">//  对累计活跃度进行降序排行-</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Time</span><span class="o">&gt;</span> <span class="nf">getAllTime</span><span class="p">();</span>

    <span class="c1">//    根据uid统计累计活跃度</span>
    <span class="n">Time</span> <span class="nf">getAllTimeByUid</span><span class="p">(</span><span class="n">Integer</span> <span class="n">uid</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h6>WxUserService.java</h6>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.service</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.pojo.WxUser</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @ClassName: WxUserService</span>
<span class="cm"> * @Description: TODO</span>
<span class="cm"> * @author: 陈龙</span>
<span class="cm"> * @date: 2020/1/5  21:28</span>
<span class="cm"> * “欢迎您，我的无上至尊”</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">WxUserService</span> <span class="p">{</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">WxUser</span><span class="o">&gt;</span> <span class="nf">getAllWxUser</span><span class="p">();</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">WxUser</span><span class="o">&gt;</span> <span class="nf">getWxUserList</span><span class="p">();</span>
    <span class="kt">int</span> <span class="nf">getOnlineUser</span><span class="p">(</span><span class="kt">int</span> <span class="n">rid</span><span class="p">);</span>
    <span class="kt">boolean</span> <span class="nf">updateWxUser</span><span class="p">(</span><span class="n">Integer</span> <span class="n">rid</span><span class="p">,</span><span class="n">Integer</span> <span class="n">uId</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
<h5>5.resource下的com.mapper的xml</h5>
<h6>LogMapper.xml</h6>
<div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&quot;com.mapper.LogMapper&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;getLogByRid&quot;</span> <span class="na">resultType=</span><span class="s">&quot;log&quot;</span> <span class="nt">&gt;</span>
        select * from log where rid=#{rid} order by lDate desc
<span class="c">&lt;!--        &lt;if test=&quot;rid != null&quot;&gt;--&gt;</span>
<span class="c">&lt;!--            where rid=#{rid}--&gt;</span>
<span class="c">&lt;!--        &lt;/if&gt;--&gt;</span>
<span class="c">&lt;!--        order by lDate desc--&gt;</span>
    <span class="nt">&lt;/select&gt;</span>
<span class="c">&lt;!--    &lt;select id=&quot;getMyRoomByUid&quot; &gt;--&gt;</span>
<span class="c">&lt;!--       select rid from log where uid=#{uid} group by rid--&gt;</span>
<span class="c">&lt;!--    &lt;/select&gt;--&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;getMyRoomLog&quot;</span> <span class="nt">&gt;</span>
       select * from log where uid=#{uid} and rid=#{rid} order by lDate desc
    <span class="nt">&lt;/select&gt;</span>

    <span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">&quot;logDetail&quot;</span> <span class="na">type=</span><span class="s">&quot;map&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;id</span> <span class="na">column=</span><span class="s">&quot;lId&quot;</span> <span class="na">property=</span><span class="s">&quot;lId&quot;</span><span class="nt">&gt;&lt;/id&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&quot;rId&quot;</span> <span class="na">property=</span><span class="s">&quot;rId&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&quot;uId&quot;</span> <span class="na">property=</span><span class="s">&quot;uId&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&quot;state&quot;</span> <span class="na">property=</span><span class="s">&quot;state&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&quot;lDate&quot;</span> <span class="na">property=</span><span class="s">&quot;lDate&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&quot;rName&quot;</span> <span class="na">property=</span><span class="s">&quot;rName&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&quot;address&quot;</span> <span class="na">property=</span><span class="s">&quot;address&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&quot;del&quot;</span> <span class="na">property=</span><span class="s">&quot;del&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&quot;nickName&quot;</span> <span class="na">property=</span><span class="s">&quot;nickName&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&quot;avatarUrl&quot;</span> <span class="na">property=</span><span class="s">&quot;avatarUrl&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/resultMap&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;getLog&quot;</span> <span class="na">resultMap=</span><span class="s">&quot;logDetail&quot;</span><span class="nt">&gt;</span>
        select w.avatarUrl,w.nickName,l.*,r.rName,r.address,r.del from wxUser w,log l,room r where l.rId = r.rId and w.uId = l.uId
        <span class="nt">&lt;choose&gt;</span>
            <span class="c">&lt;!--    某人在某间教室日志 --&gt;</span>
            <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">&quot;uId != null and rId != null&quot;</span><span class="nt">&gt;</span>
                and   l.uId = #{uId} and l.rId = #{rId}
            <span class="nt">&lt;/when&gt;</span>
            <span class="c">&lt;!--    查找全部日志 --&gt;</span>
            <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">&quot;uId == null and rId == null&quot;</span><span class="nt">&gt;</span>
                and  1
            <span class="nt">&lt;/when&gt;</span>
<span class="c">&lt;!--    查找某个人所有日志 --&gt;</span>
            <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">&quot;uId != null and room==null&quot;</span><span class="nt">&gt;</span>
                and  l.uId = #{uId}
            <span class="nt">&lt;/when&gt;</span>
<span class="c">&lt;!--    查找某个人去过的教室，用group by去重教室 --&gt;</span>
            <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">&quot;uId != null and room!=null&quot;</span><span class="nt">&gt;</span>
                and   l.uId = #{uId} group by l.rId
            <span class="nt">&lt;/when&gt;</span>
<span class="c">&lt;!--    查找某间教室的所有日志 --&gt;</span>

            <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">&quot;rId != null and room==null&quot;</span><span class="nt">&gt;</span>
                and  l.rId = #{rId}
            <span class="nt">&lt;/when&gt;</span>
            <span class="nt">&lt;otherwise&gt;</span>

            <span class="nt">&lt;/otherwise&gt;</span>
        <span class="nt">&lt;/choose&gt;</span>

    <span class="nt">&lt;/select&gt;</span>

    <span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&quot;addLog&quot;</span><span class="nt">&gt;</span>
        INSERT into log(uId,rId,state,lDate) VALUE (#{uId},#{rId},#{state},#{lDate});
    <span class="nt">&lt;/insert&gt;</span>

    <span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">&quot;EntryTime&quot;</span> <span class="na">type=</span><span class="s">&quot;map&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;id</span> <span class="na">column=</span><span class="s">&quot;lId&quot;</span> <span class="na">property=</span><span class="s">&quot;lId&quot;</span><span class="nt">&gt;&lt;/id&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&quot;max(lDate)&quot;</span> <span class="na">property=</span><span class="s">&quot;lDate&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/resultMap&gt;</span>

    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;getEntryTime&quot;</span> <span class="na">resultMap=</span><span class="s">&quot;EntryTime&quot;</span><span class="nt">&gt;</span>
        select lId,max(lDate) from log where uId=#{uId} and rId=#{rId} and state = 1
    <span class="nt">&lt;/select&gt;</span>


<span class="nt">&lt;/mapper&gt;</span>
</pre></div>
<h6>RealNameMapper.xml</h6>
<div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
        <span class="cp">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span>

<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&quot;com.mapper.RealNameMapper&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;getBySidAndPwd&quot;</span> <span class="na">resultType=</span><span class="s">&quot;RealName&quot;</span> <span class="nt">&gt;</span>
                select * from realName where sId=#{sId} and password =#{password}
        <span class="nt">&lt;/select&gt;</span>

        <span class="nt">&lt;update</span> <span class="na">id=</span><span class="s">&quot;tieUid&quot;</span><span class="nt">&gt;</span>
                update realName set uId = #{uId} where sId = #{sId}
        <span class="nt">&lt;/update&gt;</span>

        <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;getByUid&quot;</span> <span class="na">resultType=</span><span class="s">&quot;RealName&quot;</span> <span class="nt">&gt;</span>
                select * from realName where uId=#{uId}
        <span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</pre></div>
<h6>RoomAdminMapper.xml</h6>
<div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&quot;com.mapper.RoomAdminMapper&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;resultMap</span> <span class="na">type=</span><span class="s">&quot;com.pojo.RoomAdmin&quot;</span> <span class="na">id=</span><span class="s">&quot;resultRoomAdminList&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&quot;rId&quot;</span> <span class="na">property=</span><span class="s">&quot;rId&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&quot;uId&quot;</span> <span class="na">property=</span><span class="s">&quot;uId&quot;</span><span class="nt">&gt;&lt;/result&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&quot;aDate&quot;</span> <span class="na">property=</span><span class="s">&quot;aDate&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&quot;del&quot;</span> <span class="na">property=</span><span class="s">&quot;del&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/resultMap&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;getRoomAdminList&quot;</span> <span class="na">resultMap=</span><span class="s">&quot;resultRoomAdminList&quot;</span><span class="nt">&gt;</span>
        select * from RoomAdmin
    <span class="nt">&lt;/select&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;getRoomAdminListByRId&quot;</span> <span class="na">resultMap=</span><span class="s">&quot;resultRoomAdminList&quot;</span><span class="nt">&gt;</span>
select * from RoomAdmin where rId=#{rId}
    <span class="nt">&lt;/select&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;getRoomAdminListByUId&quot;</span> <span class="na">resultMap=</span><span class="s">&quot;resultRoomAdminList&quot;</span><span class="nt">&gt;</span>
select * from RoomAdmin where uId=#{uId}
    <span class="nt">&lt;/select&gt;</span>
    <span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&quot;addRoomAdmin&quot;</span><span class="nt">&gt;</span>
insert into RoomAdmin
        <span class="nt">&lt;trim</span> <span class="na">prefix=</span><span class="s">&quot;(&quot;</span> <span class="na">suffix=</span><span class="s">&quot;)&quot;</span> <span class="na">suffixOverrides=</span><span class="s">&quot;,&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&quot;rId != null&quot;</span><span class="nt">&gt;</span>
                rId,
            <span class="nt">&lt;/if&gt;</span>
            <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&quot;uId != null&quot;</span><span class="nt">&gt;</span>
                uId,
            <span class="nt">&lt;/if&gt;</span>
            <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&quot;aDate != null&quot;</span><span class="nt">&gt;</span>
                aDate,
            <span class="nt">&lt;/if&gt;</span>
            <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&quot;del != null&quot;</span><span class="nt">&gt;</span>
                del,
            <span class="nt">&lt;/if&gt;</span>
        <span class="nt">&lt;/trim&gt;</span>
        values
        <span class="nt">&lt;trim</span> <span class="na">prefix=</span><span class="s">&quot;(&quot;</span> <span class="na">suffix=</span><span class="s">&quot;)&quot;</span> <span class="na">suffixOverrides=</span><span class="s">&quot;,&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&quot;rId != null&quot;</span><span class="nt">&gt;</span>
                #{rId},
            <span class="nt">&lt;/if&gt;</span>
            <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&quot;uId != null&quot;</span><span class="nt">&gt;</span>
                #{uId},
            <span class="nt">&lt;/if&gt;</span>
            <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&quot;aDate != null&quot;</span><span class="nt">&gt;</span>
                #{aDate},
            <span class="nt">&lt;/if&gt;</span>
            <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&quot;del != null&quot;</span><span class="nt">&gt;</span>
                #{del},
            <span class="nt">&lt;/if&gt;</span>
        <span class="nt">&lt;/trim&gt;</span>
    <span class="nt">&lt;/insert&gt;</span>
    <span class="nt">&lt;delete</span> <span class="na">id=</span><span class="s">&quot;deleteRoomById&quot;</span><span class="nt">&gt;</span>
delete from RoomAdmin where rId=#{rId} and uId=#{uId}
    <span class="nt">&lt;/delete&gt;</span>

<span class="nt">&lt;/mapper&gt;</span>
</pre></div>
<h6>RoomMapper.xml</h6>
<div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&quot;com.mapper.RoomMapper&quot;</span><span class="nt">&gt;</span>
<span class="c">&lt;!--    &lt;resultMap type=&quot;com.pojo.Room&quot; id=&quot;resultRoomList&quot;&gt;--&gt;</span>
<span class="c">&lt;!--        &lt;result column=&quot;rId&quot; property=&quot;rId&quot;&gt;&lt;/result&gt;--&gt;</span>
<span class="c">&lt;!--        &lt;result column=&quot;rName&quot; property=&quot;rName&quot;/&gt;--&gt;</span>
<span class="c">&lt;!--        &lt;result column=&quot;address&quot; property=&quot;address&quot;/&gt;--&gt;</span>
<span class="c">&lt;!--        &lt;result column=&quot;del&quot; property=&quot;del&quot;/&gt;--&gt;</span>
<span class="c">&lt;!--    &lt;/resultMap&gt;--&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;getRoomList&quot;</span> <span class="na">resultType=</span><span class="s">&quot;Room&quot;</span><span class="nt">&gt;</span>
        select * from room
        <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&quot;rId!=null&quot;</span><span class="nt">&gt;</span>
            where rId=#{rId}
        <span class="nt">&lt;/if&gt;</span>

        <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&quot;rId==null&quot;</span><span class="nt">&gt;</span>
            where del = 1
        <span class="nt">&lt;/if&gt;</span>
    <span class="nt">&lt;/select&gt;</span>

   <span class="c">&lt;!-- &lt;select id=&quot;getRoomById&quot; resultType=&quot;Room&quot;&gt;</span>
<span class="c">        select * from room where rId=#{rId}</span>
<span class="c">    &lt;/select&gt;</span>
<span class="c">    &lt;insert id=&quot;addRoom&quot;&gt;</span>
<span class="c">        insert into room values (#{rId},#{rName},#{address},#{del})</span>
<span class="c">    &lt;/insert&gt;</span>
<span class="c">    &lt;delete id=&quot;deleteRoom&quot;&gt;</span>
<span class="c">        delete from room where rId=#{rId}</span>
<span class="c">    &lt;/delete&gt;</span>
<span class="c">    &lt;update id=&quot;updateRoom&quot;&gt;</span>
<span class="c">        update room set rName=#{rName},address=#{address},del=#{del} where rId=#{rId}</span>
<span class="c">    &lt;/update&gt;</span>
<span class="c">    &lt;resultMap id=&quot;detailRoom&quot; type=&quot;Room&quot;&gt;&amp;lt;!&amp;ndash;一对多关联查询  &amp;ndash;&amp;gt;</span>
<span class="c">        &lt;id property=&quot;rId&quot; column=&quot;rId&quot;/&gt;</span>
<span class="c">        &lt;result property=&quot;rName&quot; column=&quot;rName&quot;/&gt;</span>
<span class="c">        &lt;result property=&quot;address&quot; column=&quot;address&quot;/&gt;</span>
<span class="c">        &lt;result property=&quot;del&quot; column=&quot;del&quot;/&gt;</span>
<span class="c">        &lt;collection property=&quot;wxUser&quot;  ofType=&quot;WxUser&quot;&gt;</span>
<span class="c">            &lt;id column=&quot;uId&quot; property=&quot;uId&quot;/&gt;</span>
<span class="c">            &lt;result column=&quot;openId&quot; property=&quot;openId&quot;/&gt;</span>
<span class="c">            &lt;result column=&quot;nickName&quot; property=&quot;nickName&quot;/&gt;</span>
<span class="c">            &lt;result column=&quot;avatrUrl&quot; property=&quot;avatrUrl&quot;/&gt;</span>
<span class="c">            &lt;result column=&quot;activity&quot; property=&quot;activity&quot;/&gt;</span>
<span class="c">            &lt;result column=&quot;sSuper&quot; property=&quot;sSuper&quot;/&gt;</span>
<span class="c">        &lt;/collection&gt;</span>
<span class="c">    &lt;/resultMap&gt;</span>
<span class="c">    &lt;select id=&quot;selectRoomById&quot; resultMap=&quot;detailRoom&quot;&gt;</span>
<span class="c">select a.rId,rName,address,c.uId,nickName,sSuper</span>
<span class="c">from room a,roomadmin b,wxuser c</span>
<span class="c">where b.rId=a.rId and c.uId=b.uId and a.rId=#{rId}</span>
<span class="c">&lt;/select&gt;--&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</pre></div>
<h6>RoomNoticeMapper.xml</h6>
<div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&quot;com.mapper.RoomNoticeMapper&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;getRoomNoticeByRid&quot;</span> <span class="na">resultType=</span><span class="s">&quot;RoomNotice&quot;</span><span class="nt">&gt;</span>
        select * from roomnotice where rId=#{rid}
    <span class="nt">&lt;/select&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;getRoomNoticeByUid&quot;</span> <span class="na">resultType=</span><span class="s">&quot;RoomNotice&quot;</span><span class="nt">&gt;</span>
        select * from roomnotice where uId=#{uid}
    <span class="nt">&lt;/select&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;getAllRoomNotice&quot;</span> <span class="na">resultType=</span><span class="s">&quot;RoomNotice&quot;</span><span class="nt">&gt;</span>
        select * from roomnotice
    <span class="nt">&lt;/select&gt;</span>

    <span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&quot;insertRoomNotice&quot;</span><span class="nt">&gt;</span>
        insert into roomnotice values(#{rId},#{uId},#{notice},#{cDate})
    <span class="nt">&lt;/insert&gt;</span>

    <span class="nt">&lt;update</span> <span class="na">id=</span><span class="s">&quot;updateRoomNotice&quot;</span><span class="nt">&gt;</span>
       update roomnotice set notice=#{notice},cDate=#{cDate},uId = #{uId} where rId=#{rId}
    <span class="nt">&lt;/update&gt;</span>

    <span class="nt">&lt;delete</span> <span class="na">id=</span><span class="s">&quot;deleteRoomNotice&quot;</span><span class="nt">&gt;</span>
        delete from roomnotice where cDate=#{cdate}
    <span class="nt">&lt;/delete&gt;</span>

<span class="nt">&lt;/mapper&gt;</span>
</pre></div>
<h6>TimeMapper.xml</h6>
<div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
        <span class="cp">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&quot;com.mapper.TimeMapper&quot;</span><span class="nt">&gt;</span>
<span class="c">&lt;!--查询所有活跃度--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;getTime&quot;</span> <span class="na">resultType=</span><span class="s">&quot;Time&quot;</span><span class="nt">&gt;</span>
        select * from time
    <span class="nt">&lt;/select&gt;</span>
<span class="c">&lt;!--通过uid，查找用户的所有房间的活跃度--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;getTimeByUid&quot;</span> <span class="na">resultType=</span><span class="s">&quot;Time&quot;</span><span class="nt">&gt;</span>
        select * from time where uId = #{uid}
    <span class="nt">&lt;/select&gt;</span>
<span class="c">&lt;!--查询所有用户去过的房间的累计活跃度,降序排行输出,rid属性可忽略--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;getAllTime&quot;</span> <span class="na">resultType=</span><span class="s">&quot;Time&quot;</span><span class="nt">&gt;</span>
       select uId,rId,sum(time) from time group BY uId
 <span class="nt">&lt;/select&gt;</span>
<span class="c">&lt;!--通过uid，统计所有房间的活跃度--&gt;</span>
<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;getAllTimeByUid&quot;</span> <span class="na">resultType=</span><span class="s">&quot;Time&quot;</span><span class="nt">&gt;</span>
       select uId,rId,sum(time) from time where uId = #{uid}
<span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</pre></div>
<h6>WxUserMapper.xml</h6>
<div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&quot;com.mapper.WxUserMapper&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;getAllWxUser&quot;</span> <span class="na">resultType=</span><span class="s">&quot;WxUser&quot;</span><span class="nt">&gt;</span>
        select * from wxUser
    <span class="nt">&lt;/select&gt;</span>


    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;getUserByUidOrOpenid&quot;</span> <span class="na">resultType=</span><span class="s">&quot;WxUser&quot;</span> <span class="na">parameterType=</span><span class="s">&quot;WxUser&quot;</span><span class="nt">&gt;</span>
        select * from wxUser where
        <span class="nt">&lt;choose&gt;</span>
            <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">&quot;uId != null and openId == null&quot;</span><span class="nt">&gt;</span>
                uId = #{uId}
            <span class="nt">&lt;/when&gt;</span>
            <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">&quot;openId!= null and uId == null&quot;</span><span class="nt">&gt;</span>
                openId = #{openId}
            <span class="nt">&lt;/when&gt;</span>
            <span class="nt">&lt;otherwise&gt;</span>

            <span class="nt">&lt;/otherwise&gt;</span>
        <span class="nt">&lt;/choose&gt;</span>
    <span class="nt">&lt;/select&gt;</span>


    <span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&quot;insertWxUser&quot;</span><span class="nt">&gt;</span>
        INSERT into wxUser(openId,nickName,avatarUrl) value (
        #{openId},#{nickName},#{avatarUrl}
        )
    <span class="nt">&lt;/insert&gt;</span>



<span class="c">&lt;!--    &lt;resultMap id=&quot;theRoom&quot; type=&quot;map&quot;&gt;--&gt;</span>
<span class="c">&lt;!--        &lt;result column=&quot;rId&quot; property=&quot;rId&quot;/&gt;--&gt;</span>
<span class="c">&lt;!--        &lt;result column=&quot;rName&quot; property=&quot;rName&quot;/&gt;--&gt;</span>
<span class="c">&lt;!--        &lt;result column=&quot;address&quot; property=&quot;address&quot;/&gt;--&gt;</span>
<span class="c">&lt;!--        &lt;result column=&quot;lId&quot; property=&quot;lId&quot;/&gt;--&gt;</span>
<span class="c">&lt;!--        &lt;result column=&quot;uId&quot; property=&quot;uId&quot;/&gt;--&gt;</span>
<span class="c">&lt;!--        &lt;result column=&quot;state&quot; property=&quot;state&quot;/&gt;--&gt;</span>
<span class="c">&lt;!--        &lt;result column=&quot;lDate&quot; property=&quot;lDate&quot;/&gt;--&gt;</span>
<span class="c">&lt;!--        &lt;result column=&quot;avatarUrl&quot; property=&quot;avatarUrl&quot;/&gt;--&gt;</span>
<span class="c">&lt;!--        &lt;result column=&quot;nickName&quot; property=&quot;nickName&quot;/&gt;--&gt;</span>
<span class="c">&lt;!--    &lt;/resultMap&gt;--&gt;</span>
<span class="c">&lt;!--    &lt;select id=&quot;isInRoom&quot; resultMap=&quot;theRoom&quot;&gt;--&gt;</span>
<span class="c">&lt;!--        select w.avatarurl,w.nickName ,r.*,l.* from wxUser w,room r,log l--&gt;</span>
<span class="c">&lt;!--        where w.uid=#{uId} and w.rid = r.rid and w.rid = l.rid--&gt;</span>
<span class="c">&lt;!--        order by lDate desc--&gt;</span>
<span class="c">&lt;!--    &lt;/select&gt;--&gt;</span>



    <span class="nt">&lt;update</span> <span class="na">id=</span><span class="s">&quot;updateRoom&quot;</span><span class="nt">&gt;</span>
        update wxUser set
        <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&quot;rId==null&quot;</span><span class="nt">&gt;</span>
            rId = null
        <span class="nt">&lt;/if&gt;</span>
        <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&quot;rId!=null&quot;</span><span class="nt">&gt;</span>
            rId = #{rId}
        <span class="nt">&lt;/if&gt;</span>
        where uId = #{uId}
    <span class="nt">&lt;/update&gt;</span>

    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;getOnlineRoom&quot;</span> <span class="na">resultType=</span><span class="s">&quot;int&quot;</span><span class="nt">&gt;</span>
        select rId from wxUser where uId=#{uId}
    <span class="nt">&lt;/select&gt;</span>


    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&quot;getOnlineUser&quot;</span> <span class="na">resultType=</span><span class="s">&quot;int&quot;</span><span class="nt">&gt;</span>
        select count(*) from wxUser where rid=?
    <span class="nt">&lt;/select&gt;</span>
    <span class="nt">&lt;update</span> <span class="na">id=</span><span class="s">&quot;updateWxUser&quot;</span> <span class="nt">&gt;</span>
        update  wxUser set rid=? where uid=?
    <span class="nt">&lt;/update&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</pre></div>
<h3>八、小程序代码</h3>
<h6>1.首页页面(第一页)</h6>

<pre><code>&lt;view style="position: fixed;width: 100%;z-index: 100;"&gt;
    &lt;view class="bg-img bg-mask flex align-center" style="background-image:url(https://ossweb-img.qq.com/../images/大三下实训期末作业//lol/web201310/skin/big10006.jpg);height: 400upx;"&gt;
     &lt;view class="padding-xl text-white"&gt;
      &lt;view class=" text-sl text-bold"&gt;
       {{roomLog[0].rName}}
      &lt;/view&gt;
      &lt;view class="padding-xs text-lg"&gt;
       在线人数:20人
      &lt;/view&gt;
      &lt;button class="cu-btn lg green" @click="exitRoom"&gt;
       &lt;view class="cuIcon-exit"&gt;&lt;/view&gt;
      &lt;/button&gt;
     &lt;/view&gt;
    &lt;/view&gt;
   &lt;/view&gt;

   &lt;view style="position: absolute;top: 400upx;;width: 100%;"&gt;

    &lt;view class="cu-timeline " v-for="(item,index) in roomLog" :key="index"&gt;
     &lt;view class="text-grey text-lg"&gt;{{item.lDate | getYMD}}&lt;/view&gt;
     &lt;view class="cu-item " :class="item.state==1?'text-green':'text-blue'"&gt;
      &lt;view class="shadow-blur content" :class="item.state==1?'bg-green':'bg-blue'"&gt;
       &lt;view class="cu-list menu-avatar radius"&gt;
        &lt;view class="cu-item"&gt;
         &lt;view class="cu-avatar radius lg" :style="{backgroundImage:'url('+item.avatarUrl+')'}"&gt;&lt;/view&gt;
         &lt;view class="content"&gt;
          &lt;view&gt;
           &lt;view class="text-bold text-xl text-black"&gt;{{item.nickName}}&lt;/view&gt;
           &lt;view class="cu-tag radius sm " :class="item.state==1?'bg-green':'bg-blue'"&gt;{{item.state==1?'进':'出'}}&lt;/view&gt;
          &lt;/view&gt;
          &lt;view class="text-gray text-sm flex"&gt;
           &lt;view class="text-cut"&gt; 通过指纹进入&lt;/view&gt;
          &lt;/view&gt;

         &lt;/view&gt;
         &lt;view class="action"&gt;
          &lt;view class="text-grey text-lg"&gt;{{item.lDate | getHm}}&lt;/view&gt;
          &lt;view class="text-grey text-lg"&gt;星期{{item.lDate | getDay}}&lt;/view&gt;
         &lt;/view&gt;
        &lt;/view&gt;

       &lt;/view&gt;
      &lt;/view&gt;
     &lt;/view&gt;
    &lt;/view&gt;
   &lt;/view&gt;</code></pre>
<h6>2.首页方法调用</h6>
<div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">util</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;../../components/zwy/util/util.js&#39;</span><span class="p">);</span>
 <span class="kr">import</span> <span class="nx">clickCircle</span> <span class="nx">from</span> <span class="s1">&#39;../../components/zwy/clickCircle.vue&#39;</span><span class="p">;</span>
 <span class="kr">import</span> <span class="nx">moment</span> <span class="nx">from</span> <span class="s1">&#39;moment&#39;</span>

 <span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="nx">components</span><span class="o">:</span> <span class="p">{</span>
   <span class="nx">clickCircle</span>
  <span class="p">},</span>
  <span class="nx">data</span><span class="p">()</span> <span class="p">{</span>
   <span class="k">return</span> <span class="p">{</span>
    <span class="nx">roomLog</span><span class="o">:</span> <span class="p">{},</span>
    <span class="nx">userInfo</span><span class="o">:</span> <span class="p">{},</span>
    <span class="nx">isX</span><span class="o">:</span> <span class="mf">999</span><span class="p">,</span> <span class="c1">//放在store统一管理</span>
    <span class="nx">isY</span><span class="o">:</span> <span class="mf">999</span><span class="p">,</span> <span class="c1">//放在store统一管理</span>
    <span class="nx">toView</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="nx">showPicker</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">pickRoomList</span><span class="o">:</span> <span class="p">[],</span>
    <span class="nx">chooseRoom</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="nx">MsgInfo</span><span class="o">:</span> <span class="p">{}</span>


   <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">onShow</span><span class="p">()</span> <span class="p">{</span>

   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">moment</span><span class="p">().</span><span class="nx">format</span><span class="p">(</span><span class="s1">&#39;YYYY-MM-DD HH:mm:ss&#39;</span><span class="p">));</span>
   <span class="k">this</span><span class="p">.</span><span class="nx">isLogin</span><span class="p">()</span>

   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">userInfo</span><span class="p">.</span><span class="nx">realNameInfo</span><span class="p">)</span> <span class="p">{</span>

    <span class="nx">uni</span><span class="p">.</span><span class="nx">showModal</span><span class="p">({</span>
     <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;请先实名&quot;</span><span class="p">,</span>
     <span class="nx">showCancel</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
     <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">confirm</span><span class="p">)</span> <span class="p">{</span>
       <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;确定了啊&quot;</span><span class="p">)</span>
       <span class="nx">uni</span><span class="p">.</span><span class="nx">switchTab</span><span class="p">({</span>
        <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;/pages/profile/profile&quot;</span>
       <span class="p">})</span>
      <span class="p">}</span>

     <span class="p">}</span>
    <span class="p">})</span>
   <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">getRoom</span><span class="p">()</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">getRoomList</span><span class="p">()</span>
   <span class="p">}</span>
  <span class="p">},</span>
  <span class="c1">// 转化毫秒时间戳为日期格式</span>
  <span class="nx">filters</span><span class="o">:</span> <span class="p">{</span>
   <span class="nx">getYMD</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">moment</span><span class="p">(</span><span class="nx">value</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="s1">&#39;YYYY-MM-DD&#39;</span><span class="p">)</span>
   <span class="p">},</span>
   <span class="nx">getHm</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">moment</span><span class="p">(</span><span class="nx">value</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="s1">&#39;HH:mm&#39;</span><span class="p">)</span>
   <span class="p">},</span>
   <span class="nx">getDay</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">moment</span><span class="p">(</span><span class="nx">value</span><span class="p">).</span><span class="nx">format</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
   <span class="p">},</span>
   <span class="nx">getLength</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">value</span><span class="p">.</span><span class="nx">length</span>
   <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">methods</span><span class="o">:</span> <span class="p">{</span>

   <span class="nx">conClick</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">$refs</span><span class="p">.</span><span class="nx">clickCircle</span><span class="p">.</span><span class="nx">conClick</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
   <span class="p">},</span>
   <span class="nx">toTop</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">toView</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
     <span class="k">this</span><span class="p">.</span><span class="nx">toView</span> <span class="o">=</span> <span class="s1">&#39;top&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">currentTab</span>
    <span class="p">},</span> <span class="mf">10</span><span class="p">)</span>
   <span class="p">},</span>
   <span class="c1">// 判断登录</span>
   <span class="nx">isLogin</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">userInfo</span> <span class="o">=</span> <span class="nx">global</span><span class="p">.</span><span class="nx">isLogin</span><span class="p">();</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">userInfo</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">userInfo</span><span class="p">)</span> <span class="p">{</span>
     <span class="nx">uni</span><span class="p">.</span><span class="nx">showModal</span><span class="p">({</span>
      <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;请先登录&quot;</span><span class="p">,</span>
      <span class="nx">showCancel</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">if</span> <span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">confirm</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;确定了啊&quot;</span><span class="p">)</span>
        <span class="nx">uni</span><span class="p">.</span><span class="nx">switchTab</span><span class="p">({</span>
         <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;/pages/profile/profile&quot;</span>
        <span class="p">})</span>
       <span class="p">}</span>

      <span class="p">}</span>
     <span class="p">})</span>
    <span class="p">}</span>
   <span class="p">},</span>
   <span class="nx">getRoom</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="nx">uni</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span>
     <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;http://47.100.59.153:8080/attendance/home/home&quot;</span><span class="p">,</span>
     <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;uId&quot;</span><span class="o">:</span> <span class="nx">that</span><span class="p">.</span><span class="nx">userInfo</span><span class="p">.</span><span class="nx">uId</span><span class="p">,</span>
      <span class="s2">&quot;rId&quot;</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
      <span class="s2">&quot;state&quot;</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
      <span class="s2">&quot;lDate&quot;</span><span class="o">:</span> <span class="s2">&quot;&quot;</span>
     <span class="p">},</span>
     <span class="nx">success</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span>
      <span class="nx">that</span><span class="p">.</span>
</pre></div>
<h6>3.登陆拦截方法</h6>

<pre><code>&lt;template&gt;
 &lt;view class="container" @click="conClick"&gt;
  &lt;clickCircle ref="clickCircle"&gt;&lt;/clickCircle&gt;
  &lt;cu-custom bgColor="bg-blue"&gt;
  &lt;/cu-custom&gt;
  &lt;view&gt;&lt;/view&gt;
  &lt;!-- &lt;home&gt;&lt;/home&gt; --&gt;
  &lt;button @click="addGlobal"&gt;值为{{this.wxUserInfo}}&lt;/button&gt;
  &lt;navigator url="../home/home"&gt;跳转&lt;/navigator&gt;

  &lt;view class="cu-modal show" v-if="!userInfo"&gt;
    &lt;view class="cu-dialog"&gt;
      &lt;/view&gt;
   &lt;navigator url="../profile/profile"&gt;
      &lt;button class="cu-btn block bg-green lg shadow" &gt;清先登录&lt;/button&gt;
   &lt;/navigator&gt;
    &lt;/view&gt;
  &lt;/view&gt;


 &lt;/view&gt;
&lt;/template&gt;

&lt;script&gt;
 import clickCircle from '../../components/zwy/zwy-clickCircle.vue';
 import home from '../../pages/home/home.vue'
 export default {
  components: {
   clickCircle,
   home
  },
  data() {
   return {
    userInfo:[]
   };
  },
  onLoad() {
   this.isLogin();
   this.springTest();
  },
  methods: {
   // 判断登录
   isLogin(){
    var isLogin = global.isLogin();
    console.log(isLogin)
    if(!isLogin){
     uni.showModal({
      title:"未登录",
      success:function(){
       uni.navigateTo({
        url:"/pages/profile/profile"
       })
      }
     })
    }this.userInfo=uni.getStorageSync("userInfo")
   },

   // 调用springboot接口实例
   springTest(){
    uni.request({
     url:"http://localhost:8080/attendencyMiniprogram/log/getLogByRid/1",
     success(res){
      console.log(res.data)
     }
    })
   },

   conClick(e) {
    this.$refs.clickCircle.conClick(e);
   },
   addGlobal(){
    console.log(this.wxUserInfo)
    if(!this.wxUserInfo){
     this.wxUserInfo=1
    }

    this.wxUserInfo++
   }
  }
 }
&lt;/script&gt;</code></pre>
<h6>4.日志方法调用</h6>

<pre><code>&lt;!-- 我的教室详细日志 --&gt;
  &lt;view class="cu-modal" :class="modalName=='logDetail'?'show':''"&gt;

   &lt;view class="cu-dialog"&gt;

    &lt;view class="cu-bar bg-white justify-end"&gt;
     &lt;view class="content"&gt;我在{{myRoomLog[0].rName}}的日志&lt;/view&gt;
     &lt;view class="action" @tap="hideModal"&gt;
      &lt;text class="cuIcon-roundclose text-red text-xxl"&gt;&lt;/text&gt;
     &lt;/view&gt;
    &lt;/view&gt;

    &lt;!-- 我的教室详细日志 --&gt;
    &lt;scroll-view style="height: 800upx;" scroll-y="true"&gt;
     &lt;view v-for="(item,index) in myRoomLog" :key="index"&gt;
      &lt;view class="cu-timeline padding-sm"&gt;
       &lt;view class="text-grey "&gt;{{item.lDate | getYMD}}&lt;/view&gt;
       &lt;view class="cu-item " :class="item.state==1?'text-green':'text-blue'"&gt;
        &lt;view class="shadow-blur content" :class="item.state==1?'bg-green':'bg-blue'"&gt;
         &lt;view class="cu-list menu-avatar radius"&gt;
          &lt;view class="cu-item"&gt;
           &lt;view class="cu-avatar lg radius " :class="item.state==1?'bg-green':'bg-blue'"&gt;{{item.state==1?'进':'出'}}&lt;/view&gt;
           &lt;view class="content"&gt;
            &lt;view class="cu-capsule radius"&gt;
             &lt;view class="cu-tag bg-red text-sm"&gt;
              &lt;text class="cuIcon-location"&gt;&lt;/text&gt;
             &lt;/view&gt;
             &lt;view class="cu-tag line-red  text-sm"&gt;{{item.rName}}&lt;/view&gt;
            &lt;/view&gt;
            &lt;view class="text-grey text-xs"&gt;通过指纹进入&lt;/view&gt;


           &lt;/view&gt;
           &lt;view class="action"&gt;
            &lt;view class="text-grey text-lg"&gt;{{item.lDate | getHm}}&lt;/view&gt;
            &lt;view class="text-grey text-lg"&gt;星期{{item.lDate | getDay}}&lt;/view&gt;
           &lt;/view&gt;
          &lt;/view&gt;

         &lt;/view&gt;
        &lt;/view&gt;
       &lt;/view&gt;
      &lt;/view&gt;
     &lt;/view&gt;

     &lt;view class="text-gray card-menu padding-sm"&gt;共{{this.myRoomLog | getLength}}条日志&lt;/view&gt;
    &lt;/scroll-view&gt;
   &lt;/view&gt;

  &lt;/view&gt;

 &lt;/view&gt;

&lt;/template&gt;</code></pre>
<h6>5.调用后台数据实现获取进出教室日志</h6>
<div class="highlight"><pre><span></span><span class="nx">onShow</span><span class="p">()</span> <span class="p">{</span>
   <span class="k">this</span><span class="p">.</span><span class="nx">isLogin</span><span class="p">()</span>
   <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">userInfo</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">userInfo</span><span class="p">.</span><span class="nx">realNameInfo</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">getLog</span><span class="p">()</span>
   <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">userInfo</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">userInfo</span><span class="p">.</span><span class="nx">realNameInfo</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">uni</span><span class="p">.</span><span class="nx">showModal</span><span class="p">({</span>
     <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;请先实名&quot;</span><span class="p">,</span>
     <span class="nx">showCancel</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
     <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">confirm</span><span class="p">)</span> <span class="p">{</span>
       <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;确定了啊&quot;</span><span class="p">)</span>
       <span class="nx">uni</span><span class="p">.</span><span class="nx">switchTab</span><span class="p">({</span>
        <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;/pages/profile/profile&quot;</span>
       <span class="p">})</span>
      <span class="p">}</span>

     <span class="p">}</span>
    <span class="p">})</span>
   <span class="p">}</span>

  <span class="p">},</span>
  <span class="nx">methods</span><span class="o">:</span> <span class="p">{</span>
   <span class="nx">conClick</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">$refs</span><span class="p">.</span><span class="nx">clickCircle</span><span class="p">.</span><span class="nx">conClick</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
   <span class="p">},</span>
   <span class="c1">// 判断登录</span>
   <span class="nx">isLogin</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">userInfo</span> <span class="o">=</span> <span class="nx">global</span><span class="p">.</span><span class="nx">isLogin</span><span class="p">();</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">userInfo</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">userInfo</span><span class="p">)</span> <span class="p">{</span>
     <span class="nx">uni</span><span class="p">.</span><span class="nx">showModal</span><span class="p">({</span>
      <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;请先登录&quot;</span><span class="p">,</span>
      <span class="nx">showCancel</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">if</span> <span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">confirm</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;确定了啊&quot;</span><span class="p">)</span>
        <span class="nx">uni</span><span class="p">.</span><span class="nx">switchTab</span><span class="p">({</span>
         <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;/pages/profile/profile&quot;</span>
        <span class="p">})</span>
       <span class="p">}</span>

      <span class="p">}</span>
     <span class="p">})</span>
    <span class="p">}</span>
   <span class="p">},</span>

   <span class="nx">getLog</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

    <span class="nx">uni</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span>
     <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;http://47.100.59.153:8080/attendance/log/getLog&quot;</span><span class="p">,</span>
     <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;uId&quot;</span><span class="o">:</span> <span class="nx">that</span><span class="p">.</span><span class="nx">userInfo</span><span class="p">.</span><span class="nx">uId</span><span class="p">,</span>
      <span class="s2">&quot;rId&quot;</span><span class="o">:</span> <span class="s2">&quot;&quot;</span>
     <span class="p">},</span>
     <span class="nx">success</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span>
      <span class="nx">that</span><span class="p">.</span><span class="nx">myLogList</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">logList</span>
      <span class="c1">// for(let i = 0;i&lt;that.myLogList.length;i++){</span>
      <span class="c1">//  that.myLogList[i].lDate = moment(res.data.logList[0].lDate).format(&#39;YYYY-MM-DD-dd HH:mm:ss&#39;)</span>
      <span class="c1">// }    </span>
      <span class="nx">that</span><span class="p">.</span><span class="nx">roomList</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">roomList</span>
      <span class="nx">that</span><span class="p">.</span><span class="nx">list</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">that</span><span class="p">.</span><span class="nx">myLogList</span><span class="p">.</span><span class="nx">reverse</span><span class="p">()</span>
      <span class="nx">that</span><span class="p">.</span><span class="nx">list</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">that</span><span class="p">.</span><span class="nx">roomList</span><span class="p">.</span><span class="nx">reverse</span><span class="p">()</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">that</span><span class="p">.</span><span class="nx">list</span><span class="p">)</span>
      <span class="nx">uni</span><span class="p">.</span><span class="nx">showToast</span><span class="p">({</span>
       <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;获取日志成功&quot;</span>
      <span class="p">})</span>

     <span class="p">}</span>
    <span class="p">})</span>


   <span class="p">},</span>
   <span class="c1">// 获取我的教室日志详细信息</span>
   <span class="nx">getMyRoomDetail</span><span class="p">(</span><span class="nx">rId</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">rId</span><span class="p">)</span>
    <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">that</span><span class="p">.</span><span class="nx">userInfo</span><span class="p">.</span><span class="nx">uId</span> <span class="o">&amp;&amp;</span> <span class="nx">rId</span><span class="p">)</span> <span class="p">{</span>
     <span class="nx">uni</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span>
      <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;http://47.100.59.153:8080/attendance/log/getLog&quot;</span><span class="p">,</span>
      <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
       <span class="s2">&quot;uId&quot;</span><span class="o">:</span> <span class="nx">that</span><span class="p">.</span><span class="nx">userInfo</span><span class="p">.</span><span class="nx">uId</span><span class="p">,</span>
       <span class="s2">&quot;rId&quot;</span><span class="o">:</span> <span class="nx">rId</span>
      <span class="p">},</span>
      <span class="nx">success</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
       <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span>
       <span class="nx">that</span><span class="p">.</span><span class="nx">myRoomLog</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">logList</span><span class="p">.</span><span class="nx">reverse</span><span class="p">()</span>
       <span class="nx">uni</span><span class="p">.</span><span class="nx">showToast</span><span class="p">({</span>
        <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;获取成功&quot;</span>
       <span class="p">})</span>

      <span class="p">}</span>
     <span class="p">})</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
     <span class="nx">uni</span><span class="p">.</span><span class="nx">showToast</span><span class="p">(</span>
</pre></div>
<h6>6.登陆授权</h6>
<div class="highlight"><pre><span></span><span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="nx">data</span><span class="p">()</span> <span class="p">{</span>
   <span class="k">return</span> <span class="p">{</span>
    <span class="nx">userInfo</span><span class="o">:</span><span class="p">[]</span>
   <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">methods</span><span class="o">:</span> <span class="p">{</span>
   <span class="nx">getuserinfo</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">res</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">iv</span><span class="p">)</span> <span class="p">{</span>
     <span class="nx">uni</span><span class="p">.</span><span class="nx">showToast</span><span class="p">({</span>
      <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;求求你授权吧&quot;</span>
     <span class="p">})</span>
     <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">userInfo</span><span class="o">=</span><span class="nx">res</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">userInfo</span>
    <span class="c1">// 调用云函数获取openid</span>
    <span class="nx">wx</span><span class="p">.</span><span class="nx">cloud</span><span class="p">.</span><span class="nx">callFunction</span><span class="p">({</span>
     <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;login&#39;</span><span class="p">,</span>
     <span class="nx">data</span><span class="o">:</span> <span class="p">{},</span>
     <span class="nx">success</span><span class="o">:</span> <span class="nx">res</span> <span class="p">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;[云函数] [login] user openid: &#39;</span><span class="p">,</span> <span class="nx">res</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">openid</span><span class="p">)</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">userInfo</span><span class="p">.</span><span class="nx">openid</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">openid</span>
      <span class="nx">uni</span><span class="p">.</span><span class="nx">setStorageSync</span><span class="p">(</span><span class="s2">&quot;userInfo&quot;</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">userInfo</span><span class="p">)</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">uni</span><span class="p">.</span><span class="nx">getStorage</span><span class="p">(</span><span class="s2">&quot;userInfo&quot;</span><span class="p">))</span>
      <span class="nx">uni</span><span class="p">.</span><span class="nx">navigateTo</span><span class="p">({</span>
       <span class="nx">url</span><span class="o">:</span><span class="s2">&quot;../index/index&quot;</span>
      <span class="p">})</span>
     <span class="p">},</span>
     <span class="nx">fail</span><span class="o">:</span> <span class="nx">err</span> <span class="p">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;[云函数] [login] 调用失败&#39;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
     <span class="p">},</span>
    <span class="p">})</span>
   <span class="p">}</span>

  <span class="p">}</span>
 <span class="p">}</span>
</pre></div>
<h6>7.超级管理员页面（第二页）</h6>

<pre><code>&lt;view @click="conClick"&gt;
  &lt;clickCircle ref="clickCircle"&gt;&lt;/clickCircle&gt;

    &lt;scroll-view scroll-y class="page"&gt;

     &lt;swiper class="card-swiper round-dot"  :indicator-dots="true" :circular="true"
      :autoplay="true" interval="5000" duration="500" @change="cardSwiper" indicator-color="#8799a3"
      indicator-active-color="#0081ff"&gt;
      &lt;swiper-item v-for="(item,index) in swiperList" :key="index" :class="cardCur==index?'cur':''"&gt;
       &lt;view class="swiper-item"&gt;
        &lt;image :src="item.url" mode="aspectFill" v-if="item.type=='image'"&gt;&lt;/image&gt;
        &lt;video :src="item.url" autoplay loop muted :show-play-btn="false" :controls="false" objectFit="cover" v-if="item.type=='video'"&gt;&lt;/video&gt;
       &lt;/view&gt;
      &lt;/swiper-item&gt;
     &lt;/swiper&gt;

    &lt;view class="nav-list"&gt;
     &lt;navigator hover-class="none" :url="'/pages/charge/' + item.name" class="nav-li" navigateTo :class="'bg-'+item.color"
      :style="[{animation: 'show ' + ((index+1)*0.2+1) + 's 1'}]" v-for="(item,index) in elements" :key="index"&gt;
      &lt;view class="nav-title"&gt;{{item.title}}&lt;/view&gt;
      &lt;view class="nav-name"&gt;{{item.name}}&lt;/view&gt;
      &lt;text :class="'cuIcon-' + item.cuIcon"&gt;&lt;/text&gt;
     &lt;/navigator&gt;
    &lt;/view&gt;
    &lt;/scroll-view&gt; 
 &lt;/view&gt;</code></pre>
<h6>8.管理员添加方法实现</h6>
<div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
 <span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="nx">data</span><span class="p">()</span> <span class="p">{</span>
   <span class="k">return</span> <span class="p">{</span>
    <span class="nx">index</span><span class="o">:</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span>


    <span class="nx">multiIndex</span><span class="o">:</span> <span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span> <span class="p">],</span>
    <span class="nx">time</span><span class="o">:</span> <span class="s1">&#39;12:01&#39;</span><span class="p">,</span>
    <span class="nx">date</span><span class="o">:</span> <span class="s1">&#39;2018-12-25&#39;</span><span class="p">,</span>

    <span class="nx">modalName</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nx">textareaAValue</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="nx">textareaBValue</span><span class="o">:</span> <span class="s1">&#39;&#39;</span>
   <span class="p">};</span>
  <span class="p">},</span>
  <span class="nx">submit</span><span class="o">:</span><span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
   <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
       <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
       <span class="kd">let</span> <span class="nx">rId</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">rId</span>
       <span class="kd">let</span> <span class="nx">uId</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">uId</span>
       <span class="kd">let</span> <span class="nx">del</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">del</span>


       <span class="k">if</span> <span class="p">((</span><span class="o">!</span><span class="nx">rId</span> <span class="o">||</span> <span class="o">!</span><span class="nx">uId</span><span class="p">)</span> <span class="o">||</span> <span class="o">!</span><span class="nx">del</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// this.onTowast(&quot;请填写完整&quot;)</span>
        <span class="nx">uni</span><span class="p">.</span><span class="nx">showToast</span><span class="p">({</span>
         <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;请填写完整&quot;</span><span class="p">,</span>
         <span class="nx">icon</span><span class="o">:</span> <span class="s2">&quot;none&quot;</span>
        <span class="p">})</span>
        <span class="k">return</span> <span class="kc">false</span>
       <span class="p">}</span>
       <span class="nx">uni</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span>
        <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;http://localhost:8080/attendance/Room/add&quot;</span><span class="p">,</span>
        <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
         <span class="s2">&quot;rId&quot;</span><span class="o">:</span> <span class="nx">that</span><span class="p">.</span><span class="nx">userInfo</span><span class="p">.</span><span class="nx">rId</span><span class="p">,</span>
         <span class="s2">&quot;uId&quot;</span><span class="o">:</span> <span class="nx">e</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">uId</span><span class="p">,</span>
         <span class="s2">&quot;del&quot;</span><span class="o">:</span> <span class="nx">e</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">del</span><span class="p">,</span>
         <span class="s2">&quot;address&quot;</span><span class="o">:</span><span class="nx">e</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">address</span>
        <span class="p">},</span>
        <span class="nx">success</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
         <span class="kd">let</span> <span class="nx">title</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>

         <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">)</span>
         <span class="kd">let</span> <span class="nx">msg</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">;</span>

         <span class="nx">uni</span><span class="p">.</span><span class="nx">showToast</span><span class="p">({</span>
          <span class="nx">title</span><span class="o">:</span> <span class="nx">title</span><span class="p">,</span>
          <span class="nx">icon</span><span class="o">:</span> <span class="s2">&quot;none&quot;</span>
         <span class="p">})</span>
         <span class="nx">that</span><span class="p">.</span><span class="nx">successNotify</span><span class="p">(</span><span class="nx">title</span><span class="p">)</span>
        <span class="p">}</span>
       <span class="p">})</span>
  <span class="p">},</span>
  <span class="nx">methods</span><span class="o">:</span> <span class="p">{</span>
   <span class="nx">PickerChange</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">index</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">value</span>
   <span class="p">},</span>
   <span class="nx">MultiChange</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">multiIndex</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">value</span>
   <span class="p">},</span>
   <span class="nx">MultiColumnChange</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
     <span class="nx">multiArray</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">multiArray</span><span class="p">,</span>
     <span class="nx">multiIndex</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">multiIndex</span>
    <span class="p">};</span>
    <span class="nx">data</span><span class="p">.</span><span class="nx">multiIndex</span><span class="p">[</span><span class="nx">e</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">column</span><span class="p">]</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>

   <span class="p">},</span>
   <span class="nx">TimeChange</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">time</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">value</span>
   <span class="p">},</span>
   <span class="nx">DateChange</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">date</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">value</span>
   <span class="p">},</span>


  <span class="p">}</span>
 <span class="p">}</span>
<span class="o">&lt;</span><span class="err">/script&gt;</span>
</pre></div>
<p><figure><img data-width="-1" data-height="-1" src="C:\Users\15010\AppData\Roaming\Typora\typora-user-../images/大三下实训期末作业/\image-20200113223503069.png" alt="image-20200113223503069" /><figcaption>image-20200113223503069</figcaption></figure></p>
<h6>9.管理员更新页面</h6>

<pre><code>&lt;template&gt;
 &lt;view&gt;
  &lt;cu-custom bgColor="bg-gradual-pink" :isBack="true"&gt;
   &lt;block slot="backText"&gt;返回&lt;/block&gt;
   &lt;block slot="content"&gt;更改&lt;/block&gt;
  &lt;/cu-custom&gt;
  &lt;form bindsubmit='submit' bindreset='reset' bindtap='click'&gt;
   &lt;view class="cu-form-group margin-top"&gt;
    &lt;view class="title"&gt;房间编号&lt;/view&gt;
    &lt;picker mode="selector" :value="Index" :range="Room" :range-key="rName" :data-selecthx="Room[fj_index].name" @change="change" &gt;
          &lt;view class="picker"&gt;
       {{Room[fj_index].name}}
        &lt;/view&gt;
    &lt;/picker&gt;
   &lt;/view&gt;
   &lt;view class="cu-form-group"&gt;
    &lt;view class="title"&gt;管理员编号&lt;/view&gt;
    &lt;input placeholder="请输入管理员编号" name="uId"&gt;&lt;/input&gt;
   &lt;/view&gt;

   &lt;view class="cu-form-group"&gt;
    &lt;view class="title"&gt;是否开放&lt;/view&gt;
    &lt;input placeholder="输入是或否" name="del"&gt;&lt;/input&gt;
   &lt;/view&gt;

   &lt;!-- #ifndef MP-ALIPAY --&gt;

   &lt;!-- #endif --&gt;


  &lt;button form-type='submit' @click="submit"&gt;提交&lt;/button&gt;
  &lt;button form-type="reset" @click="reset"&gt;重置&lt;/button&gt;
  &lt;/form&gt;
 &lt;/view&gt;
&lt;/template&gt;</code></pre>
<p>实现</p>
<div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
 <span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="nx">data</span><span class="p">()</span> <span class="p">{</span>
   <span class="k">return</span> <span class="p">{</span>
    <span class="nx">index</span><span class="o">:</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span>
    <span class="nx">multiIndex</span><span class="o">:</span> <span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span> <span class="p">],</span>
    <span class="nx">time</span><span class="o">:</span> <span class="s1">&#39;12:01&#39;</span><span class="p">,</span>
    <span class="nx">date</span><span class="o">:</span> <span class="s1">&#39;2018-12-25&#39;</span><span class="p">,</span>

    <span class="nx">modalName</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nx">textareaAValue</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="nx">textareaBValue</span><span class="o">:</span> <span class="s1">&#39;&#39;</span>
   <span class="p">};</span>
  <span class="p">},</span>
  <span class="nx">onLoad</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
       <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

       <span class="nx">wx</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span>
        <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;http://localhost:8080/attendance/Room/roomList&quot;</span><span class="p">,</span>
        <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">Room</span><span class="o">:</span> <span class="p">[]</span>  <span class="c1">//参数</span>
        <span class="p">},</span>
        <span class="nx">header</span><span class="o">:</span> <span class="p">{</span>
          <span class="s2">&quot;Content-Type&quot;</span><span class="o">:</span> <span class="s1">&#39;application/json&#39;</span>
        <span class="p">},</span>
        <span class="nx">method</span><span class="o">:</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
        <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">that</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span>

                <span class="nx">Room</span><span class="o">:</span> <span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">exp_hx</span><span class="p">,</span>  <span class="c1">//把json数据赋值给变量pic_array_hx</span>
  <span class="p">})</span> <span class="p">}</span> <span class="p">})</span> <span class="p">},</span>
  <span class="nx">methods</span><span class="o">:</span> <span class="p">{</span>

   <span class="nx">PickerChange</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">index</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">value</span>
   <span class="p">},</span>

   <span class="nx">TimeChange</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">time</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">value</span>
   <span class="p">},</span>
   <span class="nx">DateChange</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">date</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">value</span>
   <span class="p">},</span>
   <span class="nx">change</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span>
   <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">Index</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">detail</span>

   <span class="p">},</span>

  <span class="p">}</span>
 <span class="p">}</span>
<span class="o">&lt;</span><span class="err">/script&gt;</span>
</pre></div>
<h6><figure><img data-width="-1" data-height="-1" src="C:\Users\15010\AppData\Roaming\Typora\typora-user-../images/大三下实训期末作业/\image-20200113224130571.png" alt="image-20200113224130571" /><figcaption>image-20200113224130571</figcaption></figure></h6>
<h6>10.排行榜页面</h6>

<pre><code>&lt;view @click="conClick" v-if="userInfo.realNameInfo"&gt;
  &lt;clickCircle ref="clickCircle"&gt;&lt;/clickCircle&gt;

  &lt;view class="space" &gt;
   &lt;block v-if="AllUserTime"&gt;
    &lt;view class="bg-img bg-mask flex align-center" :style="{backgroundImage:'url('+AllUserTime[0].avatarUrl+')'}" style="height: 500upx;"&gt;
     &lt;view class="padding-xl text-white"&gt;

      &lt;view class="flex   align-center"&gt;
       &lt;view class="cu-avatar radius " :style="{backgroundImage:'url('+AllUserTime[0].avatarUrl+')'}"&gt;&lt;/view&gt;
       &lt;view class="padding-sm text-xxl text-bold"&gt;
        {{AllUserTime[0].nickName}}占领了今天的封面
       &lt;/view&gt;
      &lt;/view&gt;

      &lt;view class="padding-xs text-lg"&gt;
       总时长:{{AllUserTime[0].time|TimeToString}}
      &lt;/view&gt;
     &lt;/view&gt;
    &lt;/view&gt;


    &lt;view class="cu-list menu-avatar "&gt;
     &lt;block v-for="(item,index) in AllUserTime" :key="index"&gt;
      &lt;view v-if="item.uId==userInfo.uId" class="cu-item bg-black"&gt;
       &lt;view class="cu-avatar radius lg" :style="{backgroundImage:'url('+item.avatarUrl+')'}"&gt;
        &lt;view class="cu-tag badge lg"&gt;{{index+1}}&lt;/view&gt;
       &lt;/view&gt;
       &lt;view class="content"&gt;
        &lt;view class="text-black text-bold text-xxl"&gt;{{item.nickName}}&lt;/view&gt;

       &lt;/view&gt;
       &lt;view class="action"&gt;
        &lt;view class="text-orange text-bold text-xl"&gt;{{item.time|TimeToString}}&lt;/view&gt;
       &lt;/view&gt;
       &lt;view class="move"&gt;
        &lt;view class="bg-grey"&gt;置顶&lt;/view&gt;
        &lt;view class="bg-red"&gt;关注&lt;/view&gt;
       &lt;/view&gt;
      &lt;/view&gt;
     &lt;/block&gt;
    &lt;/view&gt;


    &lt;view class="cu-list menu-avatar "&gt;
     &lt;view class="cu-item " style="border:10rpx" :class="modalName=='move-box-'+ index?'move-cur':''" v-for="(item,index) in AllUserTime"
      :key="index" @touchstart="ListTouchStart" @touchmove="ListTouchMove" @touchend="ListTouchEnd" :data-target="'move-box-' + index"&gt;

      &lt;view class="cu-avatar radius lg" :style="{backgroundImage:'url('+item.avatarUrl+')'}"&gt;
       &lt;view class="cu-tag badge green"&gt;{{index+1}}&lt;/view&gt;
      &lt;/view&gt;
      &lt;view class="content"&gt;
       &lt;view class="text-black text-bol</code></pre>
<p>方法实现</p>
<div class="highlight"><pre><span></span><span class="nx">onShow</span><span class="p">()</span> <span class="p">{</span>
   <span class="k">this</span><span class="p">.</span><span class="nx">isLogin</span><span class="p">()</span>
   <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">userInfo</span><span class="p">.</span><span class="nx">uId</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">getAllUserTime</span><span class="p">()</span>
   <span class="p">}</span><span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">userInfo</span> <span class="o">&amp;&amp;</span><span class="k">this</span><span class="p">.</span><span class="nx">userInfo</span><span class="p">.</span><span class="nx">realNameInfo</span><span class="o">==</span><span class="kc">null</span><span class="p">){</span>
    <span class="nx">uni</span><span class="p">.</span><span class="nx">showModal</span><span class="p">({</span>
     <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;请先实名&quot;</span><span class="p">,</span>
     <span class="nx">showCancel</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
     <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">confirm</span><span class="p">)</span> <span class="p">{</span>
       <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;确定了啊&quot;</span><span class="p">)</span>
       <span class="nx">uni</span><span class="p">.</span><span class="nx">switchTab</span><span class="p">({</span>
        <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;/pages/profile/profile&quot;</span>
       <span class="p">})</span>
      <span class="p">}</span>

     <span class="p">}</span>
    <span class="p">})</span>
   <span class="p">}</span>

  <span class="p">},</span>
  <span class="nx">filters</span><span class="o">:</span> <span class="p">{</span>
   <span class="nx">TimeToString</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">hour</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">value</span> <span class="o">/</span> <span class="mf">60</span><span class="p">)</span>
    <span class="kd">var</span> <span class="nx">minute</span> <span class="o">=</span> <span class="nx">value</span> <span class="o">%</span> <span class="mf">60</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">hour</span> <span class="o">&lt;</span> <span class="mf">10</span><span class="p">)</span> <span class="p">{</span>
     <span class="nx">hour</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span> <span class="o">+</span> <span class="nx">hour</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
     <span class="nx">hour</span> <span class="o">=</span> <span class="nx">hour</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">minute</span> <span class="o">&lt;</span> <span class="mf">10</span><span class="p">)</span> <span class="p">{</span>
     <span class="nx">minute</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span> <span class="o">+</span> <span class="nx">minute</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">hour</span> <span class="o">+</span> <span class="nx">minute</span>
   <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">methods</span><span class="o">:</span> <span class="p">{</span>
   <span class="nx">conClick</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">$refs</span><span class="p">.</span><span class="nx">clickCircle</span><span class="p">.</span><span class="nx">conClick</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
   <span class="p">},</span>
   <span class="c1">// 判断登录</span>
   <span class="nx">isLogin</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">userInfo</span> <span class="o">=</span> <span class="nx">global</span><span class="p">.</span><span class="nx">isLogin</span><span class="p">();</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">userInfo</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">userInfo</span><span class="p">)</span> <span class="p">{</span>
     <span class="nx">uni</span><span class="p">.</span><span class="nx">showModal</span><span class="p">({</span>
      <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;请先登录&quot;</span><span class="p">,</span>
      <span class="nx">showCancel</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">if</span> <span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">confirm</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;确定了啊&quot;</span><span class="p">)</span>
        <span class="nx">uni</span><span class="p">.</span><span class="nx">switchTab</span><span class="p">({</span>
         <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;/pages/profile/profile&quot;</span>
        <span class="p">})</span>
       <span class="p">}</span>

      <span class="p">}</span>
     <span class="p">})</span>
    <span class="p">}</span>
   <span class="p">},</span>
   <span class="nx">getAllUserTime</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="nx">uni</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span>
     <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;http://47.100.59.153:8080/attendance/time/getAllUserTime&quot;</span><span class="p">,</span>
     <span class="nx">success</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span>
      <span class="nx">that</span><span class="p">.</span><span class="nx">AllUserTime</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">allUserTime</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">that</span><span class="p">.</span><span class="nx">AllUserTime</span><span class="p">)</span>
     <span class="p">}</span>
    <span class="p">})</span>
   <span class="p">},</span>
   <span class="c1">// ListTouch触摸开始</span>
   <span class="nx">ListTouchStart</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">listTouchStart</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">touches</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">pageX</span>
   <span class="p">},</span>

   <span class="c1">// ListTouch计算方向</span>
   <span class="nx">ListTouchMove</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">listTouchDirection</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">touches</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">pageX</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">listTouchStart</span> <span class="o">&gt;</span> <span class="mf">0</span> <span class="o">?</span> <span class="s1">&#39;right&#39;</span> <span class="o">:</span> <span class="s1">&#39;left&#39;</span>
   <span class="p">},</span>

   <span class="c1">// ListTouch计算滚动</span>
   <span class="nx">ListTouchEnd</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">listTouchDirection</span> <span class="o">==</span> <span class="s1">&#39;left&#39;</span><span class="p">)</span> <span class="p">{</span>
     <span class="k">this</span><span class="p">.</span><span class="nx">modalName</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">target</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
     <span class="k">this</span><span class="p">.</span><span class="nx">modalName</span> <span class="o">=</span> <span class="kc">null</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">listTouchDirection</span> <span class="o">=</span> <span class="kc">null</span>
   <span class="p">}</span>
  <span class="p">}</span>
</pre></div>
<h6>11.实名页面</h6>

<pre><code>&lt;view @click="conClick"&gt;
  &lt;!-- 登录模块 --&gt;
  &lt;!--   &lt;cu-custom bgColor="bg-gradual-pink" v-if="!userInfo"&gt;
   &lt;block slot="content"&gt;登录模块&lt;/block&gt;
  &lt;/cu-custom&gt; --&gt;
  &lt;clickCircle ref="clickCircle"&gt;&lt;/clickCircle&gt;
  &lt;view class="space"&gt;


  &lt;view class="cu-modal show" v-if="!userInfo"&gt;
   &lt;view class="cu-dialog"&gt;
    &lt;van-button v-if="!userInfo" icon="file" type="primary" size="large" open-type="getUserInfo" @getuserinfo="getUserinfo"&gt;微信一键登录&lt;/van-button&gt;
   &lt;/view&gt;
  &lt;/view&gt;

  &lt;van-notify id="van-notify"&gt;&lt;/van-notify&gt;


  &lt;!-- 用户显示界面 --&gt;
  &lt;!-- 'https://i.loli.net/2019/11/16/HOnxavlZ2z5Kfri.jpg' --&gt;

  &lt;view v-if="userInfo" class="bg-img bg-mask flex align-end" style="background-image: url('https://i.loli.net/2019/11/16/HOnxavlZ2z5Kfri.jpg');height: 400upx;"&gt;
   &lt;view class="bg-shadeCenter padding  flex  align-start"&gt;
    &lt;!-- #ifdef MP-WEIXIN --&gt;
    &lt;!-- {{userInfo.avatarUrl}} --&gt;
    &lt;view class="cu-avatar xl radius" :style="{backgroundImage:'url('+userInfo.avatarUrl+')'}"&gt;
     &lt;view class="cu-tag badge" :class="userInfo.gender==1?'cuIcon-male bg-blue':'cuIcon-female bg-pink'"&gt;
     &lt;/view&gt;
    &lt;/view&gt;
    &lt;!-- #endif --&gt;

    &lt;view class="grid col-1"&gt;
     &lt;view class=" padding-left-sm radius text-bold text-white text-xl"&gt;{{userInfo.nickName}}&lt;/view&gt;
     &lt;view class="cu-capsule radius padding-sm padding-top-lg"&gt;
      &lt;view class="cu-tag bg-blue xl"&gt;
       &lt;text class="cuIcon-people "&gt;&lt;/text&gt;
      &lt;/view&gt;
      &lt;view class="cu-tag line-white xl " v-if="userInfo.sSuper==0"&gt;
       超管
      &lt;/view&gt;
      &lt;view class="cu-tag line-white xl " v-else&gt;
       普通用户
      &lt;/view&gt;
     &lt;/view&gt;
    &lt;/view&gt;
   &lt;/view&gt;
  &lt;/view&gt;


  &lt;!-- 小菜单 --&gt;

  &lt;view class="cu-list menu card-menu margin-top sm-border" v-if="userInfo"&gt;
   &lt;view class="cu-item arrow" @tap="showModal" data-target="realName"&gt;

    &lt;view class="content"&gt;
     &lt;text class="cuIcon-peoplefill text-red text-xl "&gt;&lt;/text&gt;
     &lt;text class="text-grey"&gt;实名认证&lt;/text&gt;
    &lt;/view&gt;
    &lt;view class="action"&gt;
     &lt;view class="cu-tag round bg-blue" v-if="userInfo.realNa</code></pre>
<p><strong>方法实现</strong></p>
<div class="highlight"><pre><span></span><span class="nx">getRealName</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;that.userInfo.uId=&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">userInfo</span><span class="p">)</span>
    <span class="nx">uni</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span>
     <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;http://47.100.59.153:8080/attendance/realName/getRealName&quot;</span><span class="p">,</span>
     <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;uId&quot;</span><span class="o">:</span> <span class="nx">that</span><span class="p">.</span><span class="nx">userInfo</span><span class="p">.</span><span class="nx">uId</span>
     <span class="p">},</span>
     <span class="nx">success</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span>
      <span class="nx">that</span><span class="p">.</span><span class="nx">realNameInfo</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">realNameInfo</span>
      <span class="nx">that</span><span class="p">.</span><span class="nx">userInfo</span><span class="p">.</span><span class="nx">realNameInfo</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">realNameInfo</span>

      <span class="nx">uni</span><span class="p">.</span><span class="nx">setStorageSync</span><span class="p">(</span><span class="s2">&quot;userInfo&quot;</span><span class="p">,</span> <span class="nx">that</span><span class="p">.</span><span class="nx">userInfo</span><span class="p">)</span>
      <span class="nx">that</span><span class="p">.</span><span class="nx">userInfo</span> <span class="o">=</span> <span class="nx">uni</span><span class="p">.</span><span class="nx">getStorageSync</span><span class="p">(</span><span class="s2">&quot;userInfo&quot;</span><span class="p">)</span>

     <span class="p">}</span>
    <span class="p">})</span>
   <span class="p">},</span>

   <span class="nx">getUserinfo</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">res</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">iv</span><span class="p">)</span> <span class="p">{</span>
     <span class="nx">uni</span><span class="p">.</span><span class="nx">showToast</span><span class="p">({</span>
      <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;求求你授权吧&quot;</span>
     <span class="p">})</span>
     <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span>
    <span class="nx">that</span><span class="p">.</span><span class="nx">userInfo</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">userInfo</span>
    <span class="c1">// 调用云函数获取openid</span>
    <span class="nx">wx</span><span class="p">.</span><span class="nx">cloud</span><span class="p">.</span><span class="nx">callFunction</span><span class="p">({</span>
     <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;login&#39;</span><span class="p">,</span>
     <span class="nx">data</span><span class="o">:</span> <span class="p">{},</span>
     <span class="nx">success</span><span class="o">:</span> <span class="nx">res</span> <span class="p">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;[云函数] [login] user openid: &#39;</span><span class="p">,</span> <span class="nx">res</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">openid</span><span class="p">)</span>
      <span class="nx">that</span><span class="p">.</span><span class="nx">userInfo</span><span class="p">.</span><span class="nx">openid</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">result</span><span class="p">.</span><span class="nx">openid</span>
      <span class="nx">that</span><span class="p">.</span><span class="nx">switchMsg</span> <span class="o">=</span> <span class="kc">true</span>
      <span class="nx">that</span><span class="p">.</span><span class="nx">userInfo</span><span class="p">.</span><span class="nx">switchMsg</span> <span class="o">=</span> <span class="kc">true</span>


      <span class="nx">that</span><span class="p">.</span><span class="nx">getUidAndSuper</span><span class="p">()</span>
      <span class="c1">// console.log(&quot;that.userInfo.sSper:::&quot;+that.userInfo.sSper)</span>
      <span class="c1">// that.getRealName()</span>
      <span class="c1">// uni.setStorageSync(&quot;userInfo&quot;, that.userInfo)</span>
     <span class="p">},</span>
     <span class="nx">fail</span><span class="o">:</span> <span class="nx">err</span> <span class="p">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;[云函数] [login] 调用失败&#39;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
     <span class="p">}</span>
    <span class="p">})</span>

   <span class="p">},</span>



   <span class="nx">realNameSubmit</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
    <span class="kd">let</span> <span class="nx">sId</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">sId</span>
    <span class="kd">let</span> <span class="nx">pwd</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">pwd</span>
    <span class="kd">let</span> <span class="nx">email</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">email</span>


    <span class="k">if</span> <span class="p">((</span><span class="o">!</span><span class="nx">sId</span> <span class="o">||</span> <span class="o">!</span><span class="nx">pwd</span><span class="p">)</span> <span class="o">||</span> <span class="o">!</span><span class="nx">email</span><span class="p">)</span> <span class="p">{</span>
     <span class="c1">// this.onTowast(&quot;请填写完整&quot;)</span>
     <span class="nx">uni</span><span class="p">.</span><span class="nx">showToast</span><span class="p">({</span>
      <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;请填写完整&quot;</span><span class="p">,</span>
      <span class="nx">icon</span><span class="o">:</span> <span class="s2">&quot;none&quot;</span>
     <span class="p">})</span>
     <span class="k">return</span> <span class="kc">false</span>
    <span class="p">}</span>
    <span class="nx">uni</span><span class="p">.</span><span class="nx">request</span><span class="p">({</span>
     <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;http://47.100.59.153:8080/attendance/realName/tieRealName&quot;</span><span class="p">,</span>
     <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;uId&quot;</span><span class="o">:</span> <span class="nx">that</span><span class="p">.</span><span class="nx">userInfo</span><span class="p">.</span><span class="nx">uId</span><span class="p">,</span>
      <span class="s2">&quot;sId&quot;</span><span class="o">:</span> <span class="nx">e</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">sId</span><span class="p">,</span>
      <span class="s2">&quot;password&quot;</span><span class="o">:</span> <span class="nx">e</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">pwd</span><span class="p">,</span>
      <span class="s2">&quot;email&quot;</span><span class="o">:</span> <span class="nx">e</span><span class="p">.</span><span class="nx">detail</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">email</span>
     <span class="p">},</span>
     <span class="nx">success</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">let</span> <span class="nx">title</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>

      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">)</span>
      <span class="kd">let</span> <span class="nx">msg</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">msg</span> <span class="o">==</span> <span class="s2">&quot;tied&quot;</span><span class="p">)</span> <span class="p">{</span>
       <span class="nx">titl</span>
</pre></div>
<h3>九、效果演示</h3>
<p>登陆后未在小程序上实名过会先提醒实名才能看到功能</p>
<p><figure><img data-width="483" data-height="686" src="https://cdn.jsdelivr.net/gh/ze/Wiki@gh-pages/archives/assets/fc708e1b88128e736f6876f3c63485ba.jpg" alt="" /></figure></p>
<p>实名后会显示已实名</p>
<p><figure><img data-width="520" data-height="815" src="https://cdn.jsdelivr.net/gh/ze/Wiki@gh-pages/archives/assets/f74dcc80ca3ac1d0f836ecdb27c96b0b.jpg" alt="" /></figure></p>
<p>实名后模拟指纹进入课室</p>
<p><figure><img data-width="517" data-height="764" src="https://cdn.jsdelivr.net/gh/ze/Wiki@gh-pages/archives/assets/310bf542f2661b6d8cd77af73221e4be.jpg" alt="" /></figure></p>
<p><figure><img data-width="512" data-height="887" src="https://cdn.jsdelivr.net/gh/ze/Wiki@gh-pages/archives/assets/1ca29f4b905c2a45dc5057d4c87cd270.jpg" alt="" /></figure></p>
<p>实名后可查看其他页面</p>
<p><figure><img data-width="489" data-height="276" src="https://cdn.jsdelivr.net/gh/ze/Wiki@gh-pages/archives/assets/4a6f57e4c301c6161ecc43916872a411.jpg" alt="" /></figure></p>
<p>模拟微信步数的排行榜页面</p>
<p><figure><img data-width="494" data-height="734" src="https://cdn.jsdelivr.net/gh/ze/Wiki@gh-pages/archives/assets/74a9ea5997f45f413be482346ee5e4aa.jpg" alt="" /></figure></p>
<p>可查看自己进出的日志</p>
<p><figure><img data-width="494" data-height="734" src="https://cdn.jsdelivr.net/gh/ze/Wiki@gh-pages/archives/assets/74a9ea5997f45f413be482346ee5e4aa.jpg" alt="" /></figure></p>
<p>可提供打开提醒服务</p>
<p><figure><img data-width="489" data-height="642" src="https://cdn.jsdelivr.net/gh/ze/Wiki@gh-pages/archives/assets/22598ca492cd8528cca51475e5508b71.jpg" alt="" /></figure></p>
<p>接收消息后可接收小程序发来的提醒通知</p>
<h3>十、遇到的问题及解决</h3>
<h4>1.idea无法部署web项目</h4>
<p>​    当web项目部署到tomcat时，war部署和war exoloded部署都无法用tomcat启动项目，一直报404错误，在tomcat的webapps目录下也没有找到项目文件，在配置了war和war exoloded的输出路径后也不行，最后换了tomcat7之后才可以，tomcat8.5的跟自己的运行环境不匹配</p>
<h4>2.部署到服务器后无法找到表</h4>
<p>当项目部署到服务器上运行方法后，无法找到表，因而演示时无法用服务器演示</p>
<p><figure><img data-width="1204" data-height="581" src="https://cdn.jsdelivr.net/gh/ze/Wiki@gh-pages/archives/assets/46c20606ccb44208691bad2bc39e1a0f.jpg" alt="" /></figure></p>
<p>windows上的MySQL默认不区分表名大小写，服务器上的MySQL区别表名大小写，在java后台的表名是小写的，MySQL里写的是大写的，因此服务器上运行方法时找不到表而报错，把表名改统一后就可以在服务器运行了。</p>
<h4>3.Mybatis注解错误</h4>
<p>问题：Mybatis注解的时候，总是遇到错误Type interface com.souvi.ibatis.xxxMapper is  not known to the MapperRegistry</p>
<p>解决：使用注解要先注册</p>
<h4>4.访问出现500错误</h4>
<p><figure><img data-width="1220" data-height="437" src="https://cdn.jsdelivr.net/gh/ze/Wiki@gh-pages/archives/assets/294d9c23fd7e15311ea0384f412daec1.jpg" alt="" /></figure></p>
<p>我们的xml文件要被写入tatget文件夹，就得放在resources文件夹下面才可以被当做资源加入target文件夹中，才不会报找不到mapper.xml文件错误</p>
<h4>5.405方法“GET”不支持</h4>
<p><figure><img data-width="-1" data-height="-1" src="C:\Users\15010\AppData\Roaming\Typora\typora-user-../images/大三下实训期末作业/\image-20200113162718191.png" alt="image-20200113162718191" /><figcaption>image-20200113162718191</figcaption></figure></p>
<p>在URL地址栏中发生的请求，它的方法是GET，但是后台控制器方法上的注解表明这是一个POST请求，将其改成post就行</p>
<h4> </h4>
</article>
    </section>

    
    <section id="content-pager">
        
            <div class="next">
                <a class="card" href="/archives/服务器上部署SpringBoot/">
                    <time>July 05 2020</time>
                    <span>服务器上部署SpringBoot</span>
                </a>
            </div>
        
        
            <div class="prev">
                <a class="card" href="/archives/认识SpringCloud/">
                    <time>June 07 2020</time>
                    <span>认识SpringCloud</span>
                </a>
            </div>
        
    </section>
    

    
        <section id="comments">
            <div id="vcomments"></div>
        </section>
        <script>
            window.ValineOpt = {"enable": true, "el": "#vcomments", "appId": "0j0KcckWXNcj4LM9RWVh1nKN-gzGzoHsz", "appKey": "TGMR5Eo0w2lsuE1wyO7p5cyv", "visitor": true, "recordIP": true, "placeholder": "\u7565\u61c2"};
            window.ValineOpt.path = window.location.pathname;
        </script>
    

    <script>
        document.body.classList.add('content');
        document.body.classList.remove('archive');
    </script>
</div>
                    <footer>
                        <span>Copyright © 2020 ze</span>
                        
    <span class="leancloud_visitors"
            id="/archives/大三下实训期末作业/" 
            data-flag-title="大三下实训期末作业">
            <i class="fa fa-eye"></i> <i style="font-style: normal" class="leancloud-visitors-count"></i> Views
        </span>

                        <span class="addon">
<p><a href="http://www.beian.miit.gov.cn">粤ICP备19126168号</a>
</span>
                    </footer>
                </div>
                
<aside id="toc-container" class="no-scrollbar">
    <span><i class="fa fa-align-right"></i> CONTENTS</span>
    <div id="toc"></div>
</aside>

            </div>
        </main>


        <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/tocbot@4.10.0/dist/tocbot.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/ze/Wiki@gh-pages/assets/kepler-ef161b04d5.js"></script>
        <script>
            function ExSearchCall(item){
                if (item && item.length) {
                    $('.ins-close').click(); // 关闭搜索框
                    $('input.ins-search-input').val(''); // 清空
                    let url = item.attr('data-url'); // 获取目标页面 URL
                    $.pjax({url: url, 
                        container: '#pjax-container',
                        fragment: '#pjax-container',
                        timeout: 8000, }); // 发起一次 PJAX 请求
                }
            }
        </script>

        <!--Valine-->
        
            <script>
                var initValine = function () {
                    if (typeof window.ValineOpt === 'object' && $(window.ValineOpt.el).length) {
                        new Valine(window.ValineOpt);
                    }
                }
            </script>
            <script async src='https://cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js' onload="initValine()"></script>
        

        <!--ExSearch-->
        <script src="https://cdn.jsdelivr.net/gh/ze/Wiki@gh-pages/assets/ExSearch/ExSearch-493cb9cd89.js"></script>
        
        <!--katex-->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/ze/Wiki@gh-pages/assets/katex.min.css">
        <script defer src="https://cdn.jsdelivr.net/gh/ze/Wiki@gh-pages/assets/katex.min.js"></script>
        <script>
        mathOpts = {
            delimiters: [
                {left: "$$", right: "$$", display: true},
                {left: "\\[", right: "\\]", display: true},
                {left: "$", right: "$", display: false},
                {left: "\\(", right: "\\)", display: false}
            ]
        };
        </script>
        <script defer src="https://cdn.jsdelivr.net/gh/ze/Wiki@gh-pages/assets/auto-render.min.js" onload="renderMathInElement(document.body, mathOpts);"></script>

        
    </body>
</html>